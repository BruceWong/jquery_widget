(function(){var r=this,Z=r._,N={},A=Array.prototype,S=Object.prototype,m=A.slice,J=A.unshift,T=S.toString,K=S.hasOwnProperty,C=A.forEach,o=A.map,g=A.reduce,h=A.reduceRight,n=A.filter,E=A.every,D=A.some,O=A.indexOf,W=A.lastIndexOf;S=Array.isArray;var aa=Object.keys,l=Function.prototype.bind,k=function(j){return new B(j)};typeof module!=="undefined"&&module.exports?(module.exports=k,k._=k):r._=k;k.VERSION="1.1.7";var G=k.each=k.forEach=function(j,s,z){if(j!=null)if(C&&j.forEach===C)j.forEach(s,z);else if(j.length===
+j.length)for(var H=0,P=j.length;H<P;H++){if(H in j&&s.call(z,j[H],H,j)===N)break}else for(H in j)if(K.call(j,H)&&s.call(z,j[H],H,j)===N)break};k.map=function(j,s,z){var H=[];if(j==null)return H;if(o&&j.map===o)return j.map(s,z);G(j,function(P,X,ga){H[H.length]=s.call(z,P,X,ga)});return H};k.reduce=k.foldl=k.inject=function(j,s,z,H){var P=z!==void 0;j==null&&(j=[]);if(g&&j.reduce===g)return H&&(s=k.bind(s,H)),P?j.reduce(s,z):j.reduce(s);G(j,function(X,ga,ba){P?z=s.call(H,z,X,ga,ba):(z=X,P=true)});
if(!P)throw new TypeError("Reduce of empty array with no initial value");return z};k.reduceRight=k.foldr=function(j,s,z,H){j==null&&(j=[]);if(h&&j.reduceRight===h)return H&&(s=k.bind(s,H)),z!==void 0?j.reduceRight(s,z):j.reduceRight(s);j=(k.isArray(j)?j.slice():k.toArray(j)).reverse();return k.reduce(j,s,z,H)};k.find=k.detect=function(j,s,z){var H;w(j,function(P,X,ga){if(s.call(z,P,X,ga))return H=P,true});return H};k.filter=k.select=function(j,s,z){var H=[];if(j==null)return H;if(n&&j.filter===n)return j.filter(s,
z);G(j,function(P,X,ga){s.call(z,P,X,ga)&&(H[H.length]=P)});return H};k.reject=function(j,s,z){var H=[];if(j==null)return H;G(j,function(P,X,ga){s.call(z,P,X,ga)||(H[H.length]=P)});return H};k.every=k.all=function(j,s,z){var H=true;if(j==null)return H;if(E&&j.every===E)return j.every(s,z);G(j,function(P,X,ga){if(!(H=H&&s.call(z,P,X,ga)))return N});return H};var w=k.some=k.any=function(j,s,z){s=s||k.identity;var H=false;if(j==null)return H;if(D&&j.some===D)return j.some(s,z);G(j,function(P,X,ga){if(H|=
s.call(z,P,X,ga))return N});return!!H};k.include=k.contains=function(j,s){var z=false;if(j==null)return z;if(O&&j.indexOf===O)return j.indexOf(s)!=-1;w(j,function(H){if(z=H===s)return true});return z};k.invoke=function(j,s){var z=m.call(arguments,2);return k.map(j,function(H){return(s.call?s||H:H[s]).apply(H,z)})};k.pluck=function(j,s){return k.map(j,function(z){return z[s]})};k.max=function(j,s,z){if(!s&&k.isArray(j))return Math.max.apply(Math,j);var H={computed:-Infinity};G(j,function(P,X,ga){X=
s?s.call(z,P,X,ga):P;X>=H.computed&&(H={value:P,computed:X})});return H.value};k.min=function(j,s,z){if(!s&&k.isArray(j))return Math.min.apply(Math,j);var H={computed:Infinity};G(j,function(P,X,ga){X=s?s.call(z,P,X,ga):P;X<H.computed&&(H={value:P,computed:X})});return H.value};k.sortBy=function(j,s,z){return k.pluck(k.map(j,function(H,P,X){return{value:H,criteria:s.call(z,H,P,X)}}).sort(function(H,P){var X=H.criteria,ga=P.criteria;return X<ga?-1:X>ga?1:0}),"value")};k.groupBy=function(j,s){var z=
{};G(j,function(H,P){var X=s(H,P);(z[X]||(z[X]=[])).push(H)});return z};k.sortedIndex=function(j,s,z){z||(z=k.identity);for(var H=0,P=j.length;H<P;){var X=H+P>>1;z(j[X])<z(s)?H=X+1:P=X}return H};k.toArray=function(j){if(!j)return[];if(j.toArray)return j.toArray();if(k.isArray(j))return m.call(j);if(k.isArguments(j))return m.call(j);return k.values(j)};k.size=function(j){return k.toArray(j).length};k.first=k.head=function(j,s,z){return s!=null&&!z?m.call(j,0,s):j[0]};k.rest=k.tail=function(j,s,z){return m.call(j,
s==null||z?1:s)};k.last=function(j){return j[j.length-1]};k.compact=function(j){return k.filter(j,function(s){return!!s})};k.flatten=function(j){return k.reduce(j,function(s,z){if(k.isArray(z))return s.concat(k.flatten(z));s[s.length]=z;return s},[])};k.without=function(j){return k.difference(j,m.call(arguments,1))};k.uniq=k.unique=function(j,s){return k.reduce(j,function(z,H,P){if(0==P||(s===true?k.last(z)!=H:!k.include(z,H)))z[z.length]=H;return z},[])};k.union=function(){return k.uniq(k.flatten(arguments))};
k.intersection=k.intersect=function(j){var s=m.call(arguments,1);return k.filter(k.uniq(j),function(z){return k.every(s,function(H){return k.indexOf(H,z)>=0})})};k.difference=function(j,s){return k.filter(j,function(z){return!k.include(s,z)})};k.zip=function(){for(var j=m.call(arguments),s=k.max(k.pluck(j,"length")),z=Array(s),H=0;H<s;H++)z[H]=k.pluck(j,""+H);return z};k.indexOf=function(j,s,z){if(j==null)return-1;var H;if(z)return z=k.sortedIndex(j,s),j[z]===s?z:-1;if(O&&j.indexOf===O)return j.indexOf(s);
z=0;for(H=j.length;z<H;z++)if(j[z]===s)return z;return-1};k.lastIndexOf=function(j,s){if(j==null)return-1;if(W&&j.lastIndexOf===W)return j.lastIndexOf(s);for(var z=j.length;z--;)if(j[z]===s)return z;return-1};k.range=function(j,s,z){arguments.length<=1&&(s=j||0,j=0);z=arguments[2]||1;for(var H=Math.max(Math.ceil((s-j)/z),0),P=0,X=Array(H);P<H;){X[P++]=j;j+=z}return X};k.bind=function(j,s){if(j.bind===l&&l)return l.apply(j,m.call(arguments,1));var z=m.call(arguments,2);return function(){return j.apply(s,
z.concat(m.call(arguments)))}};k.bindAll=function(j){var s=m.call(arguments,1);s.length==0&&(s=k.functions(j));G(s,function(z){j[z]=k.bind(j[z],j)});return j};k.memoize=function(j,s){var z={};s||(s=k.identity);return function(){var H=s.apply(this,arguments);return K.call(z,H)?z[H]:z[H]=j.apply(this,arguments)}};k.delay=function(j,s){var z=m.call(arguments,2);return setTimeout(function(){return j.apply(j,z)},s)};k.defer=function(j){return k.delay.apply(k,[j,1].concat(m.call(arguments,1)))};var q=function(j,
s,z){var H;return function(){var P=this,X=arguments,ga=function(){H=null;j.apply(P,X)};z&&clearTimeout(H);if(z||!H)H=setTimeout(ga,s)}};k.throttle=function(j,s){return q(j,s,false)};k.debounce=function(j,s){return q(j,s,true)};k.once=function(j){var s=false,z;return function(){if(s)return z;s=true;return z=j.apply(this,arguments)}};k.wrap=function(j,s){return function(){var z=[j].concat(m.call(arguments));return s.apply(this,z)}};k.compose=function(){var j=m.call(arguments);return function(){for(var s=
m.call(arguments),z=j.length-1;z>=0;z--)s=[j[z].apply(this,s)];return s[0]}};k.after=function(j,s){return function(){if(--j<1)return s.apply(this,arguments)}};k.keys=aa||function(j){if(j!==Object(j))throw new TypeError("Invalid object");var s=[],z;for(z in j)K.call(j,z)&&(s[s.length]=z);return s};k.values=function(j){return k.map(j,k.identity)};k.functions=k.methods=function(j){var s=[],z;for(z in j)k.isFunction(j[z])&&s.push(z);return s.sort()};k.extend=function(j){G(m.call(arguments,1),function(s){for(var z in s)s[z]!==
void 0&&(j[z]=s[z])});return j};k.defaults=function(j){G(m.call(arguments,1),function(s){for(var z in s)j[z]==null&&(j[z]=s[z])});return j};k.clone=function(j){return k.isArray(j)?j.slice():k.extend({},j)};k.tap=function(j,s){s(j);return j};k.isEqual=function(j,s){if(j===s)return true;var z=typeof j;if(z!=typeof s)return false;if(j==s)return true;if(!j&&s||j&&!s)return false;if(j._chain)j=j._wrapped;if(s._chain)s=s._wrapped;if(j.isEqual)return j.isEqual(s);if(s.isEqual)return s.isEqual(j);if(k.isDate(j)&&
k.isDate(s))return j.getTime()===s.getTime();if(k.isNaN(j)&&k.isNaN(s))return false;if(k.isRegExp(j)&&k.isRegExp(s))return j.source===s.source&&j.global===s.global&&j.ignoreCase===s.ignoreCase&&j.multiline===s.multiline;if(z!=="object")return false;if(j.length&&j.length!==s.length)return false;z=k.keys(j);var H=k.keys(s);if(z.length!=H.length)return false;for(var P in j)if(!(P in s)||!k.isEqual(j[P],s[P]))return false;return true};k.isEmpty=function(j){if(k.isArray(j)||k.isString(j))return j.length===
0;for(var s in j)if(K.call(j,s))return false;return true};k.isElement=function(j){return!!(j&&j.nodeType==1)};k.isArray=S||function(j){return T.call(j)==="[object Array]"};k.isObject=function(j){return j===Object(j)};k.isArguments=function(j){return!(!j||!K.call(j,"callee"))};k.isFunction=function(j){return!(!j||!j.constructor||!j.call||!j.apply)};k.isString=function(j){return!!(j===""||j&&j.charCodeAt&&j.substr)};k.isNumber=function(j){return!!(j===0||j&&j.toExponential&&j.toFixed)};k.isNaN=function(j){return j!==
j};k.isBoolean=function(j){return j===true||j===false};k.isDate=function(j){return!(!j||!j.getTimezoneOffset||!j.setUTCFullYear)};k.isRegExp=function(j){return!(!j||!j.test||!j.exec||!(j.ignoreCase||j.ignoreCase===false))};k.isNull=function(j){return j===null};k.isUndefined=function(j){return j===void 0};k.noConflict=function(){r._=Z;return this};k.identity=function(j){return j};k.times=function(j,s,z){for(var H=0;H<j;H++)s.call(z,H)};k.mixin=function(j){G(k.functions(j),function(s){Q(s,k[s]=j[s])})};
var y=0;k.uniqueId=function(j){var s=y++;return j?j+s:s};k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};k.template=function(j,s){var z=k.templateSettings;z="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+j.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(z.interpolate,function(H,P){return"',"+P.replace(/\\'/g,"'")+",'"}).replace(z.evaluate||null,function(H,P){return"');"+P.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";z=new Function("obj",z);return s?z(s):z};var B=function(j){this._wrapped=j};k.prototype=B.prototype;var F=function(j,s){return s?k(j).chain():j},Q=function(j,s){B.prototype[j]=function(){var z=m.call(arguments);J.call(z,this._wrapped);return F(s.apply(k,z),this._chain)}};k.mixin(k);G(["pop","push","reverse","shift","sort","splice","unshift"],function(j){var s=A[j];B.prototype[j]=function(){s.apply(this._wrapped,arguments);
return F(this._wrapped,this._chain)}});G(["concat","join","slice"],function(j){var s=A[j];B.prototype[j]=function(){return F(s.apply(this._wrapped,arguments),this._chain)}});B.prototype.chain=function(){this._chain=true;return this};B.prototype.value=function(){return this._wrapped}})();(function(){var r=this,Z=r.Backbone,N;N=typeof exports!=="undefined"?exports:r.Backbone={};N.VERSION="0.5.3";var A=r._;if(!A&&typeof require!=="undefined")A=require("underscore")._;var S=r.jQuery||r.Zepto;N.noConflict=function(){r.Backbone=Z;return this};N.emulateHTTP=false;N.emulateJSON=false;N.Events={bind:function(l,k,G){var w=this._callbacks||(this._callbacks={});(w[l]||(w[l]=[])).push([k,G]);return this},unbind:function(l,k){var G;if(l){if(G=this._callbacks)if(k){G=G[l];if(!G)return this;for(var w=
0,q=G.length;w<q;w++)if(G[w]&&k===G[w][0]){G[w]=null;break}}else G[l]=[]}else this._callbacks={};return this},trigger:function(l){var k,G,w,q,y=2;if(!(G=this._callbacks))return this;for(;y--;)if(k=y?l:"all",k=G[k])for(var B=0,F=k.length;B<F;B++)(w=k[B])?(q=y?Array.prototype.slice.call(arguments,1):arguments,w[0].apply(w[1]||this,q)):(k.splice(B,1),B--,F--);return this}};N.Model=function(l,k){var G;l||(l={});if(G=this.defaults){A.isFunction(G)&&(G=G.call(this));l=A.extend({},G,l)}this.attributes={};
this._escapedAttributes={};this.cid=A.uniqueId("c");this.set(l,{silent:true});this._changed=false;this._previousAttributes=A.clone(this.attributes);if(k&&k.collection)this.collection=k.collection;this.initialize(l,k)};A.extend(N.Model.prototype,N.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return A.clone(this.attributes)},get:function(l){return this.attributes[l]},escape:function(l){var k;if(k=this._escapedAttributes[l])return k;k=this.attributes[l];
return this._escapedAttributes[l]=(k==null?"":""+k).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(l){return this.attributes[l]!=null},set:function(l,k){k||(k={});if(!l)return this;if(l.attributes)l=l.attributes;var G=this.attributes,w=this._escapedAttributes;if(!k.silent&&this.validate&&!this._performValidation(l,k))return false;if(this.idAttribute in l)this.id=l[this.idAttribute];
var q=this._changing;this._changing=true;for(var y in l){var B=l[y];if(!A.isEqual(G[y],B)){G[y]=B;delete w[y];this._changed=true;k.silent||this.trigger("change:"+y,this,B,k)}}!q&&!k.silent&&this._changed&&this.change(k);this._changing=false;return this},unset:function(l,k){if(!(l in this.attributes))return this;k||(k={});var G={};G[l]=void 0;if(!k.silent&&this.validate&&!this._performValidation(G,k))return false;delete this.attributes[l];delete this._escapedAttributes[l];l==this.idAttribute&&delete this.id;
this._changed=true;k.silent||(this.trigger("change:"+l,this,void 0,k),this.change(k));return this},clear:function(l){l||(l={});var k,G=this.attributes,w={};for(k in G)w[k]=void 0;if(!l.silent&&this.validate&&!this._performValidation(w,l))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!l.silent){for(k in G)this.trigger("change:"+k,this,void 0,l);this.change(l)}return this},fetch:function(l){l||(l={});var k=this,G=l.success;l.success=function(w,q,y){if(!k.set(k.parse(w,
y),l))return false;G&&G(k,w)};l.error=aa(l.error,k,l);return(this.sync||N.sync).call(this,"read",this,l)},save:function(l,k){k||(k={});if(l&&!this.set(l,k))return false;var G=this,w=k.success;k.success=function(y,B,F){if(!G.set(G.parse(y,F),k))return false;w&&w(G,y,F)};k.error=aa(k.error,G,k);var q=this.isNew()?"create":"update";return(this.sync||N.sync).call(this,q,this,k)},destroy:function(l){l||(l={});if(this.isNew())return this.trigger("destroy",this,this.collection,l);var k=this,G=l.success;
l.success=function(w){k.trigger("destroy",k,k.collection,l);G&&G(k,w)};l.error=aa(l.error,k,l);return(this.sync||N.sync).call(this,"delete",this,l)},url:function(){var l=O(this.collection)||this.urlRoot||W();if(this.isNew())return l;return l+(l.charAt(l.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(l){return l},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(l){this.trigger("change",this,l);this._previousAttributes=A.clone(this.attributes);
this._changed=false},hasChanged:function(l){if(l)return this._previousAttributes[l]!=this.attributes[l];return this._changed},changedAttributes:function(l){l||(l=this.attributes);var k=this._previousAttributes,G=false,w;for(w in l)A.isEqual(k[w],l[w])||(G=G||{},G[w]=l[w]);return G},previous:function(l){if(!l||!this._previousAttributes)return null;return this._previousAttributes[l]},previousAttributes:function(){return A.clone(this._previousAttributes)},_performValidation:function(l,k){var G=this.validate(l);
if(G)return k.error?k.error(this,G,k):this.trigger("error",this,G,k),false;return true}});N.Collection=function(l,k){k||(k={});if(k.comparator)this.comparator=k.comparator;A.bindAll(this,"_onModelEvent","_removeReference");this._reset();l&&this.reset(l,{silent:true});this.initialize.apply(this,arguments)};A.extend(N.Collection.prototype,N.Events,{model:N.Model,initialize:function(){},toJSON:function(){return this.map(function(l){return l.toJSON()})},add:function(l,k){if(A.isArray(l))for(var G=0,w=
l.length;G<w;G++)this._add(l[G],k);else this._add(l,k);return this},remove:function(l,k){if(A.isArray(l))for(var G=0,w=l.length;G<w;G++)this._remove(l[G],k);else this._remove(l,k);return this},get:function(l){if(l==null)return null;return this._byId[l.id!=null?l.id:l]},getByCid:function(l){return l&&this._byCid[l.cid||l]},at:function(l){return this.models[l]},sort:function(l){l||(l={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);
l.silent||this.trigger("reset",this,l);return this},pluck:function(l){return A.map(this.models,function(k){return k.get(l)})},reset:function(l,k){l||(l=[]);k||(k={});this.each(this._removeReference);this._reset();this.add(l,{silent:true});k.silent||this.trigger("reset",this,k);return this},fetch:function(l){l||(l={});var k=this,G=l.success;l.success=function(w,q,y){k[l.add?"add":"reset"](k.parse(w,y),l);G&&G(k,w)};l.error=aa(l.error,k,l);return(this.sync||N.sync).call(this,"read",this,l)},create:function(l,
k){var G=this;k||(k={});l=this._prepareModel(l,k);if(!l)return false;var w=k.success;k.success=function(q,y,B){G.add(q,k);w&&w(q,y,B)};l.save(null,k);return l},parse:function(l){return l},chain:function(){return A(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(l,k){if(l instanceof N.Model){if(!l.collection)l.collection=this}else{var G=l;l=new this.model(G,{collection:this});l.validate&&!l._performValidation(G,k)&&(l=false)}return l},
_add:function(l,k){k||(k={});l=this._prepareModel(l,k);if(!l)return false;var G=this.getByCid(l);if(G)throw Error(["Can't add the same model to a set twice",G.id]);this._byId[l.id]=l;this._byCid[l.cid]=l;this.models.splice(k.at!=null?k.at:this.comparator?this.sortedIndex(l,this.comparator):this.length,0,l);l.bind("all",this._onModelEvent);this.length++;k.silent||l.trigger("add",l,this,k);return l},_remove:function(l,k){k||(k={});l=this.getByCid(l)||this.get(l);if(!l)return null;delete this._byId[l.id];
delete this._byCid[l.cid];this.models.splice(this.indexOf(l),1);this.length--;k.silent||l.trigger("remove",l,this,k);this._removeReference(l);return l},_removeReference:function(l){this==l.collection&&delete l.collection;l.unbind("all",this._onModelEvent)},_onModelEvent:function(l,k,G,w){(l=="add"||l=="remove")&&G!=this||(l=="destroy"&&this._remove(k,w),k&&l==="change:"+k.idAttribute&&(delete this._byId[k.previous(k.idAttribute)],this._byId[k.id]=k),this.trigger.apply(this,arguments))}});A.each(["forEach",
"each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"],function(l){N.Collection.prototype[l]=function(){return A[l].apply(A,[this.models].concat(A.toArray(arguments)))}});N.Router=function(l){l||(l={});if(l.routes)this.routes=l.routes;this._bindRoutes();this.initialize.apply(this,arguments)};
var m=/:([\w\d]+)/g,J=/\*([\w\d]+)/g,T=/[-[\]{}()+?.,\\^$|#\s]/g;A.extend(N.Router.prototype,N.Events,{initialize:function(){},route:function(l,k,G){N.history||(N.history=new N.History);A.isRegExp(l)||(l=this._routeToRegExp(l));N.history.route(l,A.bind(function(w){w=this._extractParameters(l,w);G.apply(this,w);this.trigger.apply(this,["route:"+k].concat(w))},this))},navigate:function(l,k){N.history.navigate(l,k)},_bindRoutes:function(){if(this.routes){var l=[],k;for(k in this.routes)l.unshift([k,
this.routes[k]]);k=0;for(var G=l.length;k<G;k++)this.route(l[k][0],l[k][1],this[l[k][1]])}},_routeToRegExp:function(l){l=l.replace(T,"\\$&").replace(m,"([^/]*)").replace(J,"(.*?)");return RegExp("^"+l+"$")},_extractParameters:function(l,k){return l.exec(k).slice(1)}});N.History=function(){this.handlers=[];A.bindAll(this,"checkUrl")};var K=/^#*/,C=/msie [\w.]+/,o=false;A.extend(N.History.prototype,{interval:50,getFragment:function(l,k){if(l==null)if(this._hasPushState||k){l=window.location.pathname;
var G=window.location.search;G&&(l+=G);l.indexOf(this.options.root)==0&&(l=l.substr(this.options.root.length))}else l=window.location.hash;return decodeURIComponent(l.replace(K,""))},start:function(l){if(o)throw Error("Backbone.history has already been started");this.options=A.extend({},{root:"/"},this.options,l);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);l=this.getFragment();var k=document.documentMode;if(k=
C.exec(navigator.userAgent.toLowerCase())&&(!k||k<=7)){this.iframe=S('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(l)}this._hasPushState?S(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!k?S(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=l;o=true;l=window.location;k=l.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!k)return this.fragment=this.getFragment(null,
true),window.location.replace(this.options.root+"#"+this.fragment),true;else if(this._wantsPushState&&this._hasPushState&&k&&l.hash){this.fragment=l.hash.replace(K,"");window.history.replaceState({},document.title,l.protocol+"//"+l.host+this.options.root+this.fragment)}if(!this.options.silent)return this.loadUrl()},route:function(l,k){this.handlers.unshift({route:l,callback:k})},checkUrl:function(){var l=this.getFragment();l==this.fragment&&this.iframe&&(l=this.getFragment(this.iframe.location.hash));
if(l==this.fragment||l==decodeURIComponent(this.fragment))return false;this.iframe&&this.navigate(l);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(l){var k=this.fragment=this.getFragment(l);return A.any(this.handlers,function(G){if(G.route.test(k))return G.callback(k),true})},navigate:function(l,k){var G=(l||"").replace(K,"");if(!(this.fragment==G||this.fragment==decodeURIComponent(G))){if(this._hasPushState){var w=window.location;G.indexOf(this.options.root)!=0&&(G=this.options.root+
G);this.fragment=G;window.history.pushState({},document.title,w.protocol+"//"+w.host+G)}else if(window.location.hash=this.fragment=G,this.iframe&&G!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=G}k&&this.loadUrl(l)}}});N.View=function(l){this.cid=A.uniqueId("view");this._configure(l||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var g=/^(\S+)\s*(.*)$/,h=["model","collection","el","id","attributes",
"className","tagName"];A.extend(N.View.prototype,N.Events,{tagName:"div",$:function(l){return S(l,this.el)},initialize:function(){},render:function(){return this},remove:function(){S(this.el).remove();return this},make:function(l,k,G){l=document.createElement(l);k&&S(l).attr(k);G&&S(l).html(G);return l},delegateEvents:function(l){if(l||(l=this.events))for(var k in A.isFunction(l)&&(l=l.call(this)),S(this.el).unbind(".delegateEvents"+this.cid),l){var G=this[l[k]];if(!G)throw Error('Event "'+l[k]+'" does not exist');
var w=k.match(g),q=w[1];w=w[2];G=A.bind(G,this);q+=".delegateEvents"+this.cid;w===""?S(this.el).bind(q,G):S(this.el).delegate(w,q,G)}},_configure:function(l){this.options&&(l=A.extend({},this.options,l));for(var k=0,G=h.length;k<G;k++){var w=h[k];l[w]&&(this[w]=l[w])}this.options=l},_ensureElement:function(){if(this.el){if(A.isString(this.el))this.el=S(this.el).get(0)}else{var l=this.attributes||{};if(this.id)l.id=this.id;if(this.className)l["class"]=this.className;this.el=this.make(this.tagName,
l)}}});N.Model.extend=N.Collection.extend=N.Router.extend=N.View.extend=function(l,k){var G=D(this,l,k);G.extend=this.extend;return G};var n={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};N.sync=function(l,k,G){var w=n[l];G=A.extend({type:w,dataType:"json"},G);if(!G.url)G.url=O(k)||W();if(!G.data&&k&&(l=="create"||l=="update")){G.contentType="application/json";G.data=JSON.stringify(k.toJSON())}if(N.emulateJSON){G.contentType="application/x-www-form-urlencoded";G.data=G.data?{model:G.data}:
{}}if(N.emulateHTTP&&(w==="PUT"||w==="DELETE")){if(N.emulateJSON)G.data._method=w;G.type="POST";G.beforeSend=function(q){q.setRequestHeader("X-HTTP-Method-Override",w)}}if(G.type!=="GET"&&!N.emulateJSON)G.processData=false;return S.ajax(G)};var E=function(){},D=function(l,k,G){var w;w=k&&k.hasOwnProperty("constructor")?k.constructor:function(){return l.apply(this,arguments)};A.extend(w,l);E.prototype=l.prototype;w.prototype=new E;k&&A.extend(w.prototype,k);G&&A.extend(w,G);w.prototype.constructor=
w;w.__super__=l.prototype;return w},O=function(l){if(!l||!l.url)return null;return A.isFunction(l.url)?l.url():l.url},W=function(){throw Error('A "url" property or function must be specified');},aa=function(l,k,G){return function(w){l?l(k,w,G):k.trigger("error",k,w,G)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function r(h){if(m&&(J||!A||!A.log))m.apply(Z,h)}for(var Z=this,N=Array.prototype.slice,A=Z.console,S={},m,J,T=9,K=["error","warn","info","debug","log"],C="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),o=C.length,g=[];--o>=0;)(function(h){S[h]=function(){T!==0&&A&&A[h]&&A[h].apply(A,arguments)}})(C[o]);for(o=K.length;--o>=0;)(function(h,n){S[n]=function(){var E=N.call(arguments),D=[n].concat(E);
g.push(D);r(D);if(A&&(T>0?T>h:K.length+T<=h))A.firebug?A[n].apply(Z,E):A[n]?A[n](E):A.log(E)}})(o,K[o]);S.setLevel=function(h){T=typeof h==="number"?h:9};S.setCallback=function(){var h=N.call(arguments),n=g.length,E=n;m=h.shift()||null;J=typeof h[0]==="boolean"?h.shift():false;for(E-=typeof h[0]==="number"?h.shift():n;E<n;)r(g[E++])};return S}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(r){function Z(q,y,B,F){F={data:F||F===0||F===false?F:y?y.data:{},_wrap:y?y._wrap:null,tmpl:null,parent:y||null,nodes:[],calls:K,nest:C,wrap:o,html:g,update:h};q&&r.extend(F,q,{nodes:[],parent:y});if(B){F.tmpl=B;F._ctnt=F._ctnt||F.tmpl(r,F);F.key=++k;(w.length?W:O)[k]=F}return F}function N(q,y,B){var F;B=B?r.map(B,function(Q){return typeof Q==="string"?q.key?Q.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+E+'="'+q.key+'" $2'):Q:N(Q,q,Q._ctnt)}):q;if(y)return B;B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(Q,j,s,z){F=r(s).get();T(F);if(j)F=A(j).concat(F);if(z)F=F.concat(A(z))});return F?F:A(B)}function A(q){var y=document.createElement("div");y.innerHTML=q;return r.makeArray(y.childNodes)}function S(q){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+r.trim(q).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(y,B,F,Q,j,s,z){y=r.tmpl.tag[F];if(!y)throw"Unknown template tag: "+F;F=y._default||[];if(s&&!/\w$/.test(j)){j+=s;s=""}if(j){j=J(j);z=z?","+J(z)+")":s?")":"";z=s?j.indexOf(".")>-1?j+J(s):"("+j+").call($item"+z:j;s=s?z:"(typeof("+j+")==='function'?("+j+").call($item):("+j+"))"}else s=z=F.$1||"null";Q=J(Q);return"');"+y[B?"close":"open"].split("$notnull_1").join(j?"typeof("+j+")!=='undefined' && ("+j+")!=null":"true").split("$1a").join(s).split("$1").join(z).split("$2").join(Q||F.$2||"")+"__.push('"})+
"');}return __;")}function m(q,y){q._wrap=N(q,true,r.isArray(y)?y:[D.test(y)?y:r(y).html()]).join("")}function J(q){return q?q.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function T(q){function y(P){function X(ha){ha+=B;fa=j[ha]=j[ha]||Z(fa,O[fa.parent.key+B]||fa.parent)}var ga,ba=P,fa,la;if(la=P.getAttribute(E)){for(;ba.parentNode&&(ba=ba.parentNode).nodeType===1&&!(ga=ba.getAttribute(E)););if(ga!==la){ba=ba.parentNode?ba.nodeType===11?0:ba.getAttribute(E)||0:0;if(!(fa=O[la])){fa=W[la];fa=Z(fa,
O[ba]||W[ba]);fa.key=++k;O[k]=fa}G&&X(la)}P.removeAttribute(E)}else if(G&&(fa=r.data(P,"tmplItem"))){X(fa.key);O[fa.key]=fa;ba=(ba=r.data(P.parentNode,"tmplItem"))?ba.key:0}if(fa){for(ga=fa;ga&&ga.key!=ba;){ga.nodes.push(P);ga=ga.parent}delete fa._ctnt;delete fa._wrap;r.data(P,"tmplItem",fa)}}var B="_"+G,F,Q,j={},s,z,H;s=0;for(z=q.length;s<z;s++)if((F=q[s]).nodeType===1){Q=F.getElementsByTagName("*");for(H=Q.length-1;H>=0;H--)y(Q[H]);y(F)}}function K(q,y,B,F){if(!q)return w.pop();w.push({_:q,tmpl:y,
item:this,data:B,options:F})}function C(q,y,B){return r.tmpl(r.template(q),y,B,this)}function o(q,y){var B=q.options||{};B.wrapped=y;return r.tmpl(r.template(q.tmpl),q.data,B,q.item)}function g(q,y){var B=this._wrap;return r.map(r(r.isArray(B)?B.join(""):B).filter(q||"*"),function(F){if(y)F=F.innerText||F.textContent;else{var Q;if(!(Q=F.outerHTML)){Q=document.createElement("div");Q.appendChild(F.cloneNode(true));Q=Q.innerHTML}F=Q}return F})}function h(){var q=this.nodes;r.tmpl(null,null,null,this).insertBefore(q[0]);
r(q).remove()}var n=r.fn.domManip,E="_tmplitem",D=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,O={},W={},aa,l={key:0,data:{}},k=0,G=0,w=[];r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(q,y){r.fn[q]=function(B){var F=[];B=r(B);var Q,j,s;Q=this.length===1&&this[0].parentNode;aa=O||{};if(Q&&Q.nodeType===11&&Q.childNodes.length===1&&B.length===1){B[y](this[0]);F=this}else{j=0;for(s=B.length;j<s;j++){G=j;Q=(j>0?this.clone(true):this).get();
r(B[j])[y](Q);F=F.concat(Q)}G=0;F=this.pushStack(F,q,B.selector)}B=aa;aa=null;r.tmpl.complete(B);return F}});r.fn.extend({tmpl:function(q,y,B){return r.tmpl(this[0],q,y,B)},tmplItem:function(){return r.tmplItem(this[0])},template:function(q){return r.template(q,this[0])},domManip:function(q,y,B){if(q[0]&&r.isArray(q[0])){for(var F=r.makeArray(arguments),Q=q[0],j=Q.length,s=0,z;s<j&&!(z=r.data(Q[s++],"tmplItem")););if(z&&G)F[2]=function(H){r.tmpl.afterManip(this,H,B)};n.apply(this,F)}else n.apply(this,
arguments);G=0;aa||r.tmpl.complete(O);return this}});r.extend({tmpl:function(q,y,B,F){var Q=!F;if(Q){F=l;q=r.template[q]||r.template(null,q);W={}}else if(!q){q=F.tmpl;O[F.key]=F;F.nodes=[];F.wrapped&&m(F,F.wrapped);return r(N(F,null,F.tmpl(r,F)))}if(!q)return[];if(typeof y==="function")y=y.call(F||{});B&&B.wrapped&&m(B,B.wrapped);y=r.isArray(y)?r.map(y,function(j){return j?Z(B,F,q,j):null}):[Z(B,F,q,y)];return Q?r(N(F,null,y)):y},tmplItem:function(q){var y;if(q instanceof r)q=q[0];for(;q&&q.nodeType===
1&&!(y=r.data(q,"tmplItem"))&&(q=q.parentNode););return y||l},template:function(q,y){if(y){if(typeof y==="string")y=S(y);else if(y instanceof r)y=y[0]||{};if(y.nodeType)y=r.data(y,"tmpl")||r.data(y,"tmpl",S(y.innerHTML));return typeof q==="string"?r.template[q]=y:y}return q?typeof q!=="string"?r.template(null,q):r.template[q]||r.template(null,D.test(q)?q:r(q)):null},encode:function(q){return(""+q).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
r.extend(r.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){O={}},afterManip:function(q,y,B){var F=y.nodeType===11?r.makeArray(y.childNodes):y.nodeType===1?[y]:[];B.call(q,y);T(F);G++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(r){function Z(A){var S=A||window.event,m=[].slice.call(arguments,1),J=0,T=0,K=0;A=r.event.fix(S);A.type="mousewheel";if(A.wheelDelta)J=A.wheelDelta/120;if(A.detail)J=-A.detail/3;K=J;if(S.axis!==undefined&&S.axis===S.HORIZONTAL_AXIS){K=0;T=-1*J}if(S.wheelDeltaY!==undefined)K=S.wheelDeltaY/120;if(S.wheelDeltaX!==undefined)T=-1*S.wheelDeltaX/120;m.unshift(A,J,T,K);return r.event.handle.apply(this,m)}var N=["DOMMouseScroll","mousewheel"];r.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var A=
N.length;A;)this.addEventListener(N[--A],Z,false);else this.onmousewheel=Z},teardown:function(){if(this.removeEventListener)for(var A=N.length;A;)this.removeEventListener(N[--A],Z,false);else this.onmousewheel=null}};r.fn.extend({mousewheel:function(A){return A?this.bind("mousewheel",A):this.trigger("mousewheel")},unmousewheel:function(A){return this.unbind("mousewheel",A)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(r){function Z(){if(K){window.clearTimeout(o);K=false;C=null}}function N(h){if(!K){K=true;C=h.changedTouches[0];o=window.setTimeout(function(){K=false;var n=C,E=document.createEvent("MouseEvent");E.initMouseEvent("mouseup",true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,0,null);n.target.dispatchEvent(E);E=document.createEvent("MouseEvent");E.initMouseEvent("mousedown",true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,2,null);
n.target.dispatchEvent(E);E=document.createEvent("MouseEvent");E.initMouseEvent("contextmenu",true,true,window,1,n.screenX+50,n.screenY+5,n.clientX+50,n.clientY+5,false,false,false,false,2,null);n.target.dispatchEvent(E);g=true;C=null},800)}}function A(h){var n=h.changedTouches[0],E="mouseover",D=document.createEvent("MouseEvent");D.initMouseEvent(E,true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,0,null);n.target.dispatchEvent(D);E="mousedown";D=document.createEvent("MouseEvent");
D.initMouseEvent(E,true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,0,null);n.target.dispatchEvent(D);if(J){window.clearTimeout(T);if(n.target==m){m=null;J=false;E="click";D=document.createEvent("MouseEvent");D.initMouseEvent(E,true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,0,null);n.target.dispatchEvent(D);E="dblclick";D=document.createEvent("MouseEvent");D.initMouseEvent(E,true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,
false,false,false,false,0,null);n.target.dispatchEvent(D)}else{m=n.target;J=true;T=window.setTimeout(function(){J=false},600);N(h)}}else{m=n.target;J=true;T=window.setTimeout(function(){J=false},600);N(h)}}function S(h){var n="";if(!(h.touches.length>1)){switch(h.type){case "gesturestart":h.preventDefault();break;case "touchstart":if(r(h.changedTouches[0].target).is("select"))return;A(h);h.preventDefault();return false;case "touchmove":Z();n="mousemove";h.preventDefault();break;case "touchend":if(g){g=
false;h.preventDefault();return false}Z();n="mouseup";break;default:return}h=h.changedTouches[0];var E=document.createEvent("MouseEvent");E.initMouseEvent(n,true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(E);if(n=="mouseup"&&J&&h.target==m){E=document.createEvent("MouseEvent");E.initMouseEvent("click",true,true,window,1,h.screenX,h.screenY,h.clientX,h.clientY,false,false,false,false,0,null);h.target.dispatchEvent(E)}}}r.extend(r.support,
{touch:typeof Touch=="object"});r.fn.addTouch=function(){r.support.touch&&this.each(function(h,n){n.addEventListener("touchstart",S,false);n.addEventListener("touchmove",S,false);n.addEventListener("touchend",S,false);n.addEventListener("touchcancel",S,false)})};var m=null,J=false,T=null,K=false,C=null,o=null,g=false})(jQuery);
/iPad|iPhone/.test(navigator.userAgent)&&function(r){var Z=r.ui.mouse.prototype,N=Z._mouseInit;r.extend(Z,{_mouseInit:function(){this.element.bind("touchstart."+this.widgetName,r.proxy(this,"_touchStart"));N.apply(this,arguments)},_touchStart:function(A){if(A.originalEvent.targetTouches.length!=1)return false;this.element.bind("touchmove."+this.widgetName,r.proxy(this,"_touchMove")).bind("touchend."+this.widgetName,r.proxy(this,"_touchEnd"));this._modifyEvent(A);this._mouseDown(A);return false},_touchMove:function(A){this._modifyEvent(A);
this._mouseMove(A)},_touchEnd:function(A){this.element.unbind("touchmove."+this.widgetName).unbind("touchend."+this.widgetName);this._mouseUp(A)},_modifyEvent:function(A){A.which=1;var S=A.originalEvent.targetTouches[0];A.pageX=S.clientX;A.pageY=S.clientY}})}(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function r(){if(r.is(arguments[0],P)){for(var a=arguments[0],c=Na[O](r,a.splice(0,3+r.is(a[0],H))),d=c.set(),f=0,i=a[q];f<i;f++){var e=a[f]||{};T[o](e.type)&&d[ba](c[e.type]().attr(e))}return d}return Na[O](r,arguments)}function Z(){for(var a=[],c=0;c<32;c++)a[c]=(~~(B.random()*16))[X](16);a[12]=4;a[16]=(a[16]&3|8)[X](16);return"r-"+a[w]("")}function N(a,c,d){function f(){var i=Array[C].slice.call(arguments,0),e=i[w]("\u25ba"),p=f.cache=f.cache||{},u=f.count=f.count||[];if(p[o](e))return d?
d(p[e]):p[e];u[q]>=1E3&&delete p[u.shift()];u[ba](e);p[e]=a[O](c,i);return d?d(p[e]):p[e]}return f}function A(){return this.x+aa+this.y}function S(a){return function(c,d,f,i){var e={back:a};r.is(f,"function")?i=f:e.rot=f;c&&c.constructor==ja&&(c=c.attrs.path);c&&(e.along=c);return this.animate(e,d,i)}}function m(a,c,d,f,i,e){function p(U,ea){var V,R,$,ka;$=U;for(R=0;R<8;R++){ka=((x*$+v)*$+u)*$-U;if(j(ka)<ea)return $;V=(3*x*$+2*v)*$+u;if(j(V)<1.0E-6)break;$-=ka/V}V=0;R=1;$=U;if($<V)return V;if($>R)return R;
for(;V<R;){ka=((x*$+v)*$+u)*$;if(j(ka-U)<ea)break;U>ka?V=$:R=$;$=(R-V)/2+V}return $}var u=3*c,v=3*(f-c)-u,x=1-u-v,I=3*d,L=3*(i-d)-I,M=1-I-L;return function(U,ea){var V=p(U,ea);return((M*V+L)*V+I)*V}(a,1/(200*e))}r.version="1.5.2";var J=/[, ]+/,T={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},K=/\{(\d+)\}/g,C="prototype",o="hasOwnProperty",g=document,h=window,n={was:Object[C][o].call(h,"Raphael"),is:h.Raphael},E=function(){this.customAttributes={}},D,O="apply",W="createTouch"in g,aa=" ",l=String,
k="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(aa),G={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},w="join",q="length",y=l[C].toLowerCase,B=Math,F=B.max,Q=B.min,j=B.abs,s=B.pow,z=B.PI,H="number",P="array",X="toString",ga=Object[C][X],ba="push",fa=/^url\(['"]?([^\)]+?)['"]?\)$/i,la=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ha={NaN:1,Infinity:1,"-Infinity":1},ra=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ca=B.round,Y=parseFloat,na=parseInt,wa=l[C].toUpperCase,Ea={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Oa={along:"along",blur:H,"clip-rect":"csv",cx:H,cy:H,fill:"colour","fill-opacity":H,"font-size":H,height:H,opacity:H,path:"path",r:H,rotation:"csv",rx:H,ry:H,scale:"csv",stroke:"colour","stroke-opacity":H,"stroke-width":H,translation:"csv",width:H,x:H,y:H},ub=/^(from|to|\d+%?)$/,Pa=/\s*,\s*/,vb={hs:1,rg:1},wb=/,?([achlmqrstvxz]),?/gi,
xb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,yb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Za=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,Ab=function(a,c){return a.key-c.key};r.type=h.SVGAngle||g.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(r.type=="VML"){var ta=g.createElement("div");ta.innerHTML='<v:shape adj="1"/>';ta=ta.firstChild;ta.style.behavior="url(#default#VML)";if(!(ta&&typeof ta.adj=="object"))return r.type=null;ta=null}r.svg=
!(r.vml=r.type=="VML");E[C]=r[C];D=E[C];r._id=0;r._oid=0;r.fn={};r.is=function(a,c){c=y.call(c);if(c=="finite")return!ha[o](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ga.call(a).slice(8,-1).toLowerCase()==c};r.angle=function(a,c,d,f,i,e){if(i==null){a-=d;c-=f;if(!a&&!c)return 0;return((a<0)*180+B.atan(-c/-a)*180/z+360)%360}return r.angle(a,c,i,e)-r.angle(d,f,i,e)};r.rad=function(a){return a%360*z/180};r.deg=function(a){return a*
180/z%360};r.snapTo=function(a,c,d){d=r.is(d,"finite")?d:10;if(r.is(a,P))for(var f=a.length;f--;){if(j(a[f]-c)<=d)return a[f]}else{a=+a;f=c%a;if(f<d)return c-f;if(f>a-d)return c-f+a}return c};r.setWindow=function(a){h=a;g=h.document};var Fa=function(a){if(r.vml){var c=/^\s+|\s+$/g,d;try{var f=new ActiveXObject("htmlfile");f.write("<body>");f.close();d=f.body}catch(i){d=createPopup().document.body}var e=d.createTextRange();Fa=N(function(u){try{d.style.color=l(u).replace(c,"");var v=e.queryCommandValue("ForeColor");
return"#"+("000000"+((v&255)<<16|v&65280|(v&16711680)>>>16)[X](16)).slice(-6)}catch(x){return"none"}})}else{var p=g.createElement("i");p.title="Rapha\u00ebl Colour Picker";p.style.display="none";g.body.appendChild(p);Fa=N(function(u){p.style.color=u;return g.defaultView.getComputedStyle(p,"").getPropertyValue("color")})}return Fa(a)},$a=function(){return"hsb("+[this.h,this.s,this.b]+")"},Bb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Cb=function(){return this.hex};r.hsb2rgb=function(a,c,d,
f){if(r.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;f=a.o}return r.hsl2rgb(a,c,d/2,f)};r.hsl2rgb=function(a,c,d,f){if(r.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var i={},e=["r","g","b"],p;if(c){d<0.5?p=d*(1+c):p=d+c-d*c;c=2*d-p;for(var u=0;u<3;u++){d=a+1/3*-(u-1);d<0&&d++;d>1&&d--;d*6<1?i[e[u]]=c+(p-c)*6*d:d*2<1?i[e[u]]=p:d*3<2?i[e[u]]=c+(p-c)*(2/3-d)*6:i[e[u]]=c}}else i={r:d,g:d,b:d};i.r*=255;i.g*=255;i.b*=255;i.hex="#"+
(16777216|i.b|i.g<<8|i.r<<16).toString(16).slice(1);r.is(f,"finite")&&(i.opacity=f);i.toString=Cb;return i};r.rgb2hsb=function(a,c,d){if(c==null&&r.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&r.is(a,"string")){d=r.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=F(a,c,d),i=Q(a,c,d),e;if(i==f)return{h:0,s:0,b:f,toString:$a};i=f-i;a==f?e=(c-d)/i:c==f?e=2+(d-a)/i:e=4+(a-c)/i;e/=6;e<0&&e++;e>1&&e--;return{h:e,s:i/f,b:f,toString:$a}};r.rgb2hsl=function(a,
c,d){if(c==null&&r.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&r.is(a,"string")){d=r.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=F(a,c,d),i=Q(a,c,d),e,p=(f+i)/2;if(i==f)a={h:0,s:0,l:p};else{var u=f-i;a==f?e=(c-d)/u:c==f?e=2+(d-a)/u:e=4+(a-c)/u;e/=6;e<0&&e++;e>1&&e--;a={h:e,s:p<0.5?u/(f+i):u/(2-f-i),l:p}}a.toString=Bb;return a};r._path2string=function(){return this.join(",").replace(wb,"$1")};r.getRGB=N(function(a){if(!a||(a=l(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(vb[o](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Fa(a));var c,d,f,i,e;if(a=a.match(la)){if(a[2]){f=na(a[2].substring(5),16);d=na(a[2].substring(3,5),16);c=na(a[2].substring(1,3),16)}if(a[3]){f=na((e=a[3].charAt(3))+e,16);d=na((e=a[3].charAt(2))+e,16);c=na((e=a[3].charAt(1))+e,16)}if(a[4]){e=a[4].split(Pa);c=Y(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=Y(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=Y(e[2]);
e[2].slice(-1)=="%"&&(f*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(i=Y(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100)}if(a[5]){e=a[5].split(Pa);c=Y(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=Y(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=Y(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(i=Y(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100);return r.hsb2rgb(c,d,f,i)}if(a[6]){e=a[6].split(Pa);c=Y(e[0]);e[0].slice(-1)=="%"&&(c*=
2.55);d=Y(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=Y(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(i=Y(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100);return r.hsl2rgb(c,d,f,i)}a={r:c,g:d,b:f};a.hex="#"+(16777216|f|d<<8|c<<16).toString(16).slice(1);r.is(i,"finite")&&(a.opacity=i);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},r);r.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};r.getColor.reset=function(){delete this.start};r.parsePathString=N(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];r.is(a,P)&&r.is(a[0],P)&&(d=Ga(a));d[q]||l(a).replace(xb,function(f,i,e){var p=[];f=y.call(i);e.replace(yb,function(u,v){v&&p[ba](+v)});if(f=="m"&&p[q]>2){d[ba]([i].concat(p.splice(0,2)));f="l";i=i=="m"?"l":"L"}for(;p[q]>=c[f];){d[ba]([i].concat(p.splice(0,
c[f])));if(!c[f])break}});d[X]=r._path2string;return d});r.findDotsAtSegment=function(a,c,d,f,i,e,p,u,v){var x=1-v,I=s(x,3)*a+s(x,2)*3*v*d+x*3*v*v*i+s(v,3)*p;x=s(x,3)*c+s(x,2)*3*v*f+x*3*v*v*e+s(v,3)*u;var L=a+2*v*(d-a)+v*v*(i-2*d+a),M=c+2*v*(f-c)+v*v*(e-2*f+c),U=d+2*v*(i-d)+v*v*(p-2*i+d),ea=f+2*v*(e-f)+v*v*(u-2*e+f);a=(1-v)*a+v*d;c=(1-v)*c+v*f;i=(1-v)*i+v*p;e=(1-v)*e+v*u;u=90-B.atan((L-U)/(M-ea))*180/z;(L>U||M<ea)&&(u+=180);return{x:I,y:x,m:{x:L,y:M},n:{x:U,y:ea},start:{x:a,y:c},end:{x:i,y:e},alpha:u}};
var Ia=N(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ha(a);for(var c=0,d=0,f=[],i=[],e,p=0,u=a[q];p<u;p++){e=a[p];if(e[0]=="M"){c=e[1];d=e[2];f[ba](c);i[ba](d)}else{c=Db(c,d,e[1],e[2],e[3],e[4],e[5],e[6]);f=f.concat(c.min.x,c.max.x);i=i.concat(c.min.y,c.max.y);c=e[5];d=e[6]}}a=Q[O](0,f);e=Q[O](0,i);return{x:a,y:e,width:F[O](0,f)-a,height:F[O](0,i)-e}}),Ga=function(a){var c=[];if(!r.is(a,P)||!r.is(a&&a[0],P))a=r.parsePathString(a);for(var d=0,f=a[q];d<f;d++){c[d]=[];for(var i=0,e=a[d][q];i<
e;i++)c[d][i]=a[d][i]}c[X]=r._path2string;return c},Qa=N(function(a){if(!r.is(a,P)||!r.is(a&&a[0],P))a=r.parsePathString(a);var c=[],d=0,f=0,i=0,e=0,p=0;if(a[0][0]=="M"){d=a[0][1];f=a[0][2];i=d;e=f;p++;c[ba](["M",d,f])}for(var u=a[q];p<u;p++){var v=c[p]=[],x=a[p];if(x[0]!=y.call(x[0])){v[0]=y.call(x[0]);switch(v[0]){case "a":v[1]=x[1];v[2]=x[2];v[3]=x[3];v[4]=x[4];v[5]=x[5];v[6]=+(x[6]-d).toFixed(3);v[7]=+(x[7]-f).toFixed(3);break;case "v":v[1]=+(x[1]-f).toFixed(3);break;case "m":i=x[1];e=x[2];default:for(var I=
1,L=x[q];I<L;I++)v[I]=+(x[I]-(I%2?d:f)).toFixed(3)}}else{c[p]=[];if(x[0]=="m"){i=x[1]+d;e=x[2]+f}v=0;for(I=x[q];v<I;v++)c[p][v]=x[v]}x=c[p][q];switch(c[p][0]){case "z":d=i;f=e;break;case "h":d+=+c[p][x-1];break;case "v":f+=+c[p][x-1];break;default:d+=+c[p][x-2];f+=+c[p][x-1]}}c[X]=r._path2string;return c},0,Ga),Aa=N(function(a){if(!r.is(a,P)||!r.is(a&&a[0],P))a=r.parsePathString(a);var c=[],d=0,f=0,i=0,e=0,p=0;if(a[0][0]=="M"){d=+a[0][1];f=+a[0][2];i=d;e=f;p++;c[0]=["M",d,f]}for(var u=a[q];p<u;p++){var v=
c[p]=[],x=a[p];if(x[0]!=wa.call(x[0])){v[0]=wa.call(x[0]);switch(v[0]){case "A":v[1]=x[1];v[2]=x[2];v[3]=x[3];v[4]=x[4];v[5]=x[5];v[6]=+(x[6]+d);v[7]=+(x[7]+f);break;case "V":v[1]=+x[1]+f;break;case "H":v[1]=+x[1]+d;break;case "M":i=+x[1]+d;e=+x[2]+f;default:for(var I=1,L=x[q];I<L;I++)v[I]=+x[I]+(I%2?d:f)}}else{I=0;for(L=x[q];I<L;I++)c[p][I]=x[I]}switch(v[0]){case "Z":d=i;f=e;break;case "H":d=v[1];break;case "V":f=v[1];break;case "M":i=c[p][c[p][q]-2];e=c[p][c[p][q]-1];default:d=c[p][c[p][q]-2];f=
c[p][c[p][q]-1]}}c[X]=r._path2string;return c},null,Ga),ab=function(a,c,d,f,i,e){var p=1/3,u=2/3;return[p*a+u*d,p*c+u*f,p*i+u*d,p*e+u*f,i,e]},bb=function(a,c,d,f,i,e,p,u,v,x){var I=z*120/180,L=z/180*(+i||0),M=[],U,ea=N(function(oa,pa,ma){var ya=oa*B.cos(ma)-pa*B.sin(ma);oa=oa*B.sin(ma)+pa*B.cos(ma);return{x:ya,y:oa}});if(x){$=x[0];U=x[1];e=x[2];R=x[3]}else{U=ea(a,c,-L);a=U.x;c=U.y;U=ea(u,v,-L);u=U.x;v=U.y;B.cos(z/180*i);B.sin(z/180*i);U=(a-u)/2;$=(c-v)/2;R=U*U/(d*d)+$*$/(f*f);if(R>1){R=B.sqrt(R);
d*=R;f*=R}R=d*d;var V=f*f;R=(e==p?-1:1)*B.sqrt(j((R*V-R*$*$-V*U*U)/(R*$*$+V*U*U)));e=R*d*$/f+(a+u)/2;var R=R*-f*U/d+(c+v)/2,$=B.asin(((c-R)/f).toFixed(9));U=B.asin(((v-R)/f).toFixed(9));$=a<e?z-$:$;U=u<e?z-U:U;$<0&&($=z*2+$);U<0&&(U=z*2+U);p&&$>U&&($-=z*2);!p&&U>$&&(U-=z*2)}if(j(U-$)>I){M=U;V=u;var ka=v;U=$+I*(p&&U>$?1:-1);u=e+d*B.cos(U);v=R+f*B.sin(U);M=bb(u,v,d,f,i,0,p,V,ka,[U,M,e,R])}e=U-$;i=B.cos($);I=B.sin($);p=B.cos(U);U=B.sin(U);e=B.tan(e/4);d=4/3*d*e;e*=4/3*f;f=[a,c];a=[a+d*I,c-e*i];c=[u+
d*U,v-e*p];u=[u,v];a[0]=2*f[0]-a[0];a[1]=2*f[1]-a[1];if(x)return[a,c,u].concat(M);M=[a,c,u].concat(M)[w]().split(",");x=[];u=0;for(v=M[q];u<v;u++)x[u]=u%2?ea(M[u-1],M[u],L).y:ea(M[u],M[u+1],L).x;return x},Ja=function(a,c,d,f,i,e,p,u,v){var x=1-v;return{x:s(x,3)*a+s(x,2)*3*v*d+x*3*v*v*i+s(v,3)*p,y:s(x,3)*c+s(x,2)*3*v*f+x*3*v*v*e+s(v,3)*u}},Db=N(function(a,c,d,f,i,e,p,u){var v=i-2*d+a-(p-2*i+d),x=2*(d-a)-2*(i-d),I=a-d,L=(-x+B.sqrt(x*x-4*v*I))/2/v;v=(-x-B.sqrt(x*x-4*v*I))/2/v;var M=[c,u],U=[a,p];j(L)>
"1e12"&&(L=0.5);j(v)>"1e12"&&(v=0.5);if(L>0&&L<1){L=Ja(a,c,d,f,i,e,p,u,L);U[ba](L.x);M[ba](L.y)}if(v>0&&v<1){L=Ja(a,c,d,f,i,e,p,u,v);U[ba](L.x);M[ba](L.y)}v=e-2*f+c-(u-2*e+f);x=2*(f-c)-2*(e-f);I=c-f;L=(-x+B.sqrt(x*x-4*v*I))/2/v;v=(-x-B.sqrt(x*x-4*v*I))/2/v;j(L)>"1e12"&&(L=0.5);j(v)>"1e12"&&(v=0.5);if(L>0&&L<1){L=Ja(a,c,d,f,i,e,p,u,L);U[ba](L.x);M[ba](L.y)}if(v>0&&v<1){L=Ja(a,c,d,f,i,e,p,u,v);U[ba](L.x);M[ba](L.y)}return{min:{x:Q[O](0,U),y:Q[O](0,M)},max:{x:F[O](0,U),y:F[O](0,M)}}}),Ha=N(function(a,
c){var d=Aa(a),f=c&&Aa(c),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},p=function(V,R){var $,ka;if(!V)return["C",R.x,R.y,R.x,R.y,R.x,R.y];!(V[0]in{T:1,Q:1})&&(R.qx=R.qy=null);switch(V[0]){case "M":R.X=V[1];R.Y=V[2];break;case "A":V=["C"].concat(bb[O](0,[R.x,R.y].concat(V.slice(1))));break;case "S":$=R.x+(R.x-(R.bx||R.x));ka=R.y+(R.y-(R.by||R.y));V=["C",$,ka].concat(V.slice(1));break;case "T":R.qx=R.x+(R.x-(R.qx||R.x));R.qy=R.y+(R.y-(R.qy||R.y));V=["C"].concat(ab(R.x,
R.y,R.qx,R.qy,V[1],V[2]));break;case "Q":R.qx=V[1];R.qy=V[2];V=["C"].concat(ab(R.x,R.y,V[1],V[2],V[3],V[4]));break;case "L":V=["C"].concat([R.x,R.y,V[1],V[2],V[1],V[2]]);break;case "H":V=["C"].concat([R.x,R.y,V[1],R.y,V[1],R.y]);break;case "V":V=["C"].concat([R.x,R.y,R.x,V[1],R.x,V[1]]);break;case "Z":V=["C"].concat([R.x,R.y,R.X,R.Y,R.X,R.Y])}return V},u=function(V,R){if(V[R][q]>7){V[R].shift();for(var $=V[R];$[q];)V.splice(R++,0,["C"].concat($.splice(0,6)));V.splice(R,1);I=F(d[q],f&&f[q]||0)}},v=
function(V,R,$,ka,oa){if(V&&R&&V[oa][0]=="M"&&R[oa][0]!="M"){R.splice(oa,0,["M",ka.x,ka.y]);$.bx=0;$.by=0;$.x=V[oa][1];$.y=V[oa][2];I=F(d[q],f&&f[q]||0)}},x=0,I=F(d[q],f&&f[q]||0);for(;x<I;x++){d[x]=p(d[x],i);u(d,x);f&&(f[x]=p(f[x],e));f&&u(f,x);v(d,f,i,e,x);v(f,d,e,i,x);var L=d[x],M=f&&f[x],U=L[q],ea=f&&M[q];i.x=L[U-2];i.y=L[U-1];i.bx=Y(L[U-4])||i.x;i.by=Y(L[U-3])||i.y;e.bx=f&&(Y(M[ea-4])||e.x);e.by=f&&(Y(M[ea-3])||e.y);e.x=f&&M[ea-2];e.y=f&&M[ea-1]}return f?[d,f]:d},null,Ga),cb=N(function(a){for(var c=
[],d=0,f=a[q];d<f;d++){var i={},e=a[d].match(/^([^:]*):?([\d\.]*)/);i.color=r.getRGB(e[1]);if(i.color.error)return null;i.color=i.color.hex;e[2]&&(i.offset=e[2]+"%");c[ba](i)}d=1;for(f=c[q]-1;d<f;d++)if(!c[d].offset){a=Y(c[d-1].offset||0);e=0;for(i=d+1;i<f;i++)if(c[i].offset){e=c[i].offset;break}if(!e){e=100;i=f}e=Y(e);for(e=(e-a)/(i-d+1);d<i;d++){a+=e;c[d].offset=a+"%"}}return c}),db=function(a,c,d,f){if(r.is(a,"string")||r.is(a,"object")){a=r.is(a,"string")?g.getElementById(a):a;if(a.tagName)return c==
null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:f}},Ra=function(a,c){var d=this,f;for(f in c)if(c[o](f)&&!(f in a))switch(typeof c[f]){case "function":(function(i){a[f]=a===d?i:function(){return i[O](d,arguments)}})(c[f]);break;case "object":a[f]=a[f]||{};Ra.call(this,a[f],c[f]);break;default:a[f]=c[f]}},za=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=
a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},eb=function(a,c){if(c.top!==a){za(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},fb=function(a,c){if(c.bottom!==a){za(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},gb=function(a,c,d){za(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},hb=function(a,c,d){za(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;a.next=c},ib=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+
a+"\u201d of removed object");}};r.pathToRelative=Qa;if(r.svg){D.svgns="http://www.w3.org/2000/svg";D.xlink="http://www.w3.org/1999/xlink";ca=function(a){return+a+(~~a===a)*0.5};var da=function(a,c){if(c)for(var d in c)c[o](d)&&a.setAttribute(d,l(c[d]));else{a=g.createElementNS(D.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};r[X]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var jb=function(a,c){var d=da("path");c.canvas&&c.canvas.appendChild(d);
d=new ja(d,c);d.type="path";xa(d,{fill:"none",stroke:"#000",path:a});return d},Ba=function(a,c,d){var f="linear",i=0.5,e=0.5,p=a.style;c=l(c).replace(Za,function(I,L,M){f="radial";if(L&&M){i=Y(L);e=Y(M);I=(e>0.5)*2-1;s(i-0.5,2)+s(e-0.5,2)>0.25&&(e=B.sqrt(0.25-s(i-0.5,2))*I+0.5)&&e!=0.5&&(e=e.toFixed(5)-1.0E-5*I)}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var u=c.shift();u=-Y(u);if(isNaN(u))return null;u=[0,0,B.cos(u*z/180),B.sin(u*z/180)];var v=1/(F(j(u[2]),j(u[3]))||1);u[2]*=v;u[3]*=v;if(u[2]<
0){u[0]=-u[2];u[2]=0}if(u[3]<0){u[1]=-u[3];u[3]=0}}c=cb(c);if(!c)return null;v=a.getAttribute("fill");(v=v.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(g.getElementById(v[1]));v=da(f+"Gradient");v.id=Z();da(v,f=="radial"?{fx:i,fy:e}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3]});d.defs.appendChild(v);d=0;for(u=c[q];d<u;d++){var x=da("stop");da(x,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});v.appendChild(x)}da(a,{fill:"url(#"+v.id+")",opacity:1,"fill-opacity":1});p.fill="";p.opacity=
1;return p.fillOpacity=1},Sa=function(a){var c=a.getBBox();da(a.pattern,{patternTransform:r.format("translate({0},{1})",c.x,c.y)})},xa=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},f=a.node,i=a.attrs,e=a.rotate(),p=function(ea,V){if(V=d[y.call(V)]){for(var R=ea.attrs["stroke-width"]||"1",$={round:R,square:R,butt:0}[ea.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,
ka=[],oa=V[q];oa--;)ka[oa]=V[oa]*R+(oa%2?1:-1)*$;da(f,{"stroke-dasharray":ka[w](",")})}};c[o]("rotation")&&(e=c.rotation);var u=l(e).split(J);if(u.length-1){u[1]=+u[1];u[2]=+u[2]}else u=null;Y(e)&&a.rotate(0,true);for(var v in c)if(c[o](v))if(Ea[o](v)){var x=c[v];i[v]=x;switch(v){case "blur":a.blur(x);break;case "rotation":a.rotate(x,true);break;case "href":case "title":case "target":var I=f.parentNode;if(y.call(I.tagName)!="a"){var L=da("a");I.insertBefore(L,f);L.appendChild(f);I=L}v=="target"&&
x=="blank"?I.setAttributeNS(a.paper.xlink,"show","new"):I.setAttributeNS(a.paper.xlink,v,x);break;case "cursor":f.style.cursor=x;break;case "clip-rect":I=l(x).split(J);if(I[q]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var M=da("clipPath");L=da("rect");M.id=Z();da(L,{x:I[0],y:I[1],width:I[2],height:I[3]});M.appendChild(L);a.paper.defs.appendChild(M);da(f,{"clip-path":"url(#"+M.id+")"});a.clip=L}if(!x){(x=g.getElementById(f.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,
"")))&&x.parentNode.removeChild(x);da(f,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&da(f,{d:x?i.path=Aa(x):"M0,0"});break;case "width":f.setAttribute(v,x);if(i.fx){v="x";x=i.x}else break;case "x":i.fx&&(x=-i.x-(i.width||0));case "rx":if(v=="rx"&&a.type=="rect")break;case "cx":u&&(v=="x"||v=="cx")&&(u[1]+=x-i[v]);f.setAttribute(v,x);a.pattern&&Sa(a);break;case "height":f.setAttribute(v,x);if(i.fy){v="y";x=i.y}else break;case "y":i.fy&&(x=-i.y-(i.height||0));case "ry":if(v=="ry"&&
a.type=="rect")break;case "cy":u&&(v=="y"||v=="cy")&&(u[2]+=x-i[v]);f.setAttribute(v,x);a.pattern&&Sa(a);break;case "r":a.type=="rect"?da(f,{rx:x,ry:x}):f.setAttribute(v,x);break;case "src":a.type=="image"&&f.setAttributeNS(a.paper.xlink,"href",x);break;case "stroke-width":f.style.strokeWidth=x;f.setAttribute(v,x);i["stroke-dasharray"]&&p(a,i["stroke-dasharray"]);break;case "stroke-dasharray":p(a,x);break;case "translation":x=l(x).split(J);x[0]=+x[0]||0;x[1]=+x[1]||0;if(u){u[1]+=x[0];u[2]+=x[1]}Ka.call(a,
x[0],x[1]);break;case "scale":x=l(x).split(J);a.scale(+x[0]||1,+x[1]||+x[0]||1,isNaN(Y(x[2]))?null:+x[2],isNaN(Y(x[3]))?null:+x[3]);break;case "fill":if(I=l(x).match(fa)){M=da("pattern");var U=da("image");M.id=Z();da(M,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});da(U,{x:0,y:0});U.setAttributeNS(a.paper.xlink,"href",I[1]);M.appendChild(U);x=g.createElement("img");x.style.cssText="position:absolute;left:-9999em;top-9999em";x.onload=function(){da(M,{width:this.offsetWidth,height:this.offsetHeight});
da(U,{width:this.offsetWidth,height:this.offsetHeight});g.body.removeChild(this);a.paper.safari()};g.body.appendChild(x);x.src=I[1];a.paper.defs.appendChild(M);f.style.fill="url(#"+M.id+")";da(f,{fill:"url(#"+M.id+")"});a.pattern=M;a.pattern&&Sa(a);break}I=r.getRGB(x);if(I.error)if(({circle:1,ellipse:1}[o](a.type)||l(x).charAt()!="r")&&Ba(f,x,a.paper)){i.gradient=x;i.fill="none";break}else{delete c.gradient;delete i.gradient;!r.is(i.opacity,"undefined")&&r.is(c.opacity,"undefined")&&da(f,{opacity:i.opacity});
!r.is(i["fill-opacity"],"undefined")&&r.is(c["fill-opacity"],"undefined")&&da(f,{"fill-opacity":i["fill-opacity"]})}I[o]("opacity")&&da(f,{"fill-opacity":I.opacity>1?I.opacity/100:I.opacity});case "stroke":I=r.getRGB(x);f.setAttribute(v,I.hex);v=="stroke"&&I[o]("opacity")&&da(f,{"stroke-opacity":I.opacity>1?I.opacity/100:I.opacity});break;case "gradient":(({circle:1,ellipse:1})[o](a.type)||l(x).charAt()!="r")&&Ba(f,x,a.paper);break;case "opacity":i.gradient&&!i[o]("stroke-opacity")&&da(f,{"stroke-opacity":x>
1?x/100:x});case "fill-opacity":if(i.gradient){if(I=g.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,""))){I=I.getElementsByTagName("stop");I[I[q]-1].setAttribute("stop-opacity",x)}break}default:v=="font-size"&&(x=na(x,10)+"px");I=v.replace(/(\-.)/g,function(ea){return wa.call(ea.substring(1))});f.style[I]=x;f.setAttribute(v,x)}}Eb(a,c);u?a.rotate(u.join(aa)):Y(e)&&a.rotate(e,true)},Eb=function(a,c){if(!(a.type!="text"||!(c[o]("text")||c[o]("font")||c[o]("font-size")||c[o]("x")||c[o]("y")))){var d=
a.attrs,f=a.node,i=f.firstChild?na(g.defaultView.getComputedStyle(f.firstChild,"").getPropertyValue("font-size"),10):10;if(c[o]("text")){for(d.text=c.text;f.firstChild;)f.removeChild(f.firstChild);for(var e=l(c.text).split("\n"),p=0,u=e[q];p<u;p++)if(e[p]){var v=da("tspan");p&&da(v,{dy:i*1.2,x:d.x});v.appendChild(g.createTextNode(e[p]));f.appendChild(v)}}else{e=f.getElementsByTagName("tspan");p=0;for(u=e[q];p<u;p++)p&&da(e[p],{dy:i*1.2,x:d.x})}da(f,{y:d.y});i=a.getBBox();(i=d.y-(i.y+i.height/2))&&
r.is(i,"finite")&&da(f,{y:d.y+i})}},ja=function(a,c){this[0]=a;this.id=r._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ia=ja[C];ja[C].rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][w](aa);return this._.rt.deg}var f=this.getBBox();
a=l(a).split(J);if(a[q]-1){c=Y(a[1]);d=Y(a[2])}a=Y(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?f.x+f.width/2:c;d=d==null?f.y+f.height/2:d;if(this._.rt.deg){this.transformations[0]=r.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&da(this.clip,{transform:r.format("rotate({0} {1} {2})",-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&da(this.clip,{transform:""})}da(this.node,{transform:this.transformations[w](aa)});
return this};ja[C].hide=function(){!this.removed&&(this.node.style.display="none");return this};ja[C].show=function(){!this.removed&&(this.node.style.display="");return this};ja[C].remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ja[C].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ia(this.attrs.path);if(this.node.style.display=="none"){this.show();var a=true}var c={};
try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var f=0,i=this.node.getNumberOfChars();f<i;f++){var e=this.node.getExtentOfChar(f);e.y<c.y&&(c.y=e.y);e.y+e.height-c.y>c.height&&(c.height=e.y+e.height-c.y);e.x+e.width-c.x>c.width&&(c.width=e.x+e.width-c.x)}}a&&this.hide();return c};ja[C].attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[o](f)&&(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=
this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&r.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==null&&r.is(a,P)){f={};d=0;for(var i=a.length;d<i;d++)f[a[d]]=this.attr(a[d]);return f}if(c!=null){d={};
d[a]=c}else a!=null&&r.is(a,"object")&&(d=a);for(i in this.paper.customAttributes)if(this.paper.customAttributes[o](i)&&d[o](i)&&r.is(this.paper.customAttributes[i],"function")){f=this.paper.customAttributes[i].apply(this,[].concat(d[i]));this.attrs[i]=d[i];for(var e in f)f[o](e)&&(d[e]=f[e])}xa(this,d);return this};ja[C].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&eb(this,a);return this};ja[C].toBack=function(){if(this.removed)return this;
if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);fb(this,this.paper)}return this};ja[C].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);gb(this,a,this.paper);return this};ja[C].insertBefore=function(a){if(this.removed)return this;var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,
c);hb(this,a,this.paper);return this};ja[C].blur=function(a){if(+a!==0){var c=da("filter"),d=da("feGaussianBlur");this.attrs.blur=a;c.id=Z();da(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;da(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var kb=function(a,c,d,f){var i=da("circle");a.canvas&&a.canvas.appendChild(i);a=new ja(i,
a);a.attrs={cx:c,cy:d,r:f,fill:"none",stroke:"#000"};a.type="circle";da(i,a.attrs);return a},lb=function(a,c,d,f,i,e){var p=da("rect");a.canvas&&a.canvas.appendChild(p);a=new ja(p,a);a.attrs={x:c,y:d,width:f,height:i,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";da(p,a.attrs);return a},mb=function(a,c,d,f,i){var e=da("ellipse");a.canvas&&a.canvas.appendChild(e);a=new ja(e,a);a.attrs={cx:c,cy:d,rx:f,ry:i,fill:"none",stroke:"#000"};a.type="ellipse";da(e,a.attrs);return a},nb=function(a,
c,d,f,i,e){var p=da("image");da(p,{x:d,y:f,width:i,height:e,preserveAspectRatio:"none"});p.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(p);a=new ja(p,a);a.attrs={x:d,y:f,width:i,height:e,src:c};a.type="image";return a},ob=function(a,c,d,f){var i=da("text");da(i,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(i);a=new ja(i,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:f,font:Ea.font,stroke:"none",fill:"#000"};a.type="text";xa(a,a.attrs);return a},pb=function(a,
c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Na=function(){var a=db[O](0,arguments),c=a&&a.container,d=a.x,f=a.y,i=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var e=da("svg");d=d||0;f=f||0;i=i||512;a=a||342;da(e,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:i,height:a});if(c==1){e.style.cssText="position:absolute;left:"+d+"px;top:"+f+"px";g.body.appendChild(e)}else c.firstChild?
c.insertBefore(e,c.firstChild):c.appendChild(e);c=new E;c.width=i;c.height=a;c.canvas=e;Ra.call(c,c,r.fn);c.clear();return c};D.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=da("desc")).appendChild(g.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=da("defs"))};D.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a)}}if(r.vml){var qb=
{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Fb=/([clmz]),?([^clmz]*)/gi,Gb=/ progid:\S+Blur\([^\)]+\)/g,Hb=/-?[^,\s-]+/g,Ca=1E3+aa+1E3,Da={path:1,rect:1},Ib=function(a){var c=/[ahqstv]/ig,d=Aa;l(a).match(c)&&(d=Ha);c=/[clmz]/g;if(d==Aa&&!l(a).match(c))return a=l(a).replace(Fb,function(v,x,I){var L=[],M=y.call(x)=="m",U=qb[x];I.replace(Hb,function(ea){if(M&&L[q]==2){U+=L+qb[x=="m"?"l":"L"];L=[]}L[ba](ca(ea*10))});return U+L});c=d(a);var f;a=[];for(var i=0,e=c[q];i<e;i++){d=c[i];f=y.call(c[i][0]);
f=="z"&&(f="x");for(var p=1,u=d[q];p<u;p++)f+=ca(d[p]*10)+(p!=u-1?",":"");a[ba](f)}return a[w](aa)};r[X]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};jb=function(a,c){var d=qa("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var f=qa("shape"),i=f.style;i.width=c.width+"px";i.height=c.height+"px";f.coordsize=Ca;f.coordorigin=
c.coordorigin;d.appendChild(f);f=new ja(f,d,c);i={fill:"none",stroke:"#000"};a&&(i.path=a);f.type="path";f.path=[];f.Path="";xa(f,i);c.canvas.appendChild(d);return f};xa=function(a,c){a.attrs=a.attrs||{};var d=a.node,f=a.attrs,i=d.style,e;e=(c.x!=f.x||c.y!=f.y||c.width!=f.width||c.height!=f.height||c.r!=f.r)&&a.type=="rect";for(var p in c)c[o](p)&&(f[p]=c[p]);if(e){f.path=rb(f.x,f.y,f.width,f.height,f.r);a.X=f.x;a.Y=f.y;a.W=f.width;a.H=f.height}c.href&&(d.href=c.href);c.title&&(d.title=c.title);c.target&&
(d.target=c.target);c.cursor&&(i.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||e)d.path=Ib(f.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){e=l(c.translation).split(J);Ka.call(a,e[0],e[1]);if(a._.rt.cx!=null){a._.rt.cx+=+e[0];a._.rt.cy+=+e[1];a.setBox(a.attrs,e[0],e[1])}}if(c.scale){e=l(c.scale).split(J);a.scale(+e[0]||1,+e[1]||+e[0]||1,+e[2]||null,+e[3]||null)}if("clip-rect"in c){e=l(c["clip-rect"]).split(J);if(e[q]==4){e[2]=+e[2]+ +e[0];e[3]=+e[3]+ +e[1];
p=d.clipRect||g.createElement("div");var u=p.style,v=d.parentNode;u.clip=r.format("rect({1}px {2}px {3}px {0}px)",e);if(!d.clipRect){u.position="absolute";u.top=0;u.left=0;u.width=a.paper.width+"px";u.height=a.paper.height+"px";v.parentNode.insertBefore(p,v);p.appendChild(v);d.clipRect=p}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+c.opacity*100+")";i.filter=
(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(i.font=c.font);c["font-family"]&&(i.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(i.fontSize=c["font-size"]);c["font-weight"]&&(i.fontWeight=c["font-weight"]);c["font-style"]&&(i.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=
null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;e=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];p=false;!e&&(p=e=qa("fill"));if("fill-opacity"in c||"opacity"in c){i=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+r.getRGB(c.fill).o+1||2)-1);i=Q(F(i,0),1);e.opacity=i}c.fill&&(e.on=true);if(e.on==null||c.fill=="none")e.on=false;if(e.on&&c.fill)if(i=c.fill.match(fa)){e.src=i[1];e.type="tile"}else{e.color=r.getRGB(c.fill).hex;e.src="";e.type="solid";
if(r.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||l(c.fill).charAt()!="r")&&Ba(a,c.fill)){f.fill="none";f.gradient=c.fill}}p&&d.appendChild(e);e=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];p=false;!e&&(p=e=qa("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])e.on=true;(c.stroke=="none"||e.on==null||c.stroke==0||c["stroke-width"]==0)&&(e.on=
false);i=r.getRGB(c.stroke);e.on&&c.stroke&&(e.color=i.hex);i=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+i.o+1||2)-1);u=(Y(c["stroke-width"])||1)*0.75;i=Q(F(i,0),1);c["stroke-width"]==null&&(u=f["stroke-width"]);c["stroke-width"]&&(e.weight=u);u&&u<1&&(i*=u)&&(e.weight=1);e.opacity=i;c["stroke-linejoin"]&&(e.joinstyle=c["stroke-linejoin"]||"miter");e.miterlimit=c["stroke-miterlimit"]||8;c["stroke-linecap"]&&(e.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":
"round");if(c["stroke-dasharray"]){i={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};e.dashstyle=i[o](c["stroke-dasharray"])?i[c["stroke-dasharray"]]:""}p&&d.appendChild(e)}if(a.type=="text"){i=a.paper.span.style;f.font&&(i.font=f.font);f["font-family"]&&(i.fontFamily=f["font-family"]);f["font-size"]&&(i.fontSize=f["font-size"]);f["font-weight"]&&(i.fontWeight=f["font-weight"]);
f["font-style"]&&(i.fontStyle=f["font-style"]);a.node.string&&(a.paper.span.innerHTML=l(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=f.w=a.paper.span.offsetWidth;a.H=f.h=a.paper.span.offsetHeight;a.X=f.x;a.Y=f.y+ca(a.H/2);switch(f["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=ca(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-ca(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ba=function(a,c){a.attrs=
a.attrs||{};var d,f="linear",i=".5 .5";a.attrs.gradient=c;c=l(c).replace(Za,function(I,L,M){f="radial";if(L&&M){L=Y(L);M=Y(M);s(L-0.5,2)+s(M-0.5,2)>0.25&&(M=B.sqrt(0.25-s(L-0.5,2))*((M>0.5)*2-1)+0.5);i=L+aa+M}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var e=c.shift();e=-Y(e);if(isNaN(e))return null}var p=cb(c);if(!p)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||qa("fill");!d.parentNode&&a.appendChild(d);if(p[q]){d.on=true;d.method="none";d.color=p[0].color;d.color2=p[p[q]-
1].color;for(var u=[],v=0,x=p[q];v<x;v++)p[v].offset&&u[ba](p[v].offset+aa+p[v].color);d.colors&&(d.colors.value=u[q]?u[w]():"0% "+d.color);if(f=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=i;d.focusposition=i}else{d.type="gradient";d.angle=(270-e)%360}}return 1};ja=function(a,c,d){this[0]=a;this.id=r._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=
this);d.top=this;this.next=null};ia=ja[C];ia.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][w](aa);return this._.rt.deg}a=l(a).split(J);if(a[q]-1){c=Y(a[1]);d=Y(a[2])}a=Y(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=this._.rt.deg;return this};ia.setBox=function(a,c,d){if(this.removed)return this;var f=this.Group.style,
i=this.shape&&this.shape.style||this.node.style;a=a||{};for(var e in a)a[o](e)&&(this.attrs[e]=a[e]);c=c||this._.rt.cx;d=d||this._.rt.cy;var p=this.attrs,u;switch(this.type){case "circle":a=p.cx-p.r;e=p.cy-p.r;u=p=p.r*2;break;case "ellipse":a=p.cx-p.rx;e=p.cy-p.ry;u=p.rx*2;p=p.ry*2;break;case "image":a=+p.x;e=+p.y;u=p.width||0;p=p.height||0;break;case "text":this.textpath.v=["m",ca(p.x),", ",ca(p.y-2),"l",ca(p.x)+1,", ",ca(p.y-2)][w]("");a=p.x-ca(this.W/2);e=p.y-this.H/2;u=this.W;p=this.H;break;case "rect":case "path":if(this.attrs.path){p=
Ia(this.attrs.path);a=p.x;e=p.y;u=p.width;p=p.height}else{e=a=0;u=this.paper.width;p=this.paper.height}break;default:e=a=0;u=this.paper.width;p=this.paper.height}c=(c==null?a+u/2:c)-this.paper.width/2;d=(d==null?e+p/2:d)-this.paper.height/2;var v;f.left!=(v=c+"px")&&(f.left=v);f.top!=(v=d+"px")&&(f.top=v);this.X=Da[o](this.type)?-c:a;this.Y=Da[o](this.type)?-d:e;this.W=u;this.H=p;if(Da[o](this.type)){i.left!=(v=-c*10+"px")&&(i.left=v);i.top!=(v=-d*10+"px")&&(i.top=v)}else if(this.type=="text"){i.left!=
(v=-c+"px")&&(i.left=v);i.top!=(v=-d+"px")&&(i.top=v)}else{f.width!=(v=this.paper.width+"px")&&(f.width=v);f.height!=(v=this.paper.height+"px")&&(f.height=v);i.left!=(v=a-c+"px")&&(i.left=v);i.top!=(v=e-d+"px")&&(i.top=v);i.width!=(v=u+"px")&&(i.width=v);i.height!=(v=p+"px")&&(i.height=v)}};ia.hide=function(){!this.removed&&(this.Group.style.display="none");return this};ia.show=function(){!this.removed&&(this.Group.style.display="block");return this};ia.getBBox=function(){if(this.removed)return this;
if(Da[o](this.type))return Ia(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ia.remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};ia.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[o](f)&&(d[f]=this.attrs[f]);
this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&r.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&c==null&&r.is(a,P)){var i={};f=0;for(d=a[q];f<d;f++)i[a[f]]=this.attr(a[f]);
return i}if(c!=null){d={};d[a]=c}c==null&&r.is(a,"object")&&(d=a);if(d){for(i in this.paper.customAttributes)if(this.paper.customAttributes[o](i)&&d[o](i)&&r.is(this.paper.customAttributes[i],"function")){f=this.paper.customAttributes[i].apply(this,[].concat(d[i]));this.attrs[i]=d[i];for(var e in f)f[o](e)&&(d[e]=f[e])}d.text&&this.type=="text"&&(this.node.string=d.text);xa(this,d);d.gradient&&({circle:1,ellipse:1}[o](this.type)||l(d.gradient).charAt()!="r")&&Ba(this,d.gradient);(!Da[o](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};ia.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&eb(this,this.paper);return this};ia.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);fb(this,this.paper)}return this};ia.insertAfter=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);gb(this,a,this.paper);return this};ia.insertBefore=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);hb(this,a,this.paper);return this};ia.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Gb,"");if(+a!==0){this.attrs.blur=a;c.filter=d+aa+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
c.margin=r.format("-{0}px 0 0 -{0}px",ca(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};kb=function(a,c,d,f){var i=qa("group"),e=qa("oval");i.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";i.coordsize=Ca;i.coordorigin=a.coordorigin;i.appendChild(e);e=new ja(e,i,a);e.type="circle";xa(e,{stroke:"#000",fill:"none"});e.attrs.cx=c;e.attrs.cy=d;e.attrs.r=f;e.setBox({x:c-f,y:d-f,width:f*2,height:f*2});a.canvas.appendChild(i);return e};var rb=function(a,
c,d,f,i){return i?r.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+i,c,d-i*2,i,-i,f-i*2,i*2-d,i*2-f):r.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,f,-d)};lb=function(a,c,d,f,i,e){var p=rb(c,d,f,i,e);a=a.path(p);var u=a.attrs;a.X=u.x=c;a.Y=u.y=d;a.W=u.width=f;a.H=u.height=i;u.r=e;u.path=p;a.type="rect";return a};mb=function(a,c,d,f,i){var e=qa("group"),p=qa("oval");e.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";e.coordsize=Ca;e.coordorigin=a.coordorigin;e.appendChild(p);p=new ja(p,e,a);p.type="ellipse";xa(p,{stroke:"#000"});p.attrs.cx=c;p.attrs.cy=d;p.attrs.rx=f;p.attrs.ry=i;p.setBox({x:c-f,y:d-i,width:f*2,height:i*2});a.canvas.appendChild(e);return p};nb=function(a,c,d,f,i,e){var p=qa("group"),u=qa("image");p.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";p.coordsize=Ca;p.coordorigin=a.coordorigin;u.src=c;p.appendChild(u);u=new ja(u,
p,a);u.type="image";u.attrs.src=c;u.attrs.x=d;u.attrs.y=f;u.attrs.w=i;u.attrs.h=e;u.setBox({x:d,y:f,width:i,height:e});a.canvas.appendChild(p);return u};ob=function(a,c,d,f){var i=qa("group"),e=qa("shape"),p=e.style,u=qa("path"),v=qa("textpath");i.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";i.coordsize=Ca;i.coordorigin=a.coordorigin;u.v=r.format("m{0},{1}l{2},{1}",ca(c*10),ca(d*10),ca(c*10)+1);u.textpathok=true;p.width=a.width;p.height=a.height;v.string=
l(f);v.on=true;e.appendChild(v);e.appendChild(u);i.appendChild(e);p=new ja(v,i,a);p.shape=e;p.textpath=u;p.type="text";p.attrs.text=f;p.attrs.x=c;p.attrs.y=d;p.attrs.w=1;p.attrs.h=1;xa(p,{font:Ea.font,stroke:"none",fill:"#000"});p.setBox();a.canvas.appendChild(i);return p};pb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};var qa;g.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!g.namespaces.rvml&&
g.namespaces.add("rvml","urn:schemas-microsoft-com:vml");qa=function(a){return g.createElement("<rvml:"+a+' class="rvml">')}}catch(Pb){qa=function(a){return g.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Na=function(){var a=db[O](0,arguments),c=a.container,d=a.height,f=a.width,i=a.x;a=a.y;if(!c)throw Error("VML container not found.");var e=new E,p=e.canvas=g.createElement("div"),u=p.style;i=i||0;a=a||0;f=f||512;d=d||342;f==+f&&(f+="px");d==+d&&(d+="px");e.width=1E3;
e.height=1E3;e.coordsize=1E4+aa+1E4;e.coordorigin="0 0";e.span=g.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";p.appendChild(e.span);u.cssText=r.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d);if(c==1){g.body.appendChild(p);u.left=i+"px";u.top=a+"px";u.position="absolute"}else c.firstChild?c.insertBefore(p,c.firstChild):c.appendChild(p);
Ra.call(e,e,r.fn);return e};D.clear=function(){this.canvas.innerHTML="";this.span=g.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};D.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a);return true}}ta=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ta&&ta[1]<
4||navigator.platform.slice(0,2)=="iP")?D.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});h.setTimeout(function(){a.remove()})}:D.safari=function(){};var Jb=function(){this.returnValue=false},Kb=function(){return this.originalEvent.preventDefault()},Lb=function(){this.cancelBubble=true},Mb=function(){return this.originalEvent.stopPropagation()},Nb=function(){if(g.addEventListener)return function(a,c,d,f){var i=W&&G[c]?G[c]:c,e=function(p){if(W&&G[o](c))for(var u=
0,v=p.targetTouches&&p.targetTouches.length;u<v;u++)if(p.targetTouches[u].target==a){v=p;p=p.targetTouches[u];p.originalEvent=v;p.preventDefault=Kb;p.stopPropagation=Mb;break}return d.call(f,p)};a.addEventListener(i,e,false);return function(){a.removeEventListener(i,e,false);return true}};if(g.attachEvent)return function(a,c,d,f){var i=function(e){e=e||h.event;e.preventDefault=e.preventDefault||Jb;e.stopPropagation=e.stopPropagation||Lb;return d.call(f,e)};a.attachEvent("on"+c,i);return function(){a.detachEvent("on"+
c,i);return true}}}(),ua=[],Ta=function(a){for(var c=a.clientX,d=a.clientY,f=g.documentElement.scrollTop||g.body.scrollTop,i=g.documentElement.scrollLeft||g.body.scrollLeft,e,p=ua.length;p--;){e=ua[p];if(W)for(var u=a.touches.length,v;u--;){v=a.touches[u];if(v.identifier==e.el._drag.id){c=v.clientX;d=v.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=i;d+=f;e.move&&e.move.call(e.move_scope||e.el,c-e.el._drag.x,d-e.el._drag.y,c,d,a)}},Ua=function(a){r.unmousemove(Ta).unmouseup(Ua);
for(var c=ua.length,d;c--;){d=ua[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}ua=[]};for(ta=k[q];ta--;)(function(a){r[a]=ja[C][a]=function(c,d){if(r.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Nb(this.shape||this.node||g,a,c,d||this)})}return this};r["un"+a]=ja[C]["un"+a]=function(c){for(var d=this.events,f=d[q];f--;)if(d[f].name==a&&d[f].f==c){d[f].unbind();d.splice(f,1);!d.length&&delete this.events;break}return this}})(k[ta]);
ia.hover=function(a,c,d,f){return this.mouseover(a,d).mouseout(c,f||d)};ia.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ia.drag=function(a,c,d,f,i,e){this._drag={};this.mousedown(function(p){(p.originalEvent||p).preventDefault();var u=g.documentElement.scrollTop||g.body.scrollTop,v=g.documentElement.scrollLeft||g.body.scrollLeft;this._drag.x=p.clientX+v;this._drag.y=p.clientY+u;this._drag.id=p.identifier;c&&c.call(i||f||this,p.clientX+v,p.clientY+u,p);!ua.length&&r.mousemove(Ta).mouseup(Ua);
ua.push({el:this,move:a,end:d,move_scope:f,start_scope:i,end_scope:e})});return this};ia.undrag=function(a,c,d){for(c=ua.length;c--;)ua[c].el==this&&ua[c].move==a&&ua[c].end==d&&ua.splice(c++,1);!ua.length&&r.unmousemove(Ta).unmouseup(Ua)};D.circle=function(a,c,d){return kb(this,a||0,c||0,d||0)};D.rect=function(a,c,d,f,i){return lb(this,a||0,c||0,d||0,f||0,i||0)};D.ellipse=function(a,c,d,f){return mb(this,a||0,c||0,d||0,f||0)};D.path=function(a){a&&!r.is(a,"string")&&!r.is(a[0],P)&&(a+="");return jb(r.format[O](r,
arguments),this)};D.image=function(a,c,d,f,i){return nb(this,a||"about:blank",c||0,d||0,f||0,i||0)};D.text=function(a,c,d){return ob(this,a||0,c||0,l(d))};D.set=function(a){arguments[q]>1&&(a=Array[C].splice.call(arguments,0,arguments[q]));return new sa(a)};D.setSize=pb;D.top=D.bottom=null;D.raphael=r;ia.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};ia.scale=function(a,c,d,f){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,
toString:A};c=c||a;!+c&&(c=a);var i,e,p=this.attrs;if(a!=0){var u=this.getBBox(),v=u.x+u.width/2,x=u.y+u.height/2;i=j(a/this._.sx);e=j(c/this._.sy);d=+d||d==0?d:v;f=+f||f==0?f:x;var I=this._.sx>0,L=this._.sy>0;u=~~(a/j(a));var M=~~(c/j(c)),U=i*u,ea=e*M,V=this.node.style;v=d+j(v-d)*U*(v>d==I?1:-1);x=f+j(x-f)*ea*(x>f==L?1:-1);var R=a*u>c*M?e:i;switch(this.type){case "rect":case "image":var $=p.width*i,ka=p.height*e;this.attr({height:ka,r:p.r*R,width:$,x:v-$/2,y:x-ka/2});break;case "circle":case "ellipse":this.attr({rx:p.rx*
i,ry:p.ry*e,r:p.r*R,cx:v,cy:x});break;case "text":this.attr({x:v,y:x});break;case "path":R=Qa(p.path);var oa=true;I=I?U:i;L=L?ea:e;ea=0;for(U=R[q];ea<U;ea++){var pa=R[ea],ma=wa.call(pa[0]);if(!(ma=="M"&&oa)){oa=false;if(ma=="A"){pa[R[ea][q]-2]*=I;pa[R[ea][q]-1]*=L;pa[1]*=i;pa[2]*=e;pa[5]=+(u+M?!!+pa[5]:!+pa[5])}else if(ma=="H"){ma=1;for(var ya=pa[q];ma<ya;ma++)pa[ma]*=I}else if(ma=="V"){ma=1;for(ya=pa[q];ma<ya;ma++)pa[ma]*=L}else{ma=1;for(ya=pa[q];ma<ya;ma++)pa[ma]*=ma%2?I:L}}}e=Ia(R);i=v-e.x-e.width/
2;e=x-e.y-e.height/2;R[0][1]+=i;R[0][2]+=e;this.attr({path:R})}if(this.type in{text:1,image:1}&&(u!=1||M!=1))if(this.transformations){this.transformations[2]="scale(".concat(u,",",M,")");this.node.setAttribute("transform",this.transformations[w](aa));i=u==-1?-p.x-($||0):p.x;e=M==-1?-p.y-(ka||0):p.y;this.attr({x:i,y:e});p.fx=u-1;p.fy=M-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(u,", M12=0, M21=0, M22=",M,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
V.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[w](aa));p.fx=0;p.fy=0}else{this.node.filterMatrix="";V.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}p.scale=[a,c,d,f][w](aa);this._.sx=a;this._.sy=c}return this};ia.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Va={},La=function(a,c,d,f,i,e,p,u,v){var x=0,I=100,L=[a,c,d,f,i,e,p,u].join(),M=Va[L],U,ea;!M&&(Va[L]=M={data:[]});M.timer&&clearTimeout(M.timer);M.timer=setTimeout(function(){delete Va[L]},2E3);if(v!=null)I=~~La(a,c,d,f,i,e,p,u)*10;for(var V=0;V<I+1;V++){if(M.data[v]>V)ea=M.data[V*I];else{ea=r.findDotsAtSegment(a,c,d,f,i,e,p,u,V/I);M.data[V]=ea}V&&(x+=s(s(U.x-ea.x,2)+s(U.y-ea.y,2),0.5));if(v!=null&&x>=v)return ea;U=ea}if(v==null)return x};k=function(a,c){return function(d,f,i){d=Ha(d);for(var e,
p,u,v,x="",I={},L=0,M=0,U=d.length;M<U;M++){u=d[M];if(u[0]=="M"){e=+u[1];p=+u[2]}else{v=La(e,p,u[1],u[2],u[3],u[4],u[5],u[6]);if(L+v>f){if(c&&!I.start){e=La(e,p,u[1],u[2],u[3],u[4],u[5],u[6],f-L);x+=["C",e.start.x,e.start.y,e.m.x,e.m.y,e.x,e.y];if(i)return x;I.start=x;x=["M",e.x,e.y+"C",e.n.x,e.n.y,e.end.x,e.end.y,u[5],u[6]][w]();L+=v;e=+u[5];p=+u[6];continue}if(!a&&!c){e=La(e,p,u[1],u[2],u[3],u[4],u[5],u[6],f-L);return{x:e.x,y:e.y,alpha:e.alpha}}}L+=v;e=+u[5];p=+u[6]}x+=u}I.end=x;e=a?L:c?I:r.findDotsAtSegment(e,
p,u[1],u[2],u[3],u[4],u[5],u[6],1);e.alpha&&(e={x:e.x,y:e.y,alpha:e.alpha});return e}};var sb=k(1),Ma=k(),Wa=k(0,1);ia.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return sb(this.attrs.path)}};ia.getPointAtLength=function(a){if(this.type=="path")return Ma(this.attrs.path,a)};ia.getSubpath=function(a,c){if(this.type=="path"){if(j(this.getTotalLength()-c)<"1e-6")return Wa(this.attrs.path,a).end;var d=Wa(this.attrs.path,c,1);return a?Wa(d,
a).end:d}};r.easing_formulas={linear:function(a){return a},"<":function(a){return s(a,3)},">":function(a){return s(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return s(a,3)/2;a-=2;return(s(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return s(2,-10*a)*B.sin((a-0.075)*2*z/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/2.75){a-=
2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var va=[],tb=function(){for(var a=+new Date,c=0;c<va[q];c++){var d=va[c];if(!(d.stop||d.el.removed)){var f=a-d.start,i=d.ms,e=d.easing,p=d.from,u=d.diff,v=d.to,x=d.t,I=d.el;d={};var L;if(f<i){f=e(f/i);for(var M in p)if(p[o](M)){switch(Oa[M]){case "along":L=f*i*u[M];v.back&&(L=v.len-L);e=Ma(v[M],L);I.translate(u.sx-u.x||0,u.sy-u.y||0);u.x=e.x;u.y=e.y;I.translate(e.x-u.sx,e.y-u.sy);v.rot&&I.rotate(u.r+e.alpha,e.x,e.y);
break;case H:L=+p[M]+f*i*u[M];break;case "colour":L="rgb("+[Xa(ca(p[M].r+f*i*u[M].r)),Xa(ca(p[M].g+f*i*u[M].g)),Xa(ca(p[M].b+f*i*u[M].b))][w](",")+")";break;case "path":L=[];e=0;for(var U=p[M][q];e<U;e++){L[e]=[p[M][e][0]];for(var ea=1,V=p[M][e][q];ea<V;ea++)L[e][ea]=+p[M][e][ea]+f*i*u[M][e][ea];L[e]=L[e][w](aa)}L=L[w](aa);break;case "csv":switch(M){case "translation":L=f*i*u[M][0]-x.x;e=f*i*u[M][1]-x.y;x.x+=L;x.y+=e;L=L+aa+e;break;case "rotation":L=+p[M][0]+f*i*u[M][0];p[M][1]&&(L+=","+p[M][1]+","+
p[M][2]);break;case "scale":L=[+p[M][0]+f*i*u[M][0],+p[M][1]+f*i*u[M][1],2 in v[M]?v[M][2]:"",3 in v[M]?v[M][3]:""][w](aa);break;case "clip-rect":L=[];for(e=4;e--;)L[e]=+p[M][e]+f*i*u[M][e]}break;default:U=[].concat(p[M]);L=[];for(e=I.paper.customAttributes[M].length;e--;)L[e]=+U[e]+f*i*u[M][e]}d[M]=L}I.attr(d);I._run&&I._run.call(I)}else{if(v.along){e=Ma(v.along,v.len*!v.back);I.translate(u.sx-(u.x||0)+e.x-u.sx,u.sy-(u.y||0)+e.y-u.sy);v.rot&&I.rotate(u.r+e.alpha,e.x,e.y)}(x.x||x.y)&&I.translate(-x.x,
-x.y);v.scale&&(v.scale+="");I.attr(v);va.splice(c--,1)}}}r.svg&&I&&I.paper&&I.paper.safari();va[q]&&setTimeout(tb)},Ob=function(a,c,d,f,i){var e=d-f;c.timeouts.push(setTimeout(function(){r.is(i,"function")&&i.call(c);c.animate(a,e,a.easing)},f))},Xa=function(a){return F(Q(a,255),0)},Ka=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:A};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Qa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ia.animateWith=function(a,c,d,f,i){for(var e=0,p=va.length;e<p;e++)va[e].el.id==a.id&&(c.start=va[e].start);return this.animate(c,d,f,i)};ia.animateAlong=S();ia.animateAlongBack=S(1);ia.onAnimation=function(a){this._run=a||0;return this};ia.animate=function(a,c,d,f){var i=this;i.timeouts=i.timeouts||[];if(r.is(d,"function")||!d)f=d||null;if(i.removed){f&&f.call(i);
return i}var e={},p={},u=false,v={},x;for(x in a)if(a[o](x))if(Oa[o](x)||i.paper.customAttributes[o](x)){u=true;e[x]=i.attr(x);e[x]==null&&(e[x]=Ea[x]);p[x]=a[x];switch(Oa[x]){case "along":var I=sb(a[x]),L=Ma(a[x],I*!!a.back),M=i.getBBox();v[x]=I/c;v.tx=M.x;v.ty=M.y;v.sx=L.x;v.sy=L.y;p.rot=a.rot;p.back=a.back;p.len=I;a.rot&&(v.r=Y(i.rotate())||0);break;case H:v[x]=(p[x]-e[x])/c;break;case "colour":e[x]=r.getRGB(e[x]);I=r.getRGB(p[x]);v[x]={r:(I.r-e[x].r)/c,g:(I.g-e[x].g)/c,b:(I.b-e[x].b)/c};break;
case "path":I=Ha(e[x],p[x]);e[x]=I[0];M=I[1];v[x]=[];I=0;for(L=e[x][q];I<L;I++){v[x][I]=[0];for(var U=1,ea=e[x][I][q];U<ea;U++)v[x][I][U]=(M[I][U]-e[x][I][U])/c}break;case "csv":L=l(a[x]).split(J);M=l(e[x]).split(J);switch(x){case "translation":e[x]=[0,0];v[x]=[L[0]/c,L[1]/c];break;case "rotation":e[x]=M[1]==L[1]&&M[2]==L[2]?M:[0,L[1],L[2]];v[x]=[(L[0]-e[x][0])/c,0,0];break;case "scale":a[x]=L;e[x]=l(e[x]).split(J);v[x]=[(L[0]-e[x][0])/c,(L[1]-e[x][1])/c,0,0];break;case "clip-rect":e[x]=l(e[x]).split(J);
v[x]=[];for(I=4;I--;)v[x][I]=(L[I]-e[x][I])/c}p[x]=L;break;default:L=[].concat(a[x]);M=[].concat(e[x]);v[x]=[];for(I=i.paper.customAttributes[x][q];I--;)v[x][I]=((L[I]||0)-(M[I]||0))/c}}if(u){x=r.easing_formulas[d];if(!x)if((x=l(d).match(ra))&&x[q]==5){var V=x;x=function(ka){return m(ka,+V[1],+V[2],+V[3],+V[4],c)}}else x=function(ka){return ka};va.push({start:a.start||+new Date,ms:c,easing:x,from:e,diff:v,to:p,el:i,t:{x:0,y:0}});r.is(f,"function")&&(i._ac=setTimeout(function(){f.call(i)},c));va[q]==
1&&setTimeout(tb)}else{d=[];var R,$;for($ in a)if(a[o]($)&&ub.test($)){x={value:a[$]};$=="from"&&($=0);$=="to"&&($=100);x.key=na($,10);d.push(x)}d.sort(Ab);d[0].key&&d.unshift({key:0,value:i.attrs});I=0;for(L=d[q];I<L;I++)Ob(d[I].value,i,c/100*d[I].key,c/100*(d[I-1]&&d[I-1].key||0),d[I-1]&&d[I-1].value.callback);(R=d[d[q]-1].value.callback)&&i.timeouts.push(setTimeout(function(){R.call(i)},c))}return this};ia.stop=function(){for(var a=0;a<va.length;a++)va[a].el.id==this.id&&va.splice(a--,1);a=0;for(ii=
this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ia.translate=function(a,c){return this.attr({translation:a+" "+c})};ia[X]=function(){return"Rapha\u00ebl\u2019s object"};r.ae=va;var sa=function(a){this.items=[];this[q]=0;this.type="set";if(a)for(var c=0,d=a[q];c<d;c++)if(a[c]&&(a[c].constructor==ja||a[c].constructor==sa)){this[this.items[q]]=this.items[this.items[q]]=a[c];this[q]++}};sa[C][ba]=function(){for(var a,
c,d=0,f=arguments[q];d<f;d++)if((a=arguments[d])&&(a.constructor==ja||a.constructor==sa)){c=this.items[q];this[c]=this.items[c]=a;this[q]++}return this};sa[C].pop=function(){delete this[this[q]--];return this.items.pop()};for(var Ya in ia)ia[o](Ya)&&(sa[C][Ya]=function(a){return function(){for(var c=0,d=this.items[q];c<d;c++)this.items[c][a][O](this.items[c],arguments);return this}}(Ya));sa[C].attr=function(a,c){if(a&&r.is(a,P)&&r.is(a[0],"object"))for(var d=0,f=a[q];d<f;d++)this.items[d].attr(a[d]);
else{d=0;for(f=this.items[q];d<f;d++)this.items[d].attr(a,c)}return this};sa[C].animate=function(a,c,d,f){(r.is(d,"function")||!d)&&(f=d||null);var i=this.items[q],e=i,p,u=this,v;f&&(v=function(){!--i&&f.call(u)});d=r.is(d,"string")?d:v;for(p=this.items[--e].animate(a,c,d,v);e--;)this.items[e]&&!this.items[e].removed&&this.items[e].animateWith(p,a,c,d,v);return this};sa[C].insertAfter=function(a){for(var c=this.items[q];c--;)this.items[c].insertAfter(a);return this};sa[C].getBBox=function(){for(var a=
[],c=[],d=[],f=[],i=this.items[q];i--;){var e=this.items[i].getBBox();a[ba](e.x);c[ba](e.y);d[ba](e.x+e.width);f[ba](e.y+e.height)}a=Q[O](0,a);c=Q[O](0,c);return{x:a,y:c,width:F[O](0,d)-a,height:F[O](0,f)-c}};sa[C].clone=function(a){a=new sa;for(var c=0,d=this.items[q];c<d;c++)a[ba](this.items[c].clone());return a};r.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],f;for(f in a.face)a.face[o](f)&&(c.face[f]=a.face[f]);this.fonts[d]?
this.fonts[d][ba](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=na(a.face["units-per-em"],10);for(var i in a.glyphs)if(a.glyphs[o](i)){d=a.glyphs[i];c.glyphs[i]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(p){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[p]||"M"})+"z"};if(d.k)for(var e in d.k)d[o](e)&&(c.glyphs[i].k[e]=d.k[e])}}return a};D.getFont=function(a,c,d,f){f=f||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(r.fonts){var i=r.fonts[a];
if(!i){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var e in r.fonts)if(r.fonts[o](e))if(a.test(e)){i=r.fonts[e];break}}var p;if(i){e=0;for(a=i[q];e<a;e++){p=i[e];if(p.face["font-weight"]==c&&(p.face["font-style"]==d||!p.face["font-style"])&&p.face["font-stretch"]==f)break}}return p}};D.print=function(a,c,d,f,i,e,p){e=e||"middle";p=F(Q(p||0,1),-1);var u=this.set(),v=l(d).split(""),x=0;r.is(f,d)&&(f=this.getFont(f));if(f){d=(i||16)/f.face["units-per-em"];var I=f.face.bbox.split(J);
i=+I[0];e=+I[1]+(e=="baseline"?I[3]-I[1]+ +f.face.descent:(I[3]-I[1])/2);I=0;for(var L=v[q];I<L;I++){var M=I&&f.glyphs[v[I-1]]||{},U=f.glyphs[v[I]];x+=I?(M.w||f.w)+(M.k&&M.k[v[I]]||0)+f.w*p:0;U&&U.d&&u[ba](this.path(U.d).attr({fill:"#000",stroke:"none",translation:[x,0]}))}u.scale(d,d,i,e).translate(a-i,c-e)}return u};r.format=function(a,c){var d=r.is(c,P)?[0].concat(c):arguments;a&&r.is(a,"string")&&d[q]-1&&(a=a.replace(K,function(f,i){return d[++i]==null?"":d[i]}));return a||""};r.ninja=function(){n.was?
h.Raphael=n.is:delete Raphael;return r};r.el=ia;r.st=sa[C];n.was?h.Raphael=r:Raphael=r})();(function(){function r(w){return(w+"").replace(W,"")}function Z(w,q,y){for(var B=w.length;B<q;B++)w=y?"0"+w:w+"0";return w}function N(w){return G.call(w)==="[object Array]"}function A(w,q){if(w.indexOf)return w.indexOf(q);for(var y=0,B=w.length;y<B;y++)if(w[y]===q)return y;return-1}function S(w,q,y){var B=q["-"];q=q["+"];var F;switch(y){case "n -":B=" "+B;q=" "+q;case "n-":if(w.substr(w.length-B.length)===B)F=["-",w.substr(0,w.length-B.length)];else if(w.substr(w.length-q.length)===q)F=["+",w.substr(0,
w.length-q.length)];break;case "- n":B+=" ";q+=" ";case "-n":if(w.indexOf(B)===0)F=["-",w.substr(B.length)];else if(w.indexOf(q)===0)F=["+",w.substr(q.length)];break;case "(n)":if(w.indexOf("(")===0&&w.substr(w.length-1)===")")F=["-",w.substr(1,w.length-2)]}return F||["",w]}function m(w,q){if(!q)return 0;for(var y,B=w.getTime(),F=0,Q=q.length;F<Q;F++){y=q[F].start;if(y===null||B>=y)return F}return 0}function J(w){return w.split("\u00a0").join(" ").toUpperCase()}function T(w){for(var q=[],y=0,B=w.length;y<
B;y++)q[y]=J(w[y]);return q}function K(w,q,y,B){w=w.getFullYear();if(!B&&q.eras)w-=q.eras[y].offset;return w}function C(w,q){for(var y=0,B=false,F=0,Q=w.length;F<Q;F++){var j=w.charAt(F);switch(j){case "'":if(B)q.push("'");else y++;B=false;break;case "\\":B&&q.push("\\");B=!B;break;default:q.push(j);B=false}}return y}function o(w,q){q=q||"F";var y;y=w.patterns;var B=q.length;if(B===1){y=y[q];if(!y)throw"Invalid date format string '"+q+"'.";q=y}else if(B===2&&q.charAt(0)==="%")q=q.charAt(1);return q}
function g(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function h(w,q,y){w=r(w);y=y.calendar;a:{var B=y._parseRegExp;if(B){var F=B[q];if(F){q=F;break a}}else y._parseRegExp=B={};F=o(y,q).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var Q=["^"],j=[],s=0,z=0,H=g(),P;(P=H.exec(F))!==null;){var X=F.slice(s,P.index);s=H.lastIndex;z+=C(X,Q);if(z%2)Q.push(P[0]);else{X=P[0];var ga=X.length;switch(X){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":X=
"(\\D+)";break;case "tt":case "t":X="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":X="(\\d{"+ga+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":X="(\\d\\d?)";break;case "zzz":X="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":X="([+-]?\\d\\d?)";break;case "/":X="(\\"+y["/"]+")";break;default:throw"Invalid date format pattern '"+X+"'.";}X&&Q.push(X);j.push(P[0])}}C(F.slice(s),Q);Q.push("$");F=
{regExp:Q.join("").replace(/\s+/g,"\\s+"),groups:j};q=B[q]=F}z=RegExp(q.regExp).exec(w);if(z===null)return null;H=q.groups;var ba=w=null,fa=null,la=q=null;j=Q=F=B=0;P=null;s=false;X=0;for(ga=H.length;X<ga;X++){var ha=z[X+1];if(ha){var ra=H[X],ca=ra.length,Y=parseInt(ha,10);switch(ra){case "dd":case "d":q=Y;if(q<1||q>31)return null;break;case "MMM":case "MMMM":fa=y;ca=ca===3;ra=fa.months;var na=fa.monthsGenitive||fa.months,wa=fa._upperMonths;Y=fa._upperMonthsGen;if(!wa){fa._upperMonths=wa=[T(ra.names),
T(ra.namesAbbr)];fa._upperMonthsGen=Y=[T(na.names),T(na.namesAbbr)]}ha=J(ha);fa=A(ca?wa[1]:wa[0],ha);if(fa<0)fa=A(ca?Y[1]:Y[0],ha);if(fa<0||fa>11)return null;break;case "M":case "MM":fa=Y-1;if(fa<0||fa>11)return null;break;case "y":case "yy":case "yyyy":if(ca<4){ba=y;ha=Y;Y=new Date;ra=m(Y);if(ha<100){ca=ba.twoDigitYearMax;ca=typeof ca==="string"?(new Date).getFullYear()%100+parseInt(ca,10):ca;ba=K(Y,ba,ra);ha+=ba-ba%100;if(ha>ca)ha-=100}ba=ha}else ba=Y;if(ba<0||ba>9999)return null;break;case "h":case "hh":B=
Y;if(B===12)B=0;if(B<0||B>11)return null;break;case "H":case "HH":B=Y;if(B<0||B>23)return null;break;case "m":case "mm":F=Y;if(F<0||F>59)return null;break;case "s":case "ss":Q=Y;if(Q<0||Q>59)return null;break;case "tt":case "t":s=y.PM&&(ha===y.PM[0]||ha===y.PM[1]||ha===y.PM[2]);if(!s&&(!y.AM||ha!==y.AM[0]&&ha!==y.AM[1]&&ha!==y.AM[2]))return null;break;case "f":case "ff":case "fff":j=Y*Math.pow(10,3-ca);if(j<0||j>999)return null;break;case "ddd":case "dddd":la=ha;ha=ca===3;Y=void 0;Y=y.days;ca=y._upperDays;
if(!ca)y._upperDays=ca=[T(Y.names),T(Y.namesAbbr),T(Y.namesShort)];la=J(la);if(ha){Y=A(ca[1],la);if(Y===-1)Y=A(ca[2],la)}else Y=A(ca[0],la);la=Y;if(la<0||la>6)return null;break;case "zzz":ca=ha.split(/:/);if(ca.length!==2)return null;P=parseInt(ca[0],10);if(P<-12||P>13)return null;ca=parseInt(ca[1],10);if(ca<0||ca>59)return null;P=P*60+(ha.indexOf("-")===0?-ca:ca);break;case "z":case "zz":P=Y;if(P<-12||P>13)return null;P*=60;break;case "g":case "gg":if(!ha||!y.eras)return null;ha=r(ha.toLowerCase());
ca=0;for(Y=y.eras.length;ca<Y;ca++)if(ha===y.eras[ca].name.toLowerCase()){w=ca;break}if(w===null)return null}}}z=new Date;H=(X=y.convert)?X.fromGregorian(z)[0]:z.getFullYear();if(ba===null)ba=H;else if(y.eras)ba+=y.eras[w||0].offset;if(fa===null)fa=0;if(q===null)q=1;if(X){z=X.toGregorian(ba,fa,q);if(z===null)return null}else{z.setFullYear(ba,fa,q);if(z.getDate()!==q)return null;if(la!==null&&z.getDay()!==la)return null}if(s&&B<12)B+=12;z.setHours(B,F,Q,j);if(P!==null){y=z.getMinutes()-(P+z.getTimezoneOffset());
z.setHours(z.getHours()+parseInt(y/60,10),y%60)}return z}function n(w,q,y){function B(ca,Y){var na;na=ca+"";if(Y>1&&na.length<Y){na=X[Y-2]+na;return na.substr(na.length-Y,Y)}return na}function F(){if(ga||ba)return ga;ga=fa.test(q);ba=true;return ga}function Q(ca,Y){if(ra)return ra[Y];switch(Y){case 0:return ca.getFullYear();case 1:return ca.getMonth();case 2:return ca.getDate()}}var j=y.calendar,s=j.convert;if(!q||!q.length||q==="i"){if(y&&y.name.length)if(s)y=n(w,j.patterns.F,y);else{y=new Date(w.getTime());
var z=m(w,j.eras);y.setFullYear(K(w,j,z));y=y.toLocaleString()}else y=w.toString();return y}z=j.eras;var H=q==="s";q=o(j,q);y=[];var P,X=["0","00","000"],ga,ba,fa=/([^d]|^)(d|dd)([^d]|$)/g,la=0,ha=g(),ra;if(!H&&s)ra=s.fromGregorian(w);for(;;){P=ha.lastIndex;s=ha.exec(q);P=q.slice(P,s?s.index:q.length);la+=C(P,y);if(!s)break;if(la%2)y.push(s[0]);else{P=s[0];s=P.length;switch(P){case "ddd":case "dddd":y.push((s===3?j.days.namesAbbr:j.days.names)[w.getDay()]);break;case "d":case "dd":ga=true;y.push(B(Q(w,
2),s));break;case "MMM":case "MMMM":P=Q(w,1);y.push(j.monthsGenitive&&F()?j.monthsGenitive[s===3?"namesAbbr":"names"][P]:j.months[s===3?"namesAbbr":"names"][P]);break;case "M":case "MM":y.push(B(Q(w,1)+1,s));break;case "y":case "yy":case "yyyy":P=ra?ra[0]:K(w,j,m(w,z),H);if(s<4)P%=100;y.push(B(P,s));break;case "h":case "hh":P=w.getHours()%12;if(P===0)P=12;y.push(B(P,s));break;case "H":case "HH":y.push(B(w.getHours(),s));break;case "m":case "mm":y.push(B(w.getMinutes(),s));break;case "s":case "ss":y.push(B(w.getSeconds(),
s));break;case "t":case "tt":P=w.getHours()<12?j.AM?j.AM[0]:" ":j.PM?j.PM[0]:" ";y.push(s===1?P.charAt(0):P);break;case "f":case "ff":case "fff":y.push(B(w.getMilliseconds(),3).substr(0,s));break;case "z":case "zz":P=w.getTimezoneOffset()/60;y.push((P<=0?"+":"-")+B(Math.floor(Math.abs(P)),s));break;case "zzz":P=w.getTimezoneOffset()/60;y.push((P<=0?"+":"-")+B(Math.floor(Math.abs(P)),2)+":"+B(Math.abs(w.getTimezoneOffset()%60),2));break;case "g":case "gg":j.eras&&y.push(j.eras[m(w,z)].name);break;
case "/":y.push(j["/"]);break;default:throw"Invalid date format pattern '"+P+"'.";}}}return y.join("")}var E={},D={en:{}};D["default"]=D.en;E.extend=function(w){for(var q=arguments[1]||{},y=2,B=arguments.length;y<B;y++){var F=arguments[y];if(F)for(var Q in F){var j=F[Q];if(typeof j!=="undefined")if(w&&(G.call(j)==="[object Object]"||N(j))){var s=q[Q];s=s&&(G.call(s)==="[object Object]"||N(s))?s:N(j)?[]:{};q[Q]=this.extend(true,s,j)}else q[Q]=j}}return q};E.findClosestCulture=function(w){var q;if(!w)return this.culture||
this.cultures["default"];if(G.call(w)==="[object String]")w=w.split(",");if(N(w)){var y,B=this.cultures,F=w,Q,j=F.length,s=[];for(Q=0;Q<j;Q++){w=r(F[Q]);w=w.split(";");y=r(w[0]);if(w.length===1)w=1;else{w=r(w[1]);if(w.indexOf("q=")===0){w=w.substr(2);w=parseFloat(w,10);w=isNaN(w)?0:w}else w=1}s.push({lang:y,pri:w})}s.sort(function(H,P){return H.pri<P.pri?1:-1});for(Q=0;Q<j;Q++){y=s[Q].lang;if(q=B[y])return q}for(Q=0;Q<j;Q++){y=s[Q].lang;do{F=y.lastIndexOf("-");if(F===-1)break;y=y.substr(0,F);if(q=
B[y])return q}while(1)}for(Q=0;Q<j;Q++){y=s[Q].lang;for(var z in B){F=B[z];if(F.language==y)return F}}}else if(typeof w==="object")return w;return q||null};E.preferCulture=function(w){this.culture=this.findClosestCulture(w)||this.cultures["default"]};E.localize=function(w,q,y){if(typeof q!=="string")q=this.culture.name||this.culture||"default";q=this.cultures[q]||{name:q};var B=D[q.name];if(arguments.length===3){B||(B=D[q.name]={});B[w]=y}else{if(B)y=B[w];if(typeof y==="undefined"){if(B=D[q.language])y=
B[w];if(typeof y==="undefined")y=D["default"][w]}}return typeof y==="undefined"?null:y};E.format=function(w,q,y){y=this.findClosestCulture(y);if(typeof w==="number"){var B=w;if(!q||q==="i")w=y.name.length?B.toLocaleString():B.toString();else{q=q||"D";y=y.numberFormat;w=Math.abs(B);var F=-1;if(q.length>1)F=parseInt(q.slice(1),10);var Q=q.charAt(0).toUpperCase(),j;switch(Q){case "D":q="n";if(F!==-1)w=Z(""+w,F,true);if(B<0)w=-w;break;case "N":j=y;case "C":j=j||y.currency;case "P":j=j||y.percent;q=B<
0?j.pattern[0]:j.pattern[1]||"n";if(F===-1)F=j.decimals;b:{var s=w*(Q==="P"?100:1);Q=j;j=Q.groupSizes;w=j[0];B=1;var z=Math.pow(10,F),H=Math.round(s*z)/z;isFinite(H)||(H=s);z="";z=(H+"").split(/e/i);H=z.length>1?parseInt(z[1],10):0;s=z[0];z=s.split(".");s=z[0];z=z.length>1?z[1]:"";if(H>0){z=Z(z,H,false);s+=z.slice(0,H);z=z.substr(H)}else if(H<0){H=-H;s=Z(s,H+1);z=s.slice(-H,s.length)+z;s=s.slice(0,-H)}z=F>0?Q["."]+(z.length>F?z.slice(0,F):Z(z,F)):"";F=s.length-1;Q=Q[","];for(H="";F>=0;){if(w===0||
w>F){w=s.slice(0,F+1)+(H.length?Q+H+z:z);break b}H=s.slice(F-w+1,F+1)+(H.length?Q+H:"");F-=w;if(B<j.length){w=j[B];B++}}w=s.slice(0,F+1)+Q+H+z}break;default:throw"Bad number format specifier: "+Q;}j=/n|\$|-|%/g;for(B="";;){F=j.lastIndex;Q=j.exec(q);B+=q.slice(F,Q?Q.index:q.length);if(!Q)break;switch(Q[0]){case "n":B+=w;break;case "$":B+=y.currency.symbol;break;case "-":if(/[1-9]/.test(w))B+=y["-"];break;case "%":B+=y.percent.symbol}}w=B}}else if(w instanceof Date)w=n(w,q,y);return w};E.parseInt=function(w,
q,y){return Math.floor(this.parseFloat(w,q,y))};E.parseFloat=function(w,q,y){if(typeof q==="string"){y=q;q=10}y=this.findClosestCulture(y);var B=NaN,F=y.numberFormat;if(w.indexOf(y.numberFormat.currency.symbol)>-1){w=w.replace(y.numberFormat.currency.symbol,"");w=w.replace(y.numberFormat.currency["."],y.numberFormat["."])}w=r(w);if(aa.test(w))B=parseFloat(w,q);else if(!q&&l.test(w))B=parseInt(w,16);else{y=S(w,F,F.pattern[0]);q=y[0];y=y[1];if(q===""&&F.pattern[0]!=="-n"){y=S(w,F,"-n");q=y[0];y=y[1]}q=
q||"+";var Q;w=y.indexOf("e");if(w<0)w=y.indexOf("E");if(w<0){Q=y;w=null}else{Q=y.substr(0,w);w=y.substr(w+1)}var j=F["."],s=Q.indexOf(j);if(s<0){y=Q;Q=null}else{y=Q.substr(0,s);Q=Q.substr(s+j.length)}j=F[","];y=y.split(j).join("");s=j.replace(/\u00A0/g," ");if(j!==s)y=y.split(s).join("");q+=y;if(Q!==null)q+="."+Q;if(w!==null){F=S(w,F,"-n");q+="e"+(F[0]||"+")+F[1]}if(k.test(q))B=parseFloat(q)}return B};E.parseDate=function(w,q,y){y=this.findClosestCulture(y);var B,F;if(q){if(typeof q==="string")q=
[q];if(q.length){F=0;for(var Q=q.length;F<Q;F++){var j=q[F];if(j)if(B=h(w,j,y))break}}}else{q=y.calendar.patterns;for(F in q)if(B=h(w,q[F],y))break}return B||null};var O=E.cultures=E.cultures||{};O=O["default"]=O.en=E.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)",
"$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},O.en);O.calendar=O.calendar||O.calendars.standard;var W=/^\s+|\s+$/g,aa=/^[+-]?infinity$/i,l=/^0x[a-f0-9]+$/i,k=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,G=Object.prototype.toString;
jQuery.global=E})();(function(r){var Z=r("<b/>");r.subscribe=function(N,A){function S(){return A.apply(this,Array.prototype.slice.call(arguments,1))}S.guid=A.guid=A.guid||(r.guid?r.guid++:r.event.guid++);Z.bind(N,S)};r.unsubscribe=function(){Z.unbind.apply(Z,arguments)};r.publish=function(){Z.trigger.apply(Z,arguments)}})(jQuery);timeglider=window.timeglider||{version:"0.1.0"};timeglider.TG_Date={};
(function(r){function Z(o){var g=parseInt(o,10);return g>9||g<0?String(o):"0"+g}r=timeglider;var N=jQuery,A={},S={},m={},J={},T={},K=/^(\-?\d+)?(\-\d{1,2})?(\-\d{1,2})?(?:T| )?(\d{1,2})?(?::)?(\d{1,2})?(?::)?(\d{1,2})?(\+|\-)?(\d{1,2})?(?::)?(\d{1,2})?/;r.TG_Date=function(o,g,h){var n,E,D=h||0;if(typeof o=="number"){n=h=C.getDateFromSec(o);E=o+D}else{if(o=="today")o=C.getToday();n=h=o}if(K.test(n)){o=C.parse8601(n);if(o.tz_ho)o=C.toFromUTC(o,{hours:o.tz_ho,minutes:o.tz_mi},"to");N.extend(this,o);
this.rd=C.getRataDie(this);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));if(!E){E=Math.abs(this.rd)*86400;o=this.ho*3600;n=(this.mi-1)*60;D=1;if(this.rd<0)D=-1;E=D*(E+o+n)}this.sec=E;this.date_display=g?g.toLowerCase().substr(0,2):"da";this.dateStr=h}else return{error:"invalid date"}};var C=r.TG_Date;C.getTimeUnitSerial=function(o,g){var h=0;switch(g){case "ye":h=o.ye;break;case "mo":h=o.mo_num;break;case "da":h=o.rd;break;case "de":h=Math.floor(o.ye/
10);break;case "ce":h=Math.floor(o.ye/100);break;case "thou":h=Math.floor(o.ye/1E3);break;case "tenthou":h=Math.floor(o.ye/1E4);break;case "hundredthou":h=Math.floor(o.ye/1E5);break;case "mill":h=Math.floor(o.ye/1E6);break;case "tenmill":h=Math.floor(o.ye/1E7);break;case "hundredmill":h=Math.floor(o.ye/1E8);break;case "bill":h=Math.floor(o.ye/1E9)}return h};C.getMonthDays=function(o,g){return C.isLeapYear(g)==true&&o==2?29:C.monthsDayNums[o]};C.twentyFourToTwelve=function(o){var g={};g.ye=o.ye;g.mo=
o.mo;g.da=o.da;g.ho=o.ho;g.mi=o.mi;g.ampm="am";if(o.ho)if(o.ho>=12){g.ampm="pm";g.ho=o.ho>12?o.ho-12:12}else if(o.ho==0){g.ho=12;g.ampm="am"}else g.ho=o.ho;else{g.ho=12;g.mi=0;g.ampm="am"}return g};C.getMonthAdj=function(o,g){var h=C.getDateFromMonthNum(o);switch(h.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:h=Math.floor(g+g/28*3);return{width:h,days:31};case 2:if(C.isLeapYear(h.ye)==true){h=Math.floor(g+g/28);return{width:h,days:29}}else return{width:g,days:28};default:h=Math.floor(g+
g/28*2);return{width:h,days:30}}};C.getDateFromMonthNum=function(o){var g=0;if(o>0){g=o%12;if(g==0)g=12;o=Math.ceil(o/12)}else{g=Math.abs(o)%12;g=12-g+1;if(g==13)g=1;o=-1*Math.ceil(Math.abs(o)/12)}return{ye:o,mo:g}};C.getMonthWidth=function(o,g,h){g=t/28;var n;switch(o){case 1:case 3:case 5:case 7:case 8:case 10:case 12:n=3;break;case 4:case 6:case 9:case 11:n=2;break;case 2:n=C.isLeapYear(yr)==true?1:0}return{width:Math.floor(h+g*n),numDays:28+n}};C.getToday=function(){var o=new Date;return o.getFullYear()+
"-"+(o.getMonth()+1)+"-"+o.getDate()+" "+o.getHours()+":"+o.getMinutes()+":00"};C.getMonthFromRemDays=function(o,g){var h=0;var n=h=0;h=C.isLeapYear(g)?1:0;if(o<=31){n=1;h=o}else if(o>31&&o<=59+h){n=2;h=o-(31+h)}else if(o>59+h&&o<=90+h){n=3;h=o-(59+h)}else if(o>90+h&&o<=120+h){n=4;h=o-(90+h)}else if(o>120+h&&o<=151+h){n=5;h=o-(120+h)}else if(o>151+h&&o<=181+h){n=6;h=o-(151+h)}else if(o>181+h&&o<=212+h){n=7;h=o-(181+h)}else if(o>212+h&&o<=243+h){n=8;h=o-(212+h)}else if(o>243+h&&o<=273+h){n=9;h=o-(243+
h)}else if(o>273+h&&o<=304+h){n=10;h=o-(273+h)}else if(o>304+h&&o<=334+h){n=11;h=o-(304+h)}else{n=12;h=o-(334+h)}return{mo:n,da:h}};C.getDateFromRD=function(o){if(J[o])return J[o];for(var g=Math.floor(o),h=Math.floor(g/146097)*400,n=g-Math.floor(g/146097)*146097,E=1,D=h+1,O=D+400;D<=O;D++)if(n>365){n-=365;if(C.isLeapYear(D))n-=1;E++}else D=O;h+=E;if(n==0)n=1;n=C.getMonthFromRemDays(n,h);E=(o-g)*1440;g=Math.floor(E%60);E=Math.floor(E/60);if(C.isLeapYear(h)&&n.mo==2)n.da+=1;g=h+"-"+n.mo+"-"+n.da+" "+
E+":"+g+":00";return J[o]=g};C.getDateFromSec=function(o){if(T[o])return T[o];var g=C.getDateFromRD(o/86400);return T[o]=g};C.isLeapYear=function(o){return o%400==0?true:o%100==0?false:o%4==0?true:false};C.getRataDie=function(o){function g(aa,l){if(S[aa+"-"+l])return S[aa+"-"+l];for(var k=0,G=aa;G<l;G++)k+=C.isLeapYear(G)?366:365;return S[aa+"-"+l]=k}function h(aa,l){var k;switch(aa){case 1:k=0;break;case 2:k=31;break;case 3:k=59;break;case 4:k=90;break;case 5:k=120;break;case 6:k=151;break;case 7:k=
181;break;case 8:k=212;break;case 9:k=243;break;case 10:k=273;break;case 11:k=304;break;case 12:k=334}if(aa>2)if(C.isLeapYear(l))k+=1;return k}var n=o.ye,E=o.mo;o=o.da;var D=0;if(A[n+"-"+E+"-"+o])return A[n+"-"+E+"-"+o];if(n>=0){if(n==0)n=1;D=Math.floor(n/400)*146097;var O=parseInt(g(n-n%400,n)),W=parseInt(h(E,n));D=D+O+W+o-366}else if(n<0)D=C.getBCRataDie({ye:n,mo:E,da:o});return A[n+"-"+E+"-"+o]=D};C.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];C.monthsDayNums=[0,31,28,31,
30,31,30,31,31,30,31,30,31,29];C.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];C.getBCRataDie=function(o){var g=o.ye,h=o.mo;o=o.da;if(m[g+"-"+h+"-"+o])return m[g+"-"+h+"-"+o];if(h==0)h=1;if(o==0)o=1;var n=Math.abs(g);debug.log("mo for neg date:",h);n=-1*((n-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][h]+(C.monthsDayNums[h]-o+1));return m[g+"-"+h+"-"+o]=n};C.setCulture=function(o){jQuery.global.culture=jQuery.global.cultures[o];C.monthNames=
N.merge([""],jQuery.global.culture.calendar.months.names);C.monthNamesAbbr=N.merge([""],jQuery.global.culture.calendar.months.namesAbbr);C.dayNames=jQuery.global.culture.calendar.days.names;C.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;C.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;C.patterns=jQuery.global.culture.calendar.patterns};C.prototype={format:function(o,g,h){h=h||{hours:0,minutes:0};if(g==true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":o=
"yyyy";break;case "mo":o="MMM yyyy";break;case "da":o="MMM d, yyyy";break;case "ho":o="MMM d, yyyy h:mm tt";break;default:o="f"}if(this.ye>-27E4){g=C.toFromUTC(_.clone(this),h,"from");g=new Date(g.ye,g.mo-1,g.da,g.ho,g.mi,g.se,0);return N.global.format(g,o)}else return this.ye}};C.getTimeOffset=function(o){o=o.replace(/[^-\d:]/gi,"");var g=o.split(":"),h=parseInt(g[0],10);g=parseInt(g[1],10);var n=h+(h<0?-1:1)*(g/60);return{decimal:n,hours:h,minutes:g,seconds:n*3600,string:o}};C.tzOffsetStr=function(o,
g){if(o){if(o.length==19)o+=g;else if(o.length==16)o+=":00"+g;return o}};C.parse8601=function(o){var g,h,n,E,D;D=function(W){return W?parseInt(W.replace("-",""),10):0};var O=o.match(K);o=parseInt(O[1]);if(!o)return{error:"invalid date; no year provided"};g=D(O[2])||1;h=D(O[3])||1;n=D(O[4])||1;E=D(O[5])||0;D=D(O[6])||0;tz_pm=O[7]||"+";tz_ho=parseInt(O[8],10)||0;if(tz_pm=="-")tz_ho*=-1;tz_mi=parseInt(O[9],10)||0;if(tz_pm=="-")tz_mi*=-1;return{ye:o,mo:g,da:h,ho:n,mi:E,se:D,tz_ho:tz_ho,tz_mi:tz_mi}};
C.getLastDayOfMonth=function(o,g){var h=[0,31,28,31,30,31,30,31,31,30,31,30,31],n=0;return n=g==2&&C.isLeapYear(o)==true?29:h[g]};C.getDateTimeStrings=function(o){var g=C.parse8601(o);o=g.ye+"-"+Z(g.mo)+"-"+Z(g.da);var h="pm";if(g.ho>12){g.ho-=12;h="pm"}else{if(g.ho==0)g.ho="12";h="am"}g=parseInt(g.ho,10)+":"+Z(g.mi)+" "+h;return{date:o,time:g}};C.transValidateDateString=function(o){if(!o)return false;var g=o.match(/^(\-?\d+|today|now) ?(bce?)?-?(\d{1,2})?-?(\d{1,2})?/);zb=C.zeroButt;if(g){o=g[1];
var h=g[2]||"",n=g[3]||"07";g=g[4]||"1";debug.log("bc:",h);if(parseInt(o,10)<0||h.substr(0,1)=="b")o=-1*Math.abs(o);return C.validateDate(o,n,g)?o+"-"+zb(n)+"-"+zb(g):false}else return false};C.transValidateTimeString=function(o){if(!o)return"12:00:00";o=o.toLowerCase().match(/^(\d{1,2}|noon):?(\d{1,2})?:?(\d{1,2})? ?(am|pm)?/i);var g="";g=C.zeroButt;if(o[1])if(o[0]=="noon")g="12:00:00";else{var h=parseInt(o[1],10)||12,n=parseInt(o[2],10)||0,E=parseInt(o[3],10)||0;o=o[4]||"am";if(C.validateTime(h,
n,E)==false)return false;if(o=="pm"&&h<12)h+=12;g=g(h)+":"+g(n)+":"+g(E)}else g=false;return g};C.validateTime=function(o,g,h){if(o<0||o>23||g<0||g>59||h<0||h>59)return false;return true};C.validateDate=function(o,g,h){var n=C.getMonthDays(g,o);if(h>n||h<=0)return false;if(g>12||g<0)return false;if(o==0)return false;return true};C.zeroButt=function(o){o=parseInt(o,10);return o>9?String(o):"0"+o};C.toFromUTC=function(o,g,h){var n=0,E=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];n={};if(h=="from"){n.ho=
-1*g.hours;n.mi=-1*g.minutes}else if(h=="to"){n.ho=g.hours;n.mi=g.minutes}else{n.ho=-1*o.tz_ho;n.mi=-1*o.tz_mi}if(n.ho==0&&n.mi==0)return o;h=o.ho+o.mi/60+(-1*n.ho+n.mi*-1/60);if(h<0){n=24+h;if(o.da>1)o.da-=1;else if(o.mo==1){o.ye-=1;o.mo=12;o.da=31}else{o.mo-=1;o.da=C.getLastDayOfMonth(o.ye,o.mo)}}else if(h>24){n=h-24;if(C.isLeapYear(o.ye)&&o.mo==2&&o.da==28)o.da=29;else if(o.da==E[o.mo]){if(o.mo==12){o.ye+=1;o.mo=1}else o.mo+=1;o.da=1}else o.da+=1}else n=h;E=function(D){D=Math.abs(D);var O=Math.floor(D);
return{ho:O,mi:Math.round((D-O)*60)}}(n);o.ho=E.ho;o.mi=E.mi;if(g){o.tz_ho=g.tz_ho;o.tz_mi=g.tz_mi}else{o.tz_ho=0;o.tz_mi=0}return o};C.timezones=[{offset:"-12:00",name:"Int'l Date Line West"},{offset:"-11:00",name:"Bering & Nome"},{offset:"-10:00",name:"Alaska-Hawaii Standard Time"},{offset:"-10:00",name:"U.S. Hawaiian Standard Time"},{offset:"-10:00",name:"U.S. Central Alaska Time"},{offset:"-09:00",name:"U.S. Yukon Standard Time"},{offset:"-08:00",name:"U.S. Pacific Standard Time"},{offset:"-07:00",
name:"U.S. Mountain Standard Time"},{offset:"-07:00",name:"U.S. Pacific Daylight Time"},{offset:"-06:00",name:"U.S. Central Standard Time"},{offset:"-06:00",name:"U.S. Mountain Daylight Time"},{offset:"-05:00",name:"U.S. Eastern Standard Time"},{offset:"-05:00",name:"U.S. Central Daylight Time"},{offset:"-04:00",name:"U.S. Atlantic Standard Time"},{offset:"-04:00",name:"U.S. Eastern Daylight Time"},{offset:"-03:30",name:"Newfoundland Standard Time"},{offset:"-03:00",name:"Brazil Standard Time"},{offset:"-03:00",
name:"Atlantic Daylight Time"},{offset:"-03:00",name:"Greenland Standard Time"},{offset:"-02:00",name:"Azores Time"},{offset:"-01:00",name:"West Africa Time"},{offset:"00:00",name:"Greenwich Mean Time/UTC"},{offset:"00:00",name:"Western European Time"},{offset:"01:00",name:"Central European Time"},{offset:"01:00",name:"Middle European Time"},{offset:"01:00",name:"British Summer Time"},{offset:"01:00",name:"Middle European Winter Time"},{offset:"01:00",name:"Swedish Winter Time"},{offset:"01:00",name:"French Winter Time"},
{offset:"02:00",name:"Eastean EU"},{offset:"02:00",name:"USSR-zone1"},{offset:"02:00",name:"Middle European Summer Time"},{offset:"02:00",name:"French Summer Time"},{offset:"03:00",name:"Baghdad Time"},{offset:"03:00",name:"USSR-zone2"},{offset:"03:30",name:"Iran"},{offset:"04:00",name:"USSR-zone3"},{offset:"05:00",name:"USSR-zone4"},{offset:"05:30",name:"Indian Standard Time"},{offset:"06:00",name:"USSR-zone5"},{offset:"06:30",name:"North Sumatra Time"},{offset:"07:00",name:"USSR-zone6"},{offset:"07:00",
name:"West Australian Standard Time"},{offset:"07:30",name:"Java"},{offset:"08:00",name:"China & Hong Kong"},{offset:"08:00",name:"USSR-zone7"},{offset:"08:00",name:"West Australian Daylight Time"},{offset:"09:00",name:"Japan"},{offset:"09:00",name:"Korea"},{offset:"09:00",name:"USSR-zone8"},{offset:"09:30",name:"South Australian Standard Time"},{offset:"09:30",name:"Central Australian Standard Time"},{offset:"10:00",name:"Guam Standard Time"},{offset:"10:00",name:"USSR-zone9"},{offset:"10:00",name:"East Australian Standard Time"},
{offset:"10:30",name:"Central Australian Daylight Time"},{offset:"10:30",name:"South Australian Daylight Time"},{offset:"11:00",name:"USSR-zone10"},{offset:"11:00",name:"East Australian Daylight Time"},{offset:"12:00",name:"New Zealand Standard Time"},{offset:"12:00",name:"Int'l Date Line East"},{offset:"13:00",name:"New Zealand Daylight Time"}]})(timeglider);(function(r){var Z=r.levelHeight=10,N=jQuery;r.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var A=this;this.addBlock=function(J,T){J.right=J.left+J.width;J.bottom=J.top+J.height;J.tickScope=T;A.blocks.push(J)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(J,T){if(J=="sweep"){A.tree=[];for(var K=0;K<300;K++)A.tree[K]=[];this.vis=[]}this.blocks.sort(S);var C,o="",g="";b_htm=html="";b={};blength=this.blocks.length;for(var h=
title_adj=0;h<blength;h++){b=this.blocks[h];if(b.tickScope==J)if(N.inArray(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div"){b_htm="<div style='left:"+b.left+"px' id='"+b.id+"'"+b.html.substr(4);html+=b_htm}else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;o="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else o="";m(b,0);if(b.y_position>0)b.top=-1*b.y_position;b.fontsize<10?b.opacity=
b.fontsize/10:b.opacity=1;if(b.span==true){K="timeglider-event-spanning";C="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else C=K="";g=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html+=Math.abs(b.top)>T-16?"<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(T-Math.floor(16/3))+"px'>+</div>":"<div class='timeglider-timeline-event "+
K+"' id='"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+g+o+C+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}return html};var S=function(J,T){var K=T.importance,C=J.importance;return K<C?-1:K>C?1:0},m=function(J,T){var K=false,C=A.tree,o=C[T],g=T+1,h=false,n=2;bump_ht=Z;if(o!=undefined){for(n=0;n<o.length;n++){a:{K=o[n];if(!(J.left>K.right||J.right<K.left))if(J.left>=
K.left&&J.left<=K.right||J.right>=K.left&&J.right<=K.right||J.right>=K.right&&J.left<=K.left||J.right<=K.right&&J.left>=K.left)if(J.bottom<=K.bottom&&J.bottom>=K.top||J.top<=K.bottom&&J.top>=K.top||J.top==K.bottom&&J.top==K.top){K=true;break a}K=false}if(K==true){J.top-=bump_ht;J.bottom-=bump_ht;m(J,g);h=true;break}}if(h==false){J.top-=J.fontsize;o.push(J);n=Math.ceil(J.height/Z);o=0;for(o=1;o<=n;o++){g=T+o;C[g].push(J)}}}}}})(timeglider);(function(r){var Z=r.TG_Date,N=jQuery,A={},S;r.TG_EventCollection=Backbone.Collection.extend({model:r.TG_Event});r.TG_Event=Backbone.Model.extend({urlRoot:"/event",defaults:{title:"Untitled"},initialize:function(m){if(m.image){m.image={id:m.id,src:m.image,display_class:m.image_class||"above",width:0,height:0};this.getEventImageSize(m.image)}else m.image="";m.titleWidth=r.getStringWidth(m.title);this.set(m)},validate:function(){},getEventImageSize:function(m){function J(o,g){return function(){return g.apply(o,
arguments)}}var T=this,K=new Image,C=K.src=m.src;K.onerror=J(K,function(){debug.log("error loading image:"+C)});K.onload=J(K,function(){T.get("image").height=this.height;T.get("image").width=this.width})}});r.TG_TimelineCollection=Backbone.Collection.extend({model:r.TG_Timeline});r.TG_Timeline=Backbone.Model.extend({urlRoot:"/timeline",defaults:{initial_zoom:25,focus_date:"today",timezone:"00:00",title:"Untitled",events:[],legend:[]},_chewTimeline:function(m){S=m.mediator;m.timeline_id=m.id;A=S.options;
var J={da:[],mo:[],ye:[],de:[],ce:[],thou:[],tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},T=Z.units;m.startSeconds=[];m.endSeconds=[];m.spans=[];m.hasImagesAbove=false;m.timeOffset=Z.getTimeOffset(m.timezone||"00:00");if(!m.color)m.color="#333333";if(m.events.length>0){for(var K,C,o,g,h=m.events.length,n=0;n<h;n++){C=m.events[n];if(C.map)if(S.main_map){if(timeglider.mapping.ready)C.map.marker_instance=timeglider.mapping.addAddMarkerToMap(C,S.main_map)}else r.googleMapsLoad();
if(C.id)o=C.id;else C.id=o="anon"+this.anonEventId++;K=C.date_display||C.date_limit||"da";C.date_display=K.toLowerCase().substr(0,2);if(m.timeOffset.seconds){C.startdate=Z.tzOffsetStr(C.startdate,m.timeOffset.string);if(C.enddate)C.enddate=Z.tzOffsetStr(C.enddate,m.timeOffset.string)}C.startdateObj=new Z(C.startdate,C.date_display);if(C.enddate&&C.enddate!==C.startdate){C.enddateObj=new Z(C.enddate,C.date_display);C.span=true;m.spans.push({id:C.id,start:C.startdateObj.sec,end:C.enddateObj.sec})}else{C.enddateObj=
C.startdateObj;C.span=false}if(C.image_class=="above")m.hasImagesAbove=true;C.icon=!C.icon||C.icon==="none"?"":A.icon_folder+C.icon;m.startSeconds.push(C.startdateObj.sec);m.endSeconds.push(C.enddateObj.sec);for(var E=T.length,D=0;D<E;D++){K=T[D];g=Z.getTimeUnitSerial(C.startdateObj,K);if(J[K][g]!==undefined)J[K][g].push(o);else J[K][g]=[o]}C=new r.TG_Event(C);S.eventCollection.add(C)}T=timeglider.getLowHigh(N.merge(m.startSeconds,m.endSeconds));m.bounds={first:T.low,last:T.high}}if(m.legend.length>
0){T=m.legend;for(h=0;h<T.length;h++);}m.display="expanded";m.dateHash=J;delete m.events;return m},initialize:function(m){this.set(this._chewTimeline(m));this.bind("change",function(){})}})})(timeglider);(function(r){var Z=r.TG_Date,N="",A="",S={},m=jQuery,J={},T="",K,C,o;r.TG_PlayerView=function(g,h){var n=this;A=h;S=A.options;N="#"+g._id;T=g._id;this._views={PLACE:N,CONTAINER:N+" .timeglider-container",DATE:N+" .timeglider-date-display",TIMELINE_MENU:N+" .timeglider-timeline-menu",TIMELINE_MENU_UL:N+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:N+" .timeglider-list-bt",SLIDER_CONTAINER:N+" .timeglider-slider-container",SLIDER:N+" .timeglider-slider",ZOOM_DISPLAY:N+" .timeglider-zoomlevel-display",
TRUCK:N+" .timeglider-truck",CENTERLINE:N+" .timeglider-centerline",TICKS:N+" .timeglider-ticks",HANDLE:N+" .timeglider-handle",FOOTER:N+" .timeglider-footer",FILTER_BT:N+" .timeglider-filter-bt",FILTER_BOX:N+" .timeglider-filter-box",SETTINGS_BT:N+" .timeglider-settings-bt"};K=this._views.CONTAINER;C=this._views.TICKS;o=this._views.DATE;this.initTimelineVOffset=100;this.tick_height=34;this._templates={};this._templates={test:"testola",event_modal_small:"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><div class='dateline'>{{html dateline}}</div><h4 id='title'>${title}</h4><p>{{html image}}{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>",
event_modal_full:m.template(null,"<div class='tg-modal full_modal' id='ev_${id}_modal'><div class='full_modal_scrim'></div><div class='full_modal_panel'><div class='close-button full_modal_close'>x</div><div class='dateline'>{{html dateline}}</div><table><tr><td><h4>${title}</h4><div class='description'><p>{{html description}}</p></div></td><td><div>{{html image}}</div><div id='insert'></div></td></tr></table><div class='footer'><ul>{{html links}}</ul></div></div>"),filter_modal:m.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),settings_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-settings-modal'><div class='close-button'></div><h3>settings</h3><div class='timeglider-menu-modal-content'><div class='timeglider-settings-timezone'></div></div><div class='timeglider-menu-modal-point-right'></div>"),
legend_modal:m.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-display-none'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};this.timelineModal=r.TG_TimelineView.extend({tagName:"div",model:r.TG_Timeline,className:"tg-modal timeglider-timeline-modal ui-widget-content",events:{"click .close-button-remove":"remove"},
template:"<div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p>",initialize:function(){this.model.bind("change",this.render,this)},render:function(){m(this.el).html(m.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id")+"_timelineModal");return this},remove:function(){m(this.el).fadeOut()}});m(K).delegate(".tg-timeline-envelope .timeline-info","click",function(){var D=m(this).data("timeline_id");n.openTimelineModal(D)}).delegate(".tg-timeline-envelope .expand-collapse",
"click",function(){var D=m(this).data("timeline_id");n.expandCollapseTimeline(D)}).delegate(".tg-timeline-envelope .tg-timeline-legend-bt","click",function(){var D=m(this).data("timeline_id");n.legendModal(D)}).delegate(".close-button-remove","click",function(){var D=m(this).parent().attr("id");m("#"+D).remove()}).delegate(".full_modal_scrim, .full_modal_close","click",function(){m(".full_modal").remove()}).delegate(".timeglider-more-plus","click",function(){A.zoom(-1)}).delegate(".timeglider-legend-close",
"click",function(){var D=m(K+" .timeglider-legend");D.fadeOut(300,function(){D.remove()})}).delegate(".timeglider-legend-all","click",function(){m(K+" .timeglider-legend li").each(function(){m(this).removeClass("tg-legend-icon-selected")});A.setFilters({origin:"legend",icon:"all"})}).css("height",m(N).height());this.basicFontSize=S.basic_fontsize;S.show_footer==false&&m(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=
this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();this.setPanButton(m(".timeglider-pan-right"),-30);this.setPanButton(m(".timeglider-pan-left"),30);m(this._views.TRUCK).bind("dblclick",function(D){A.registerUIEvent({name:"dblclick",event:D,dimensions:n.dimensions})}).bind("mousewheel",function(D,O){var W=Math.ceil(-1*O*3),aa=A.getZoomLevel();A.setZoomLevel(aa+W);return false});m(C).draggable({axis:"x",
drag:function(){A.setTicksOffset(m(this).position().left)},stop:function(){n.resetTicksHandle();n.registerDragging()}}).delegate(K+" .timeglider-timeline-event","click",function(){var D=m(this).attr("id"),O=A.eventCollection.get(D).attributes;if(timeglider.mode!="authoring")if(O.click_callback){D=O.click_callback.split(".");var W=D.length;if(W==1)window[D[0]](O);else if(W==2)window[D[0]][D[1]](O);else if(W==3)window[D[0]][D[1]][D[2]](O)}else n.eventModal(D)}).delegate(".timeglider-timeline-event",
"mouseover",function(){var D=A.eventCollection.get(m(this).attr("id")).attributes;n.eventHover(m(this),D)}).delegate(".timeglider-timeline-event","mouseout",function(){var D=A.eventCollection.get(m(this).attr("id")).attributes;n.eventUnHover(m(this),D)}).delegate(".timeglider-event-collapsed","hover",function(){var D=A.eventCollection.get(m(this).attr("id")).attributes.title;debug.trace("collapsed, title:"+D,"note")});A.options.show_centerline===true?m(this._views.CENTERLINE).css({height:n.dimensions.container.height,
left:n.dimensions.container.centerx}):m(this._views.CENTERLINE).css({display:"none"});m.subscribe("mediator.ticksOffsetChange",function(){n.tickHangies();n.registerTitles();n.registerDragging()});m.subscribe("mediator.focusToEvent",function(){});m.subscribe("mediator.zoomLevelChange",function(){n.tickNum=0;n.leftside=0;var D=A.getZoomLevel();m(n._views.SLIDER).slider("value",n.invSliderVal(D));n.displayZoomLevel(D);n.castTicks("zoomLevelChange")});m.subscribe("mediator.ticksReadySignal",function(){A.ticksReady===
true&&n.freshTimelines()});m.subscribe("mediator.refreshSignal",function(){n.tickNum=0;n.leftside=0;n.castTicks("refreshSignal")});m.subscribe("mediator.ticksArrayChange",function(){});m.subscribe("mediator.focusDateChange",function(){this.displayFocusDate()});m.subscribe("mediator.timelineDataLoaded",function(){m(".timeglider-loading").fadeOut(500);n.buildSettingsMenu();n.buildTimelineMenu()});m.subscribe("mediator.activeTimelinesChange",function(){m(n._views.TIMELINE_MENU_UL+" li").each(function(){var D=
m(this).attr("id");m.inArray(D,A.activeTimelines)!=-1?m(this).addClass("activeTimeline"):m(this).removeClass("activeTimeline")})});m.subscribe("mediator.filterChange",function(){});if(m.support.touch){m("#"+T).addTouch();var E=document.getElementById(T);E.addEventListener("gesturestart",function(D){D.preventDefault();m("#output").append("<br>gesture zoom:"+A.getZoomLevel())},false);E.addEventListener("gestureend",function(D){D.preventDefault();m("#output").append("<br>gesture end:"+A.getZoomLevel())},
false);E.addEventListener("gesturechange",function(D){D.preventDefault();D.preventDefault();if(A.gesturing===false){A.gesturing=true;A.gestureStartZoom=A.getZoomLevel()}A.setZoomLevel(Math.ceil(A.gestureStartZoom/D.scale))},false)}};r.TG_PlayerView.prototype={getWidgetDimensions:function(){var g=m(K),h=g.width(),n=Math.floor(h/2)+1,E=g.height(),D=Math.floor(E/2),O=this.tick_height,W=g.position().left;g=g.offset();var aa=S.show_footer==true?m(this._views.FOOTER).height():0;return{container:{width:h,
height:E,centerx:n,centery:D,left:W,offset:g},tick:{top:E-aa-O},footer:{height:aa}}},scaleToImportance:function(g,h){return g/h},displayZoomLevel:function(){var g=A.getZoomLevel();g>0&&S.display_zoom_level==true&&m(this._views.ZOOM_DISPLAY).text(g)},displayFocusDate:function(){var g=A.getFocusDate();m(o).text(g.format("d MMM yyyy",false))},doSomething:function(){alert("DO SOMETHING, viewer")},setPanButton:function(g,h){var n=this;m(g).live("mousedown",function(){n.intervalMachine("pan",{type:"set",
fn:n.pan,args:[h],intvl:33})}).live("mouseup",function(){n.intervalMachine("pan",{type:"clear",fn:n.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){n.intervalMachine("pan",{type:"clear",fn:n.pan,callback:"resetTicksHandle"})})},intervalMachine:function(g,h){var n=this;if(h.type==="clear"){clearInterval(J[g]);if(h.callback)n[h.callback]()}else J[g]=setInterval(function(){h.fn.apply(n,h.args)},h.intvl)},invSliderVal:function(g){return Math.abs(g-101)},pan:function(g){g=g||20;$t=m(C);
newPos=$t.position().left+g;$t.css({left:newPos});A.setTicksOffset(newPos)},registerTitles:function(){var g,h,n,E,D,O,W,aa,l,k,G,w=m(K).offset().left;m(".timeglider-event-spanning").each(function(){g=m(this).offset().left-w;h=m(this).outerWidth();W=m(".timeglider-event-title",this);n=W.outerWidth()+5;E=W.siblings(".timeglider-event-spanner").outerWidth();E>n&&g<0&&Math.abs(g)<h-n&&W.css({marginLeft:-1*g+5})});m(".tg-timeline-envelope").each(function(){aa=m(this).offset().left-w;l=m(".titleBar",this);
k=m(".titleBar .timeline-title",this);D=l.position().left;G=D+aa;l.outerWidth();n=l.outerWidth();O=-1*G;G<0&&k.css({marginLeft:O+5})})},registerDragging:function(){var g=A.startSec,h=m(C).position().left,n=A.getZoomInfo().spp;g=new Z(g-h*n);A.setFocusDate(g);this.displayFocusDate()},setupFilter:function(){var g=this;$filter=m.tmpl(g._templates.filter_modal,{}).appendTo(g._views.CONTAINER);$filter.css("z-index",g.ztop++).position({my:"right bottom",at:"right top",of:m(g._views.FILTER_BT),offset:"-8, -12"}).hide();
m(K).delegate(".timeglider-filter-box .close-button","click",function(){$filter.fadeOut()});m(g._views.FILTER_BT).click(function(){$filter.fadeIn();m(this);var h=g._views.FILTER_BOX;if(g.filterBoxActivated==false){g.filterBoxActivated=true;var n=m(h+" .timeglider-filter-apply"),E=m(".timeglider-filter-box .close-button"),D=m(h+" .timeglider-filter-clear"),O="",W="";n.click(function(){O=m(h+" .timeglider-filter-include").val();W=m(h+" .timeglider-filter-exclude").val();A.setFilters({origin:"clude",
include:O,exclude:W});m(h).toggleClass("timeglider-display-block")});E.click(function(){m(h).toggleClass("timeglider-display-none")});D.click(function(){A.setFilters({origin:"clude",include:"",exclude:""});m(h+" .timeglider-filter-include").val("");m(h+" .timeglider-filter-exclude").val("");m(h).toggleClass("timeglider-display-block")})}})},buildTimelineMenu:function(){var g=this,h;m(g._views.TIMELINE_LIST_BT);m(g._views.TIMELINE_MENU)[0]&&m(g._views.TIMELINE_MENU).remove();h=m.tmpl(g._templates.timeline_list_modal,
{}).appendTo(g._views.CONTAINER);var n=Backbone.View.extend({initialize:function(){this.model.bind("change",this.render,this)},tagName:"li",className:"timeglider-timeline-list-item",template:"<a href='#'>${title}</a>...",events:{click:"toggleTimeline"},toggleTimeline:function(){A.toggleTimeline(this.model.get("id"))},render:function(){m(this.el).html(m.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id")+"_listItem");return this}});m(g._views.TIMELINE_MENU_UL).html("");_.each(A.timelineCollection.models,
function(E){m(g._views.TIMELINE_MENU_UL).append((new n({model:E})).render().el)});h.position({my:"right bottom",at:"right top",of:m(g._views.TIMELINE_LIST_BT),offset:"-8, -12"}).hide();m(K).delegate(".timeglider-timeline-menu .close-button","click",function(){h.fadeOut()}).delegate(this._views.TIMELINE_LIST_BT,"click",function(){h.fadeIn()})},getTimezonePulldown:function(g,h){var n="<select name='timezone' id='"+g+"'>",E=false,D="selected";m.map(Z.timezones,function(O){if(h==O.offset&&E==false){D=
"selected";E=true}else D="";n+="<option value='"+O.offset+"' "+D+">"+O.name+"</option>"});n+="</select>";return n},buildSettingsMenu:function(){var g=m.tmpl(this._templates.settings_modal,{}).appendTo(this._views.CONTAINER),h=this.getTimezonePulldown("timeglider-settings-timezone",A.timeOffset.string);g.find(".timeglider-settings-timezone").append('<p>Make changes below, then click on "save". More settings options to come!</p>').append('<span class="settings-label">timezone:</span> '+h).append("<p style='clear:both'>&nbsp;</p><div class='btn success' id='timeglider-settings-save'>save</div>");
g.position({my:"right bottom",at:"right top",of:m(this._views.SETTINGS_BT),offset:"-8, -12"}).hide();m(K).delegate(".timeglider-settings-modal .close-button","click",function(){g.fadeOut()}).delegate(this._views.SETTINGS_BT,"click",function(){g.fadeIn()}).delegate("#timeglider-settings-save","click",function(){var n=m(K+" #timeglider-settings-timezone").val();A.setTimeoffset(n)})},buildSlider:function(){var g=A.getZoomLevel();if(S.min_zoom==S.max_zoom)m(this._views.SLIDER_CONTAINER).css("display",
"none");else{S.display_zoom_level==true&&m("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var h=this;g=h.invSliderVal(g);var n=A.max_zoom,E=A.min_zoom;m(this._views.SLIDER).css("height",(1+n-E)*3).slider({steps:100,handle:m(".knob"),animate:300,orientation:"vertical",min:h.invSliderVal(n),max:h.invSliderVal(E),value:g,start:function(){h.sliderActive=true},stop:function(){h.sliderActive=false},change:function(){},slide:function(D,O){A.setZoomLevel(h.invSliderVal(O.value))}})}},
getEventDateLine:function(g){var h="<span class='timeglider-dateline-startdate'>"+g.startdateObj.format("",true,A.timeOffset)+"</span>";endDateF="";if(g.span==true)endDateF=" &ndash; <span class='timeglider-dateline-enddate'>"+g.enddateObj.format("",true,A.timeOffset)+"</span>";return h+endDateF},eventHover:function(g,h){var n=m(".timeglider-event-hover-info");h.date_display!="no"&&n.position({my:"left bottom",at:"left top",of:g,offset:"1, -10",collision:"flip flip"}).html(this.getEventDateLine(h));
g.addClass("tg-event-hovered")},eventUnHover:function(g){m(".timeglider-event-hover-info").css("left","-1000px");g.removeClass("tg-event-hovered")},clearTicks:function(){this.tickNum=this.leftside=0;m(C).css("left",0);m(K+" .tg-timeline-envelope").remove();m(K+" .timeglider-tick").remove()},castTicks:function(){this.clearTicks();A.getZoomLevel();var g=A.getFocusDate(),h=A.getZoomInfo().width;h=Math.ceil(this.dimensions.container.width/h)+4;var n="l";A.setTicksReady(false);this.addTick({type:"init",
focus_date:g});for(g=1;g<=h;g+=1){this.addTick({type:n});n=n=="l"?"r":"l"}A.setTicksReady(true);this.displayFocusDate()},addTick:function(g){var h=0,n=0,E=n=0,D=0,O=0,W="";D={};O={};E={};var aa={};O={};aa="";var l=0,k=1;W="";tickUnit=A.getZoomInfo().unit;tickWidth=A.getZoomInfo().width;focusDate=A.getFocusDate();tick_top=parseInt(this.dimensions.tick.top);D=A.addToTicksArray({type:g.type,unit:tickUnit},focusDate);if(tickUnit=="mo"){O=Z.getMonthAdj(D,tickWidth);tickWidth=O.width;h=O.days}this.tickNum++;
if(g.type=="init"){O=this.tickOffsetFromDate(A.getZoomInfo(),A.getFocusDate(),tickWidth);this.leftside=n=Math.ceil(this.dimensions.container.centerx+O);this.rightside=n+tickWidth}else if(g.type=="l")this.leftside=n=Math.floor(this.leftside-tickWidth);else if(g.type=="r"){n=Math.floor(this.rightside);this.rightside+=tickWidth}A.getTickBySerial(D).width=tickWidth;A.getTickBySerial(D).left=n;W=this._views.PLACE+"_"+tickUnit+"_"+D+"-"+this.tickNum;O=m("<div class='timeglider-tick' id='"+W+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(C);
O.css({width:tickWidth,left:n,top:tick_top});E=this.getTickMarksInfo({unit:tickUnit,width:tickWidth});E=h||E.tperu;n=tickWidth/E;if(n>5){g=Raphael(W,tickWidth,30);var G="";for(h=0;h<E;h++){W=h*n;G+="M"+W+" 20 L"+W+" 30";if(tickUnit=="da"&&n>16){W=this.getHourLabelFromHour(l,n);aa+="<div class='timeglider-tick-sub-label' style='width:"+(n-4)+"px'>"+W+"</div>";l++}if(tickUnit=="mo"&&n>16){aa+="<div class='timeglider-tick-sub-label' style='width:"+(n-4)+"px'>"+k+"</div>";k++}}g.path(G).attr({stroke:"#333",
"stroke-width":1})}aa&&O.append("<div style='width:"+(tickWidth+10)+"px;position:absolute;top:17px;left:0;overflow:hidden'>"+aa+"</div>");aa={unit:tickUnit,width:tickWidth,serial:D};D=this.getDateLabelForTick(aa);O.children("#label").text(D);return aa},getHourLabelFromHour:function(g,h){var n="";n=n="";n=g>12?g-12:g;if(n==0)n=12;return n+(h>60?":00":"")+(g>11?" pm":" am")},getTickMarksInfo:function(g){switch(g.unit){case "da":g=24;break;case "mo":g=30;break;case "ye":g=12;break;default:g=10}return{tperu:g}},
getDateLabelForTick:function(g){var h=g.serial,n=g.width;switch(g.unit){case "bill":return h==0?"1":h>0?h+" billion":h+" b.y. bce";case "hundredmill":return h==0?"1":h>0?h+"00 million":h+"00 m.y. bce";case "tenmill":return h==0?"1":h>0?h+"0 million":h+"0 m.y. bce";case "mill":return h==0?"1":h>0?h+" million":h+" m.y. bce";case "hundredthou":return h==0?"1":h>0?h+"00,000":h+"00,000 bce";case "tenthou":return h==0?"1":h>0?h+"0,000":h+"0,000 bce";case "thou":return h==0?"1("+h+")":h>0?h+"000":h+"000 bce";
case "ce":return h==0?"1("+h+")":h>0?h+"00":h+"00 bce";case "de":return h>120?h*10+"s":h*10;case "ye":return h;case "mo":g=Z.getDateFromMonthNum(h);return n<120?Z.monthNamesAbbr[g.mo]+" "+g.ye:Z.monthNames[g.mo]+", "+g.ye;case "da":g=new Z(Z.getDateFromRD(h));return n<120?Z.monthNamesAbbr[g.mo]+" "+g.da+", "+g.ye:Z.monthNames[g.mo]+" "+g.da+", "+g.ye;default:return g.unit+":"+h+":"+n}},tickHangies:function(){var g=m(C).position().left,h=this.rightside+g-this.dimensions.container.width;if(this.leftside+
g>-100){g=this.addTick({type:"l"});this.appendTimelines(g)}else if(h<100){g=this.addTick({type:"r"});this.appendTimelines(g)}},tickOffsetFromDate:function(g,h,n){switch(g.unit){case "da":h=h.ho/24+h.mi/1440;n*=h;break;case "mo":g=Z.getMonthDays(h.mo,h.ye);h=(h.da-1)/g+h.ho/(24*g)+h.mi/(1440*g);n*=h;break;case "ye":h=((h.mo-1)*30+h.da)/365;n*=h;break;case "de":h=h.ye%10/10+h.mo/120;n*=h;break;case "ce":h=h.ye%100/100+h.mo/1200;n*=h;break;case "thou":h=h.ye%1E3/1E3;n*=h;break;case "tenthou":h=h.ye%
1E4/1E4;n*=h;break;case "hundredthou":h=h.ye%1E5/1E5;n*=h;break;default:n=0}return-1*n},resetTicksHandle:function(){m(this._views.HANDLE).offset({left:m(K).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(g){var h=g.tick.unit,n=g.tick.serial;g=g.timeline.dateHash;return g[h][n]&&g[h][n].length>0?g[h][n]:0},setTimelineProp:function(g,h,n){A.timelineCollection.get(g).attributes[h]=n},getTimelineProp:function(g,
h){return A.timelineCollection.get(g).attributes[h]},passesFilters:function(g,h){var n=true,E="",D=[],O;E="";D=[];if(h<g.low_threshold||h>g.high_threshold)return false;if(E=A.filters.include){D=E.split(",");n=false;for(O=0;O<D.length;O++){E=RegExp(m.trim(D[O]),"i");if(g.title.match(E))n=true}}if(E=A.filters.exclude){D=E.split(",");for(O=0;O<D.length;O++){E=RegExp(m.trim(D[O]),"i");if(g.title.match(E))n=false}}E=g.icon;if(A.filters.legend.length>0)if(m.inArray(E,A.filters.legend)==-1)n=false;return n},
freshTimelines:function(){var g=this,h,n,E,D=A.activeTimelines,O=A.ticksArray,W="",aa;n="";var l=g.dimensions.container.centerx,k=g.dimensions.container.width,G=A.getFocusDate().sec,w=A.getZoomInfo().spp;A.getZoomInfo();n=[];var q=[];k=G-Math.floor(w*(k/2));E=0;for(var y,B=0,F=g.dimensions.container.height,Q=B=0;Q<D.length;Q++){n=A.timelineCollection.get(D[Q]);h=n.attributes;y=h.display;B=h.top?parseInt(h.top.replace("px","")):F-g.initTimelineVOffset;n=new r.TG_TimelineView({model:n});E=A.timeOffset.seconds/
w;$tl=m(n.render().el).appendTo(C);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){g.setTimelineProp(h.id,"top",m(this).css("top"));A.refresh()}}).css({top:B,left:E});aa=$tl.children(".titleBar");n=l+(h.bounds.first-G)/w;E=l+(h.bounds.last-G)/w;aa.css({top:void 0,left:n,width:E-n});if(y=="expanded")h.borg=W=new timeglider.TG_Org;for(E=0;E<O.length;E++){n=this.getTimelineEventsByTick({tick:O[E],timeline:h});m.merge(q,n)}for(E=0;E<h.spans.length;E++){n=h.spans[E];n.start<k&&n.end>k&&m.inArray(n.id,
q)==-1&&q.unshift(n.id)}n=this.compileTickEventsAsHtml(h,q,0,"sweep");B=h.hasImagesAbove?B-56:B;if(y=="expanded"){n=W.getHTML("sweep",B);h.borg=W.getBorg()}n!="undefined"&&$tl.append(n);this.registerEventImages($tl)}g.registerTitles()},appendTimelines:function(g){for(var h=A.activeTimelines,n,E="",D=0;D<h.length;D++){n=A.timelineCollection.get(h[D]).attributes;idArr=this.getTimelineEventsByTick({tick:g,timeline:n});E=this.compileTickEventsAsHtml(n,idArr,g.serial,"append");if(n.display=="expanded")E=
n.borg.getHTML(g.serial,n.top);n=m(K+" .tg-timeline-envelope#"+n.id).append(E);this.registerEventImages(n)}},compileTickEventsAsHtml:function(g,h,n,E){var D;D=0;var O=this.dimensions.container.centerx,W=g.display,aa=$tl.height();stuff="";foSec=A.startSec;spp=A.getZoomInfo().spp;zl=A.getZoomInfo().level;buffer=20;borg=g.borg;block_arg="sweep";if(E=="append")block_arg=n;for(n=0;n<h.length;n++){ev=A.eventCollection.get(h[n]).attributes;if(this.passesFilters(ev,zl)===true){D=O+(ev.startdateObj.sec-foSec)/
spp;if(W=="expanded"){impq=g.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=D;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}D=0;if(ev.image&&ev.image.display_class==="layout"){D=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+D;ev.top=aa-ev.height;borg.addBlock(ev,
block_arg)}else if(W=="collapsed")stuff+="<div id='"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(aa-2)+"px;left:"+D+"px'></div>"}}return W=="collapsed"?stuff:""},registerEventImages:function(g){m(K+" .timeglider-event-image-bar").each(function(){m(this).position({my:"top",at:"bottom",of:g,offset:"0, 0"}).css("left",0)});m(K+" .timeglider-event-image-above").each(function(){m(this).position({my:"top",at:"top",of:m(K),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(g){g=
A.timelineCollection.get(g).attributes;g.display=g.display=="expanded"?"collapsed":"expanded";A.refresh()},openTimelineModal:function(g){g=new this.timelineModal({model:A.timelineCollection.get(g)});m(g.render().el).appendTo("body").position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).css("z-index",this.ztop++).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(g){if(!g)return"";var h="",n=0,E="",D="";if(typeof g=="string")h="<li><a href='"+
g+"' target='_blank'>link</a></li>";else if(typeof g=="object")for(n=0;n<g.length;n++){E=g[n].url;D=g[n].label;h+="<li><a href='"+E+"' target='_blank'>"+D+"</a></li>"}return h},eventModal:function(g){m(K+" #"+g+"_modal").remove();var h=this,n=false,E=false,D="";D={};D=0;var O=S.event_modal.type;D=m("#"+g);var W=A.eventCollection.get(g).attributes,aa=W.image&&W.image.src?"<img src='"+W.image.src+"'>":"",l=this.createEventLinksMenu(W.link);g={title:W.title,description:W.description,id:g,dateline:h.getEventDateLine(W),
links:l,image:aa,video:W.video};if(W.video){g.video=W.video;O="full";E=true}else if(W.map)if(W.map.latlong){n=true;O="full"}switch(O){case "full":g=m.tmpl(h._templates.event_modal_full,g);g.appendTo(K).css({"z-index":h.ztop++}).position({my:"left top",at:"left top",of:K,offset:"0, 0",collision:"none none"});if(n==true){g.find("#insert").append("<div id='map_modal_map'></div>");D=W.map.zoom||12;llarr=String(W.map.latlong).split(",");map_ll=new google.maps.LatLng(parseFloat(llarr[0]),parseFloat(llarr[1]));
D={zoom:D,center:map_ll,mapTypeId:google.maps.MapTypeId.ROADMAP};D=new google.maps.Map(m("#map_modal_map")[0],D);if(W.map.markers)for(n=0;n<W.map.markers.length;n++){E=W.map.markers[n];new google.maps.MarkerImage(E.image,new google.maps.Size(24,32),new google.maps.Point(0,0),new google.maps.Point(0,32));g=E.latlong.split(",");g=new google.maps.LatLng(g[0],g[1]);E=new google.maps.Marker({position:g,map:D,icon:E.icon,title:E.title,zIndex:E.zIndex})}}else E==true&&g.find("#insert").append("<iframe width='100%' height='300' src='"+
W.video+"'></iframe></div>");W=h.dimensions.container.height;n=h.dimensions.container.width;E=m(K+" .full_modal_panel");g=E.width();D=E.height();E.css({top:(W-D)/2+"px",left:(n-g)/2+"px"});break;case "video":g=m.tmpl(h._templates.event_modal_video,g);g.appendTo(C).css("z-index",h.ztop++).position({my:"right center",at:"left center",of:D,offset:"-12, -1",collision:"flip fit"}).hover(function(){m(this).css("z-index",h.ztop++)});break;default:g=m.tmpl(h._templates.event_modal_small,g);g.appendTo(C).css("z-index",
h.ztop++).position({my:"right center",at:"left center",of:D,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){m(this).css("z-index",h.ztop++)})}},legendModal:function(g){var h=A.timelineCollection.get(g).attributes.legend,n,E,D,O="";for(n=0;n<h.length;n++){E=S.icon_folder+h[n].icon;D=h[n].title;O+="<li><img src='"+E+"'>"+D+"</li>"}g={id:g,legend_list:O};m(K+" .timeglider-legend").remove();m.tmpl(this._templates.legend_modal,g).appendTo(K).css("z-index",this.ztop++).toggleClass("timeglider-display-none").position({my:"left top",
at:"left top",of:K,offset:"16, -4",collision:"none none"});m(K+" .timeglider-legend li").click(function(){m(this).parent().attr("id");var W=m(this).children("img").attr("src");m(this).toggleClass("tg-legend-icon-selected");A.setFilters({origin:"legend",icon:W})})},parseHTMLTable:function(g){var h={},n=+new Date,E=[];m("#"+g).find("tr").each(function(D){var O=m(this).children(),W;if(D===0)E=O.map(function(){return m(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{W={};O.each(function(aa){W[E[aa]]=
m(this).text()});h["prefix"+n++]=W}});return h}};r.TG_TimelineView=Backbone.View.extend({initialize:function(){var g=this;this.model.bind("change:title",function(){m(g.el).find(".timeline-title-span").text(g.model.get("title"))});this.model.bind("destroy",this.remove,this)},tagName:"div",template:"",events:{"click .timeline-title-span":"titleClick"},className:"tg-timeline-envelope",template:"<div class='titleBar'><div class='timeline-title'><span class='timeline-title-span'>${title}</span><div class='tg-timeline-env-buttons'><span class='timeline-info' data-timeline_id='${id}'>info</span><span class='tg-timeline-legend-bt' data-timeline_id='${id}'>legend</span></div></div></div></div>",
render:function(){this.model.get("id");this.model.get("title");m(this.el).html(m.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id"));return this},setText:function(){},titleClick:function(){alert("TITLE CLICK")},remove:function(){m(this.el).remove()}});r.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,
level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",
width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},
{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,
label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",
width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,
label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,
label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,
level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},
{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},
{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,label:"100 billion years"}];r.calculateSecPerPx=function(g){for(var h=1;h<g.length;h++){var n=g[h],E=0;switch(n.unit){case "da":E=
86400;break;case "mo":E=2419200;break;case "ye":E=31536E3;break;case "de":E=31536E4;break;case "ce":E=31536E5;break;case "thou":E=31536E6;break;case "tenthou":E=31536E7;break;case "hundredthou":E=31536E8;break;case "mill":E=31536E9;break;case "tenmill":E=31536E10;break;case "hundredmill":E=31536E11;break;case "bill":E=31536E12}n.spp=E/parseInt(n.width)}}(r.zoomTree);r.getStringWidth=function(g){if(g)return m("#timeglider-measure-span").html(g).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n",
"g"),"")};if(debug)debug.trace=function(g,h){m("#"+h).text(g)};r.googleMapsInit=function(){debug.log("initializing google maps...")};r.googleMapsLoaded=false;r.googleMapsLoad=function(){if(r.googleMapsLoaded==false){var g=document.createElement("script");g.type="text/javascript";g.src="http://maps.googleapis.com/maps/api/js?sensor=false&callback=timeglider.googleMapsInit";document.body.appendChild(g);r.googleMapsLoaded=true}}})(timeglider);(function(r){var Z={},N=r.TG_Date,A={},S=jQuery;r.TG_Mediator=function(m){this.options=A=m;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=A.max_zoom;this.min_zoom=A.min_zoom;this.timeOffset=N.getTimeOffset(A.timezone);this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",exclude:"",legend:[]};this.timelineCollection=
new r.TG_TimelineCollection;this.eventCollection=new r.TG_EventCollection;this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.initial_timeline_id=A.initial_timeline_id||"";this.focusedEvent=this.sole_timeline_id="";if(A.max_zoom===A.min_zoom)this.fixed_zoom=A.min_zoom;if(A.main_map){this.main_map=A.main_map;timeglider.mapping.setMap(this.main_map,this)}Z=this};r.TG_Mediator.prototype={focusToEvent:function(m){this.focusedEvent=m;this.setFocusDate(m.startdateObj);S.publish("mediator.focusToEvent")},
gotoDateZoom:function(m,J){var T=false;this.setFocusDate(new N(m));if(J)T=this.setZoomLevel(J);if(!J||T==false)this.refresh()},zoom:function(m){this.setZoomLevel(this.getZoomLevel()+parseInt(m))},loadTimelineData:function(m){var J=this;if(m)if(typeof m==="object")J.parseData(m);else if(m.substr(0,1)=="#"){m=[J.getTableTimelineData(m)];J.parseData(m)}else S.getJSON(m,function(T){J.parseData(T)});else{this.timelineDataLoaded=true;this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},
mapMarkerClick:function(m){this.focusToEvent(m)},getTimelineCollection:function(){return this.timelineCollection},getTableTimelineData:function(m){var J={},T=0,K=[],C,o,g="",h=S(m);J.id=m.substr(1);J.title=h.attr("title")||"untitled";J.description=h.attr("description")||"";J.focus_date=h.attr("focus_date")||N.getToday;J.initial_zoom=h.attr("initial_zoom")||20;J.events=[];h.find("tr").each(function(n){var E=S(this).children(),D;if(n===0)K=E.map(function(){return S(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,
"$1")}).get();else{D={};E.each(function(O){C=K[O];o=S(this).text();D[C]=o});g="ev_"+T++;D.id=g;J.events.push(D)}});h.css("display","none");return J},parseData:function(m){var J=0,T=m.length,K={};K={};for(var C=0;C<T;C++){K=m[C];K.mediator=this;K=(new r.TG_Timeline(K)).toJSON();if(K.id.length>0){J++;this.swallowTimeline(K)}}if(J===0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var m=this.timelineDataLoaded==true;if(this.imagesSized==
this.imagesToSize&&m){this.setInitialTimelines();S.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(m){this.sole_timeline_id=m.id;this.timelineCollection.add(m);S.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var m=this.initial_timeline_id||this.sole_timeline_id;if(timeglider.mode=="authoring")this.setZoomLevel(40);else m?setTimeout(function(){Z.toggleTimeline(m)},1E3):this.setZoomLevel(40)},refresh:function(){this.startSec=this._focusDate.sec;S.publish("mediator.refreshSignal")},
setTicksReady:function(m){this.ticksReady=m;m===true&&S.publish("mediator.ticksReadySignal")},setTimeoffset:function(m){this.timeOffset=N.getTimeOffset(m);this.refresh()},getTimeoffset:function(){return this.timeOffset},setFocusDate:function(m){if(m!=this._focusDate)this._focusDate=m},getFocusDate:function(){return this._focusDate},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(m){if(m<=this.max_zoom&&m>=this.min_zoom){this.startSec=this._focusDate.sec;if(m!=this._zoomLevel){this._zoomLevel=
m;this._zoomInfo=r.zoomTree[m];S.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},registerUIEvent:function(m){switch(m.name){case "dblclick":m=m.event.pageX-m.dimensions.container.offset.left-m.dimensions.container.width/2;var J=this.getZoomInfo().spp,T=this.getFocusDate().sec;m=new N(Math.floor(T+m*J));S.publish("mediator.dblclick",{date:m})}},setFilters:function(m){switch(m.origin){case "clude":this.filters.include=
m.include;this.filters.exclude=m.exclude;break;case "legend":var J=m.icon;if(J=="all"){this.filters.legend=[];S.publish("mediator.legendAll")}else if(S.inArray(J,this.filters.legend)==-1)this.filters.legend.push(J);else{m=[];m=S.grep(this.filters.legend,function(T){return T!=J});this.filters.legend=m}}S.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(m){this._ticksOffset=m;S.publish("mediator.ticksOffsetChange")},getTickBySerial:function(m){for(var J=
this.ticksArray,T=J.length,K=0;K<T;K++){var C=J[K];if(C.serial==m)return C}return false},addToTicksArray:function(m,J){if(m.type=="init"){m.serial=N.getTimeUnitSerial(J,m.unit);this.ticksArray=[m]}else if(m.type=="l"){m.serial=this.ticksArray[0].serial-1;this.ticksArray.unshift(m)}else{m.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(m)}S.publish("mediator.ticksArrayChange");return m.serial},toggleTimeline:function(m){this.activeTimelines=[];var J=this.timelineCollection.get(m).attributes,
T=S.inArray(m,this.activeTimelines);if(T==-1){this.activeTimelines.push(m);this.setFocusDate(new N(J.focus_date));this.setZoomLevel(J.initial_zoom)}else this.activeTimelines.splice(T,1);this.refresh();S.publish("mediator.activeTimelinesChange")},reportImageSize:function(m){var J=Z.eventCollection.get(m.id);if(J.has("image")){if(m.error){J.attributes.image={};debug.log("WHOOPS: MISSING IMAGE: "+m.src)}else{J.attributes.image.width=m.width;J.attributes.image.height=m.height}this.imagesSized++;this.imagesSized==
this.imagesToSize&&this.tryLoading()}}};r.getLowHigh=function(m){var J,T,K=parseFloat(m[0]),C=K;for(J=0;J<m.length;J++){T=parseFloat(m[J]);if(T<C)C=T;if(T>K)K=T}return{high:K,low:C}};r.validateOptions=function(m){this.optionsMaster={initial_focus:{type:"date"},timezone:{type:"timezone"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},
display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};var J=this,T="";S.each(m,function(K,C){if(J.optionsMaster[K])switch(J.optionsMaster[K].type){case "string":if(typeof C!="string")T+=K+" needs to be a string.\n";if(J.optionsMaster[K].possible)if(S.inArray(C,
J.optionsMaster[K].possible)==-1)T+=K+" must be: "+J.optionsMaster[K].possible.join(" or ");break;case "number":if(typeof C!="number")T+=C+" needs to be a number.\n";if(J.optionsMaster[K].min)if(C<J.optionsMaster[K].min)T+=K+" must be greater than or equal to "+J.optionsMaster[K].min+"\n";if(J.optionsMaster[K].max)if(C>J.optionsMaster[K].max)T+=K+" must be less than or equal to "+J.optionsMaster[K].max+"\n";break;case "timezone":var o=/[+|-]?[0-9]+:[0-9]+/;if(S.inArray(C,["New York","Denver","Chicago",
"Los Angeles"])==-1&&C.match(o)==-1)T+="The timezone is not formatted properly";break;case "boolean":if(typeof C!="boolean")T+=C+" needs to be a number.\n"}});return T}})(timeglider);(function(r){var Z,N,A=timeglider,S=timeglider.TG_Date;r.widget("timeglider.timeline",{options:{timezone:"00:00",initial_focus:A.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"}},_create:function(){this._id=r(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-date-display'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-settings-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var m=timeglider.validateOptions(this.options);if(m==""){A.TG_Date.setCulture(this.options.culture);N=new A.TG_Mediator(this.options);Z=new A.TG_PlayerView(this,N);N.setFocusDate(new S(this.options.initial_focus));N.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+m)},goTo:function(m,J){N.gotoDateZoom(m,J)},getMediator:function(){return N},zoom:function(m){switch(m){case "in":m=-1;break;case "out":m=1}if(m>99||m<-99)return false;
N.zoom(m)},load:function(m){N.loadTimelineData(m)},panButton:function(m,J){var T=0;switch(J){case "left":T=30;break;case "right":T=-30;break;default:T=J}Z.setPanButton(m,T)},destroy:function(){r.Widget.prototype.destroy.apply(this,arguments);r(this.element).html("")}})})(jQuery);
