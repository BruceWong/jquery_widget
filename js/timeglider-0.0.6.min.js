(function(){var k=this,P=k._,R={},J=Array.prototype,U=Object.prototype,u=J.slice,B=J.unshift,x=U.toString,D=U.hasOwnProperty,y=J.forEach,i=J.map,l=J.reduce,w=J.reduceRight,g=J.filter,n=J.every,F=J.some,I=J.indexOf,T=J.lastIndexOf;U=Array.isArray;var W=Object.keys,z=function(h){return new s(h)};if(typeof module!=="undefined"&&module.exports){module.exports=z;z._=z}else k._=z;z.VERSION="1.1.4";var da=z.each=z.forEach=function(h,o,v){if(h!=null)if(y&&h.forEach===y)h.forEach(o,v);else if(z.isNumber(h.length))for(var C=
0,M=h.length;C<M;C++){if(o.call(v,h[C],C,h)===R)break}else for(C in h)if(D.call(h,C))if(o.call(v,h[C],C,h)===R)break};z.map=function(h,o,v){var C=[];if(h==null)return C;if(i&&h.map===i)return h.map(o,v);da(h,function(M,O,Y){C[C.length]=o.call(v,M,O,Y)});return C};z.reduce=z.foldl=z.inject=function(h,o,v,C){var M=v!==void 0;if(h==null)h=[];if(l&&h.reduce===l){if(C)o=z.bind(o,C);return M?h.reduce(o,v):h.reduce(o)}da(h,function(O,Y,ja){if(!M&&Y===0){v=O;M=true}else v=o.call(C,v,O,Y,ja)});if(!M)throw new TypeError("Reduce of empty array with no initial value");
return v};z.reduceRight=z.foldr=function(h,o,v,C){if(h==null)h=[];if(w&&h.reduceRight===w){if(C)o=z.bind(o,C);return v!==void 0?h.reduceRight(o,v):h.reduceRight(o)}h=(z.isArray(h)?h.slice():z.toArray(h)).reverse();return z.reduce(h,o,v,C)};z.find=z.detect=function(h,o,v){var C;ha(h,function(M,O,Y){if(o.call(v,M,O,Y)){C=M;return true}});return C};z.filter=z.select=function(h,o,v){var C=[];if(h==null)return C;if(g&&h.filter===g)return h.filter(o,v);da(h,function(M,O,Y){if(o.call(v,M,O,Y))C[C.length]=
M});return C};z.reject=function(h,o,v){var C=[];if(h==null)return C;da(h,function(M,O,Y){o.call(v,M,O,Y)||(C[C.length]=M)});return C};z.every=z.all=function(h,o,v){o=o||z.identity;var C=true;if(h==null)return C;if(n&&h.every===n)return h.every(o,v);da(h,function(M,O,Y){if(!(C=C&&o.call(v,M,O,Y)))return R});return C};var ha=z.some=z.any=function(h,o,v){o=o||z.identity;var C=false;if(h==null)return C;if(F&&h.some===F)return h.some(o,v);da(h,function(M,O,Y){if(C=o.call(v,M,O,Y))return R});return C};
z.include=z.contains=function(h,o){var v=false;if(h==null)return v;if(I&&h.indexOf===I)return h.indexOf(o)!=-1;ha(h,function(C){if(v=C===o)return true});return v};z.invoke=function(h,o){var v=u.call(arguments,2);return z.map(h,function(C){return(o?C[o]:C).apply(C,v)})};z.pluck=function(h,o){return z.map(h,function(v){return v[o]})};z.max=function(h,o,v){if(!o&&z.isArray(h))return Math.max.apply(Math,h);var C={computed:-Infinity};da(h,function(M,O,Y){O=o?o.call(v,M,O,Y):M;O>=C.computed&&(C={value:M,
computed:O})});return C.value};z.min=function(h,o,v){if(!o&&z.isArray(h))return Math.min.apply(Math,h);var C={computed:Infinity};da(h,function(M,O,Y){O=o?o.call(v,M,O,Y):M;O<C.computed&&(C={value:M,computed:O})});return C.value};z.sortBy=function(h,o,v){return z.pluck(z.map(h,function(C,M,O){return{value:C,criteria:o.call(v,C,M,O)}}).sort(function(C,M){var O=C.criteria,Y=M.criteria;return O<Y?-1:O>Y?1:0}),"value")};z.sortedIndex=function(h,o,v){v=v||z.identity;for(var C=0,M=h.length;C<M;){var O=C+
M>>1;v(h[O])<v(o)?C=O+1:M=O}return C};z.toArray=function(h){if(!h)return[];if(h.toArray)return h.toArray();if(z.isArray(h))return h;if(z.isArguments(h))return u.call(h);return z.values(h)};z.size=function(h){return z.toArray(h).length};z.first=z.head=function(h,o,v){return o&&!v?u.call(h,0,o):h[0]};z.rest=z.tail=function(h,o,v){return u.call(h,z.isUndefined(o)||v?1:o)};z.last=function(h){return h[h.length-1]};z.compact=function(h){return z.filter(h,function(o){return!!o})};z.flatten=function(h){return z.reduce(h,
function(o,v){if(z.isArray(v))return o.concat(z.flatten(v));o[o.length]=v;return o},[])};z.without=function(h){var o=u.call(arguments,1);return z.filter(h,function(v){return!z.include(o,v)})};z.uniq=z.unique=function(h,o){return z.reduce(h,function(v,C,M){if(0==M||(o===true?z.last(v)!=C:!z.include(v,C)))v[v.length]=C;return v},[])};z.intersect=function(h){var o=u.call(arguments,1);return z.filter(z.uniq(h),function(v){return z.every(o,function(C){return z.indexOf(C,v)>=0})})};z.zip=function(){for(var h=
u.call(arguments),o=z.max(z.pluck(h,"length")),v=Array(o),C=0;C<o;C++)v[C]=z.pluck(h,""+C);return v};z.indexOf=function(h,o,v){if(h==null)return-1;if(v){v=z.sortedIndex(h,o);return h[v]===o?v:-1}if(I&&h.indexOf===I)return h.indexOf(o);v=0;for(var C=h.length;v<C;v++)if(h[v]===o)return v;return-1};z.lastIndexOf=function(h,o){if(h==null)return-1;if(T&&h.lastIndexOf===T)return h.lastIndexOf(o);for(var v=h.length;v--;)if(h[v]===o)return v;return-1};z.range=function(h,o,v){var C=u.call(arguments),M=C.length<=
1;h=M?0:C[0];o=M?C[0]:C[1];v=C[2]||1;C=Math.max(Math.ceil((o-h)/v),0);M=0;for(var O=Array(C);M<C;){O[M++]=h;h+=v}return O};z.bind=function(h,o){var v=u.call(arguments,2);return function(){return h.apply(o||{},v.concat(u.call(arguments)))}};z.bindAll=function(h){var o=u.call(arguments,1);if(o.length==0)o=z.functions(h);da(o,function(v){h[v]=z.bind(h[v],h)});return h};z.memoize=function(h,o){var v={};o=o||z.identity;return function(){var C=o.apply(this,arguments);return C in v?v[C]:v[C]=h.apply(this,
arguments)}};z.delay=function(h,o){var v=u.call(arguments,2);return setTimeout(function(){return h.apply(h,v)},o)};z.defer=function(h){return z.delay.apply(z,[h,1].concat(u.call(arguments,1)))};var A=function(h,o,v){var C;return function(){var M=this,O=arguments,Y=function(){C=null;h.apply(M,O)};v&&clearTimeout(C);if(v||!C)C=setTimeout(Y,o)}};z.throttle=function(h,o){return A(h,o,false)};z.debounce=function(h,o){return A(h,o,true)};z.wrap=function(h,o){return function(){var v=[h].concat(u.call(arguments));
return o.apply(this,v)}};z.compose=function(){var h=u.call(arguments);return function(){for(var o=u.call(arguments),v=h.length-1;v>=0;v--)o=[h[v].apply(this,o)];return o[0]}};z.keys=W||function(h){if(z.isArray(h))return z.range(0,h.length);var o=[],v;for(v in h)if(D.call(h,v))o[o.length]=v;return o};z.values=function(h){return z.map(h,z.identity)};z.functions=z.methods=function(h){return z.filter(z.keys(h),function(o){return z.isFunction(h[o])}).sort()};z.extend=function(h){da(u.call(arguments,1),
function(o){for(var v in o)h[v]=o[v]});return h};z.clone=function(h){return z.isArray(h)?h.slice():z.extend({},h)};z.tap=function(h,o){o(h);return h};z.isEqual=function(h,o){if(h===o)return true;var v=typeof h;if(v!=typeof o)return false;if(h==o)return true;if(!h&&o||h&&!o)return false;if(h._chain)h=h._wrapped;if(o._chain)o=o._wrapped;if(h.isEqual)return h.isEqual(o);if(z.isDate(h)&&z.isDate(o))return h.getTime()===o.getTime();if(z.isNaN(h)&&z.isNaN(o))return false;if(z.isRegExp(h)&&z.isRegExp(o))return h.source===
o.source&&h.global===o.global&&h.ignoreCase===o.ignoreCase&&h.multiline===o.multiline;if(v!=="object")return false;if(h.length&&h.length!==o.length)return false;v=z.keys(h);var C=z.keys(o);if(v.length!=C.length)return false;for(var M in h)if(!(M in o)||!z.isEqual(h[M],o[M]))return false;return true};z.isEmpty=function(h){if(z.isArray(h)||z.isString(h))return h.length===0;for(var o in h)if(D.call(h,o))return false;return true};z.isElement=function(h){return!!(h&&h.nodeType==1)};z.isArray=U||function(h){return x.call(h)===
"[object Array]"};z.isArguments=function(h){return!!(h&&D.call(h,"callee"))};z.isFunction=function(h){return!!(h&&h.constructor&&h.call&&h.apply)};z.isString=function(h){return!!(h===""||h&&h.charCodeAt&&h.substr)};z.isNumber=function(h){return!!(h===0||h&&h.toExponential&&h.toFixed)};z.isNaN=function(h){return h!==h};z.isBoolean=function(h){return h===true||h===false};z.isDate=function(h){return!!(h&&h.getTimezoneOffset&&h.setUTCFullYear)};z.isRegExp=function(h){return!!(h&&h.test&&h.exec&&(h.ignoreCase||
h.ignoreCase===false))};z.isNull=function(h){return h===null};z.isUndefined=function(h){return h===void 0};z.noConflict=function(){k._=P;return this};z.identity=function(h){return h};z.times=function(h,o,v){for(var C=0;C<h;C++)o.call(v,C)};z.mixin=function(h){da(z.functions(h),function(o){G(o,z[o]=h[o])})};var m=0;z.uniqueId=function(h){var o=m++;return h?h+o:o};z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};z.template=function(h,o){var v=z.templateSettings;v="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+
h.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(v.interpolate,function(C,M){return"',"+M.replace(/\\'/g,"'")+",'"}).replace(v.evaluate||null,function(C,M){return"');"+M.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";v=new Function("obj",v);return o?v(o):v};var s=function(h){this._wrapped=h};z.prototype=s.prototype;var E=function(h,o){return o?z(h).chain():h},G=function(h,o){s.prototype[h]=function(){var v=
u.call(arguments);B.call(v,this._wrapped);return E(o.apply(z,v),this._chain)}};z.mixin(z);da(["pop","push","reverse","shift","sort","splice","unshift"],function(h){var o=J[h];s.prototype[h]=function(){o.apply(this._wrapped,arguments);return E(this._wrapped,this._chain)}});da(["concat","join","slice"],function(h){var o=J[h];s.prototype[h]=function(){return E(o.apply(this._wrapped,arguments),this._chain)}});s.prototype.chain=function(){this._chain=true;return this};s.prototype.value=function(){return this._wrapped}})();(function(){var k;k=typeof exports!=="undefined"?exports:this.Backbone={};k.VERSION="0.3.3";var P=this._;if(!P&&typeof require!=="undefined")P=require("underscore")._;var R=this.jQuery||this.Zepto;k.emulateHTTP=false;k.emulateJSON=false;k.Events={bind:function(g,n){this._callbacks||(this._callbacks={});(this._callbacks[g]||(this._callbacks[g]=[])).push(n);return this},unbind:function(g,n){var F;if(g){if(F=this._callbacks)if(n){F=F[g];if(!F)return this;for(var I=0,T=F.length;I<T;I++)if(n===F[I]){F.splice(I,
1);break}}else F[g]=[]}else this._callbacks={};return this},trigger:function(g){var n,F,I,T;if(!(F=this._callbacks))return this;if(n=F[g]){I=0;for(T=n.length;I<T;I++)n[I].apply(this,Array.prototype.slice.call(arguments,1))}if(n=F.all){I=0;for(T=n.length;I<T;I++)n[I].apply(this,arguments)}return this}};k.Model=function(g,n){g||(g={});if(this.defaults)g=P.extend({},this.defaults,g);this.attributes={};this._escapedAttributes={};this.cid=P.uniqueId("c");this.set(g,{silent:true});this._previousAttributes=
P.clone(this.attributes);if(n&&n.collection)this.collection=n.collection;this.initialize(g,n)};P.extend(k.Model.prototype,k.Events,{_previousAttributes:null,_changed:false,initialize:function(){},toJSON:function(){return P.clone(this.attributes)},get:function(g){return this.attributes[g]},escape:function(g){var n;if(n=this._escapedAttributes[g])return n;n=this.attributes[g];return this._escapedAttributes[g]=(n==null?"":n).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;")},set:function(g,n){n||(n={});if(!g)return this;if(g.attributes)g=g.attributes;var F=this.attributes,I=this._escapedAttributes;if(!n.silent&&this.validate&&!this._performValidation(g,n))return false;if("id"in g)this.id=g.id;for(var T in g){var W=g[T];if(!P.isEqual(F[T],W)){F[T]=W;delete I[T];if(!n.silent){this._changed=true;this.trigger("change:"+T,this,W,n)}}}!n.silent&&this._changed&&this.change(n);return this},unset:function(g,n){n||(n={});var F={};F[g]=void 0;if(!n.silent&&this.validate&&
!this._performValidation(F,n))return false;delete this.attributes[g];delete this._escapedAttributes[g];if(!n.silent){this._changed=true;this.trigger("change:"+g,this,void 0,n);this.change(n)}return this},clear:function(g){g||(g={});var n=this.attributes,F={};for(attr in n)F[attr]=void 0;if(!g.silent&&this.validate&&!this._performValidation(F,g))return false;this.attributes={};this._escapedAttributes={};if(!g.silent){this._changed=true;for(attr in n)this.trigger("change:"+attr,this,void 0,g);this.change(g)}return this},
fetch:function(g){g||(g={});var n=this,F=w(g.error,n,g);(this.sync||k.sync)("read",this,function(I){if(!n.set(n.parse(I),g))return false;g.success&&g.success(n,I)},F);return this},save:function(g,n){n||(n={});if(g&&!this.set(g,n))return false;var F=this,I=w(n.error,F,n),T=this.isNew()?"create":"update";(this.sync||k.sync)(T,this,function(W){if(!F.set(F.parse(W),n))return false;n.success&&n.success(F,W)},I);return this},destroy:function(g){g||(g={});var n=this,F=w(g.error,n,g);(this.sync||k.sync)("delete",
this,function(I){n.collection&&n.collection.remove(n);g.success&&g.success(n,I)},F);return this},url:function(){var g=l(this.collection);if(this.isNew())return g;return g+(g.charAt(g.length-1)=="/"?"":"/")+this.id},parse:function(g){return g},clone:function(){return new this.constructor(this)},isNew:function(){return!this.id},change:function(g){this.trigger("change",this,g);this._previousAttributes=P.clone(this.attributes);this._changed=false},hasChanged:function(g){if(g)return this._previousAttributes[g]!=
this.attributes[g];return this._changed},changedAttributes:function(g){g||(g=this.attributes);var n=this._previousAttributes,F=false,I;for(I in g)if(!P.isEqual(n[I],g[I])){F=F||{};F[I]=g[I]}return F},previous:function(g){if(!g||!this._previousAttributes)return null;return this._previousAttributes[g]},previousAttributes:function(){return P.clone(this._previousAttributes)},_performValidation:function(g,n){var F=this.validate(g);if(F){n.error?n.error(this,F):this.trigger("error",this,F,n);return false}return true}});
k.Collection=function(g,n){n||(n={});if(n.comparator){this.comparator=n.comparator;delete n.comparator}this._boundOnModelEvent=P.bind(this._onModelEvent,this);this._reset();g&&this.refresh(g,{silent:true});this.initialize(g,n)};P.extend(k.Collection.prototype,k.Events,{model:k.Model,initialize:function(){},toJSON:function(){return this.map(function(g){return g.toJSON()})},add:function(g,n){if(P.isArray(g))for(var F=0,I=g.length;F<I;F++)this._add(g[F],n);else this._add(g,n);return this},remove:function(g,
n){if(P.isArray(g))for(var F=0,I=g.length;F<I;F++)this._remove(g[F],n);else this._remove(g,n);return this},get:function(g){if(g==null)return null;return this._byId[g.id!=null?g.id:g]},getByCid:function(g){return g&&this._byCid[g.cid||g]},at:function(g){return this.models[g]},sort:function(g){g||(g={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);g.silent||this.trigger("refresh",this,g);return this},pluck:function(g){return P.map(this.models,
function(n){return n.get(g)})},refresh:function(g,n){g||(g=[]);n||(n={});this._reset();this.add(g,{silent:true});n.silent||this.trigger("refresh",this,n);return this},fetch:function(g){g||(g={});var n=this,F=w(g.error,n,g);(this.sync||k.sync)("read",this,function(I){n.refresh(n.parse(I));g.success&&g.success(n,I)},F);return this},create:function(g,n){var F=this;n||(n={});if(g instanceof k.Model)g.collection=F;else g=new this.model(g,{collection:F});return g.save(null,{success:function(I,T){F.add(I);
n.success&&n.success(I,T)},error:n.error})},parse:function(g){return g},chain:function(){return P(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_add:function(g,n){n||(n={});g instanceof k.Model||(g=new this.model(g,{collection:this}));var F=this.getByCid(g);if(F)throw Error(["Can't add the same model to a set twice",F.id]);this._byId[g.id]=g;this._byCid[g.cid]=g;g.collection=this;this.models.splice(this.comparator?this.sortedIndex(g,this.comparator):
this.length,0,g);g.bind("all",this._boundOnModelEvent);this.length++;n.silent||g.trigger("add",g,this,n);return g},_remove:function(g,n){n||(n={});g=this.getByCid(g)||this.get(g);if(!g)return null;delete this._byId[g.id];delete this._byCid[g.cid];delete g.collection;this.models.splice(this.indexOf(g),1);this.length--;n.silent||g.trigger("remove",g,this,n);g.unbind("all",this._boundOnModelEvent);return g},_onModelEvent:function(g,n){if(g==="change:id"){delete this._byId[n.previous("id")];this._byId[n.id]=
n}this.trigger.apply(this,arguments)}});P.each(["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(g){k.Collection.prototype[g]=function(){return P[g].apply(P,[this.models].concat(P.toArray(arguments)))}});k.Controller=function(g){g||(g={});if(g.routes)this.routes=g.routes;this._bindRoutes();
this.initialize(g)};var J=/:([\w\d]+)/g,U=/\*([\w\d]+)/g;P.extend(k.Controller.prototype,k.Events,{initialize:function(){},route:function(g,n,F){k.history||(k.history=new k.History);P.isRegExp(g)||(g=this._routeToRegExp(g));k.history.route(g,P.bind(function(I){I=this._extractParameters(g,I);F.apply(this,I);this.trigger.apply(this,["route:"+n].concat(I))},this))},saveLocation:function(g){k.history.saveLocation(g)},_bindRoutes:function(){if(this.routes)for(var g in this.routes){var n=this.routes[g];
this.route(g,n,this[n])}},_routeToRegExp:function(g){g=g.replace(J,"([^/]*)").replace(U,"(.*?)");return RegExp("^"+g+"$")},_extractParameters:function(g,n){return g.exec(n).slice(1)}});k.History=function(){this.handlers=[];this.fragment=this.getFragment();P.bindAll(this,"checkUrl")};var u=/^#*/;P.extend(k.History.prototype,{interval:50,getFragment:function(g){return(g||window.location).hash.replace(u,"")},start:function(){var g=document.documentMode;if(g=R.browser.msie&&(!g||g<=7))this.iframe=R('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;
"onhashchange"in window&&!g?R(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);return this.loadUrl()},route:function(g,n){this.handlers.push({route:g,callback:n})},checkUrl:function(){var g=this.getFragment();if(g==this.fragment&&this.iframe)g=this.getFragment(this.iframe.location);if(g==this.fragment||g==decodeURIComponent(this.fragment))return false;if(this.iframe)window.location.hash=this.iframe.location.hash=g;this.loadUrl()},loadUrl:function(){var g=this.fragment=
this.getFragment();return P.any(this.handlers,function(n){if(n.route.test(g)){n.callback(g);return true}})},saveLocation:function(g){g=(g||"").replace(u,"");if(this.fragment!=g){window.location.hash=this.fragment=g;if(this.iframe&&g!=this.getFragment(this.iframe.location)){this.iframe.document.open().close();this.iframe.location.hash=g}}}});k.View=function(g){this._configure(g||{});this._ensureElement();this.delegateEvents();this.initialize(g)};var B=/^(\w+)\s*(.*)$/;P.extend(k.View.prototype,k.Events,
{tagName:"div",$:function(g){return R(g,this.el)},initialize:function(){},render:function(){return this},remove:function(){R(this.el).remove();return this},make:function(g,n,F){g=document.createElement(g);n&&R(g).attr(n);F&&R(g).html(F);return g},delegateEvents:function(g){if(g||(g=this.events)){R(this.el).unbind();for(var n in g){var F=g[n],I=n.match(B),T=I[1];I=I[2];F=P.bind(this[F],this);I===""?R(this.el).bind(T,F):R(this.el).delegate(I,T,F)}}},_configure:function(g){if(this.options)g=P.extend({},
this.options,g);if(g.model)this.model=g.model;if(g.collection)this.collection=g.collection;if(g.el)this.el=g.el;if(g.id)this.id=g.id;if(g.className)this.className=g.className;if(g.tagName)this.tagName=g.tagName;this.options=g},_ensureElement:function(){if(!this.el){var g={};if(this.id)g.id=this.id;if(this.className)g["class"]=this.className;this.el=this.make(this.tagName,g)}}});var x=function(g,n){var F=i(this,g,n);F.extend=x;return F};k.Model.extend=k.Collection.extend=k.Controller.extend=k.View.extend=
x;var D={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};k.sync=function(g,n,F,I){var T=D[g];g=g==="create"||g==="update"?JSON.stringify(n.toJSON()):null;n={url:l(n),type:T,contentType:"application/json",data:g,dataType:"json",processData:false,success:F,error:I};if(k.emulateJSON){n.contentType="application/x-www-form-urlencoded";n.processData=true;n.data=g?{model:g}:{}}if(k.emulateHTTP)if(T==="PUT"||T==="DELETE"){if(k.emulateJSON)n.data._method=T;n.type="POST";n.beforeSend=function(W){W.setRequestHeader("X-HTTP-Method-Override",
T)}}R.ajax(n)};var y=function(){},i=function(g,n,F){var I;I=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return g.apply(this,arguments)};y.prototype=g.prototype;I.prototype=new y;n&&P.extend(I.prototype,n);F&&P.extend(I,F);I.prototype.constructor=I;I.__super__=g.prototype;return I},l=function(g){if(!(g&&g.url))throw Error("A 'url' property or function must be specified");return P.isFunction(g.url)?g.url():g.url},w=function(g,n,F){return function(I){g?g(n,I):n.trigger("error",n,I,F)}}})();window.debug=function(){function k(w){if(u&&(B||!J||!J.log))u.apply(P,w)}for(var P=this,R=Array.prototype.slice,J=P.console,U={},u,B,x=9,D=["error","warn","info","debug","log"],y="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),i=y.length,l=[];--i>=0;)(function(w){U[w]=function(){x!==0&&J&&J[w]&&J[w].apply(J,arguments)}})(y[i]);for(i=D.length;--i>=0;)(function(w,g){U[g]=function(){var n=R.call(arguments),F=[g].concat(n);
l.push(F);k(F);if(J&&(x>0?x>w:D.length+x<=w))J.firebug?J[g].apply(P,n):J[g]?J[g](n):J.log(n)}})(i,D[i]);U.setLevel=function(w){x=typeof w==="number"?w:9};U.setCallback=function(){var w=R.call(arguments),g=l.length,n=g;u=w.shift()||null;B=typeof w[0]==="boolean"?w.shift():false;for(n-=typeof w[0]==="number"?w.shift():g;n<g;)k(l[n++])};return U}();(function(k){function P(m,s,E,G){G={data:G||G===0||G===false?G:s?s.data:{},_wrap:s?s._wrap:null,tmpl:null,parent:s||null,nodes:[],calls:D,nest:y,wrap:i,html:l,update:w};m&&k.extend(G,m,{nodes:[],parent:s});if(E){G.tmpl=E;G._ctnt=G._ctnt||G.tmpl(k,G);G.key=++da;(A.length?T:I)[da]=G}return G}function R(m,s,E){var G;E=E?k.map(E,function(h){return typeof h==="string"?m.key?h.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+n+'="'+m.key+'" $2'):h:R(h,m,h._ctnt)}):m;if(s)return E;E=E.join("");
E.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(h,o,v,C){G=k(v).get();x(G);if(o)G=J(o).concat(G);if(C)G=G.concat(J(C))});return G?G:J(E)}function J(m){var s=document.createElement("div");s.innerHTML=m;return k.makeArray(s.childNodes)}function U(m){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+k.trim(m).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(s,E,G,h,o,v,C){s=k.tmpl.tag[G];if(!s)throw"Unknown template tag: "+G;G=s._default||[];if(v&&!/\w$/.test(o)){o+=v;v=""}if(o){o=B(o);C=C?","+B(C)+")":v?")":"";C=v?o.indexOf(".")>-1?o+B(v):"("+o+").call($item"+C:o;v=v?C:"(typeof("+o+")==='function'?("+o+").call($item):("+o+"))"}else v=C=G.$1||"null";h=B(h);return"');"+s[E?"close":"open"].split("$notnull_1").join(o?"typeof("+o+")!=='undefined' && ("+o+")!=null":"true").split("$1a").join(v).split("$1").join(C).split("$2").join(h||G.$2||"")+"__.push('"})+
"');}return __;")}function u(m,s){m._wrap=R(m,true,k.isArray(s)?s:[F.test(s)?s:k(s).html()]).join("")}function B(m){return m?m.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function x(m){function s(O){function Y(ea){ea+=E;ca=o[ea]=o[ea]||P(ca,I[ca.parent.key+E]||ca.parent)}var ja,Z=O,ca,ka;if(ka=O.getAttribute(n)){for(;Z.parentNode&&(Z=Z.parentNode).nodeType===1&&!(ja=Z.getAttribute(n)););if(ja!==ka){Z=Z.parentNode?Z.nodeType===11?0:Z.getAttribute(n)||0:0;if(!(ca=I[ka])){ca=T[ka];ca=P(ca,I[Z]||T[Z]);
ca.key=++da;I[da]=ca}ha&&Y(ka)}O.removeAttribute(n)}else if(ha&&(ca=k.data(O,"tmplItem"))){Y(ca.key);I[ca.key]=ca;Z=(Z=k.data(O.parentNode,"tmplItem"))?Z.key:0}if(ca){for(ja=ca;ja&&ja.key!=Z;){ja.nodes.push(O);ja=ja.parent}delete ca._ctnt;delete ca._wrap;k.data(O,"tmplItem",ca)}}var E="_"+ha,G,h,o={},v,C,M;v=0;for(C=m.length;v<C;v++)if((G=m[v]).nodeType===1){h=G.getElementsByTagName("*");for(M=h.length-1;M>=0;M--)s(h[M]);s(G)}}function D(m,s,E,G){if(!m)return A.pop();A.push({_:m,tmpl:s,item:this,
data:E,options:G})}function y(m,s,E){return k.tmpl(k.template(m),s,E,this)}function i(m,s){var E=m.options||{};E.wrapped=s;return k.tmpl(k.template(m.tmpl),m.data,E,m.item)}function l(m,s){var E=this._wrap;return k.map(k(k.isArray(E)?E.join(""):E).filter(m||"*"),function(G){if(s)G=G.innerText||G.textContent;else{var h;if(!(h=G.outerHTML)){h=document.createElement("div");h.appendChild(G.cloneNode(true));h=h.innerHTML}G=h}return G})}function w(){var m=this.nodes;k.tmpl(null,null,null,this).insertBefore(m[0]);
k(m).remove()}var g=k.fn.domManip,n="_tmplitem",F=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,I={},T={},W,z={key:0,data:{}},da=0,ha=0,A=[];k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(m,s){k.fn[m]=function(E){var G=[];E=k(E);var h,o,v;h=this.length===1&&this[0].parentNode;W=I||{};if(h&&h.nodeType===11&&h.childNodes.length===1&&E.length===1){E[s](this[0]);G=this}else{o=0;for(v=E.length;o<v;o++){ha=o;h=(o>0?this.clone(true):this).get();
k(E[o])[s](h);G=G.concat(h)}ha=0;G=this.pushStack(G,m,E.selector)}E=W;W=null;k.tmpl.complete(E);return G}});k.fn.extend({tmpl:function(m,s,E){return k.tmpl(this[0],m,s,E)},tmplItem:function(){return k.tmplItem(this[0])},template:function(m){return k.template(m,this[0])},domManip:function(m,s,E){if(m[0]&&k.isArray(m[0])){for(var G=k.makeArray(arguments),h=m[0],o=h.length,v=0,C;v<o&&!(C=k.data(h[v++],"tmplItem")););if(C&&ha)G[2]=function(M){k.tmpl.afterManip(this,M,E)};g.apply(this,G)}else g.apply(this,
arguments);ha=0;W||k.tmpl.complete(I);return this}});k.extend({tmpl:function(m,s,E,G){var h=!G;if(h){G=z;m=k.template[m]||k.template(null,m);T={}}else if(!m){m=G.tmpl;I[G.key]=G;G.nodes=[];G.wrapped&&u(G,G.wrapped);return k(R(G,null,G.tmpl(k,G)))}if(!m)return[];if(typeof s==="function")s=s.call(G||{});E&&E.wrapped&&u(E,E.wrapped);s=k.isArray(s)?k.map(s,function(o){return o?P(E,G,m,o):null}):[P(E,G,m,s)];return h?k(R(G,null,s)):s},tmplItem:function(m){var s;if(m instanceof k)m=m[0];for(;m&&m.nodeType===
1&&!(s=k.data(m,"tmplItem"))&&(m=m.parentNode););return s||z},template:function(m,s){if(s){if(typeof s==="string")s=U(s);else if(s instanceof k)s=s[0]||{};if(s.nodeType)s=k.data(s,"tmpl")||k.data(s,"tmpl",U(s.innerHTML));return typeof m==="string"?k.template[m]=s:s}return m?typeof m!=="string"?k.template(null,m):k.template[m]||k.template(null,F.test(m)?m:k(m)):null},encode:function(m){return(""+m).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
k.extend(k.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){I={}},afterManip:function(m,s,E){var G=s.nodeType===11?k.makeArray(s.childNodes):s.nodeType===1?[s]:[];E.call(m,s);x(G);ha++}})})(jQuery);(function(k){function P(J){var U=J||window.event,u=[].slice.call(arguments,1),B=0,x=0,D=0;J=k.event.fix(U);J.type="mousewheel";if(J.wheelDelta)B=J.wheelDelta/120;if(J.detail)B=-J.detail/3;D=B;if(U.axis!==undefined&&U.axis===U.HORIZONTAL_AXIS){D=0;x=-1*B}if(U.wheelDeltaY!==undefined)D=U.wheelDeltaY/120;if(U.wheelDeltaX!==undefined)x=-1*U.wheelDeltaX/120;u.unshift(J,B,x,D);return k.event.handle.apply(this,u)}var R=["DOMMouseScroll","mousewheel"];k.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var J=
R.length;J;)this.addEventListener(R[--J],P,false);else this.onmousewheel=P},teardown:function(){if(this.removeEventListener)for(var J=R.length;J;)this.removeEventListener(R[--J],P,false);else this.onmousewheel=null}};k.fn.extend({mousewheel:function(J){return J?this.bind("mousewheel",J):this.trigger("mousewheel")},unmousewheel:function(J){return this.unbind("mousewheel",J)}})})(jQuery);(function(k){function P(){if(x){window.clearTimeout(D);x=false}}function R(){if(!x){x=true;D=window.setTimeout("doRightClick();",800)}}function J(i){var l="";if(!(i.touches.length>1)){switch(i.type){case "gesturestart":alert("gesturestart");i.preventDefault();break;case "touchstart":if(k(i.changedTouches[0].target).is("select"))return;l=i.changedTouches[0];var w="mouseover",g=document.createEvent("MouseEvent");g.initMouseEvent(w,true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,
false,false,0,null);l.target.dispatchEvent(g);w="mousedown";g=document.createEvent("MouseEvent");g.initMouseEvent(w,true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);l.target.dispatchEvent(g);if(u){window.clearTimeout(B);if(l.target==U){U=null;u=false;w="click";g=document.createEvent("MouseEvent");g.initMouseEvent(w,true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);l.target.dispatchEvent(g);w="dblclick";g=document.createEvent("MouseEvent");
g.initMouseEvent(w,true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);l.target.dispatchEvent(g)}else{U=l.target;u=true;B=window.setTimeout("cancelTap();",600);R(i)}}else{U=l.target;u=true;B=window.setTimeout("cancelTap();",600);R(i)}i.preventDefault();return false;case "touchmove":P();l="mousemove";i.preventDefault();break;case "touchend":if(y){y=false;i.preventDefault();return false}P();l="mouseup";break;default:return}i=i.changedTouches[0];w=document.createEvent("MouseEvent");
w.initMouseEvent(l,true,true,window,1,i.screenX,i.screenY,i.clientX,i.clientY,false,false,false,false,0,null);i.target.dispatchEvent(w);if(l=="mouseup"&&u&&i.target==U){w=document.createEvent("MouseEvent");w.initMouseEvent("click",true,true,window,1,i.screenX,i.screenY,i.clientX,i.clientY,false,false,false,false,0,null);i.target.dispatchEvent(w)}}}k.extend(k.support,{touch:typeof Touch=="object"});k.fn.addTouch=function(){k.support.touch&&this.each(function(i,l){l.addEventListener("touchstart",J,
false);l.addEventListener("touchmove",J,false);l.addEventListener("touchend",J,false);l.addEventListener("touchcancel",J,false)})};var U=null,u=false,B=null,x=false,D=null,y=false})(jQuery);(function(){function k(){if(k.is(arguments[0],O)){for(var a=arguments[0],b=Ma[I](k,a.splice(0,3+k.is(a[0],M))),c=b.set(),e=0,f=a[m];e<f;e++){var d=a[e]||{};x[i](d.type)&&c[Z](b[d.type]().attr(d))}return c}return Ma[I](k,arguments)}function P(){for(var a=[],b=0;b<32;b++)a[b]=(~~(E.random()*16))[Y](16);a[12]=4;a[16]=(a[16]&3|8)[Y](16);return"r-"+a[A]("")}function R(a,b,c){function e(){var f=Array[y].slice.call(arguments,0),d=f[A]("\u25ba"),j=e.cache=e.cache||{},p=e.count=e.count||[];if(j[i](d))return c?
c(j[d]):j[d];p[m]>=1E3&&delete j[p.shift()];p[Z](d);j[d]=a[I](b,f);return c?c(j[d]):j[d]}return e}function J(){return this.x+W+this.y}function U(a){return function(b,c,e,f){var d={back:a};k.is(e,"function")?f=e:d.rot=e;b&&b.constructor==ga&&(b=b.attrs.path);b&&(d.along=b);return this.animate(d,c,f)}}function u(a,b,c,e,f,d){function j(Q,ba){var S,N,X,ia;X=Q;for(N=0;N<8;N++){ia=((r*X+q)*X+p)*X-Q;if(o(ia)<ba)return X;S=(3*r*X+2*q)*X+p;if(o(S)<1.0E-6)break;X-=ia/S}S=0;N=1;X=Q;if(X<S)return S;if(X>N)return N;
for(;S<N;){ia=((r*X+q)*X+p)*X;if(o(ia-Q)<ba)break;Q>ia?S=X:N=X;X=(N-S)/2+S}return X}var p=3*b,q=3*(e-b)-p,r=1-p-q,H=3*c,K=3*(f-c)-H,L=1-H-K;return function(Q,ba){var S=j(Q,ba);return((L*S+K)*S+H)*S}(a,1/(200*d))}k.version="1.5.2";var B=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},D=/\{(\d+)\}/g,y="prototype",i="hasOwnProperty",l=document,w=window,g={was:Object[y][i].call(w,"Raphael"),is:w.Raphael},n=function(){this.customAttributes={}},F,I="apply",T="createTouch"in l,W=" ",z=String,
da="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(W),ha={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},A="join",m="length",s=z[y].toLowerCase,E=Math,G=E.max,h=E.min,o=E.abs,v=E.pow,C=E.PI,M="number",O="array",Y="toString",ja=Object[y][Y],Z="push",ca=/^url\(['"]?([^\)]+?)['"]?\)$/i,ka=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ea={NaN:1,Infinity:1,"-Infinity":1},qa=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,$=E.round,V=parseFloat,ma=parseInt,va=z[y].toUpperCase,Da={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Na={along:"along",blur:M,"clip-rect":"csv",cx:M,cy:M,fill:"colour","fill-opacity":M,"font-size":M,height:M,opacity:M,path:"path",r:M,rotation:"csv",rx:M,ry:M,scale:"csv",stroke:"colour","stroke-opacity":M,"stroke-width":M,translation:"csv",width:M,x:M,y:M},tb=/^(from|to|\d+%?)$/,Oa=/\s*,\s*/,ub={hs:1,rg:1},vb=/,?([achlmqrstvxz]),?/gi,
wb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,xb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Ya=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,yb=function(a,b){return a.key-b.key};k.type=w.SVGAngle||l.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(k.type=="VML"){var sa=l.createElement("div");sa.innerHTML='<v:shape adj="1"/>';sa=sa.firstChild;sa.style.behavior="url(#default#VML)";if(!(sa&&typeof sa.adj=="object"))return k.type=null;sa=null}k.svg=
!(k.vml=k.type=="VML");n[y]=k[y];F=n[y];k._id=0;k._oid=0;k.fn={};k.is=function(a,b){b=s.call(b);if(b=="finite")return!ea[i](+a);return b=="null"&&a===null||b==typeof a||b=="object"&&a===Object(a)||b=="array"&&Array.isArray&&Array.isArray(a)||ja.call(a).slice(8,-1).toLowerCase()==b};k.angle=function(a,b,c,e,f,d){if(f==null){a-=c;b-=e;if(!a&&!b)return 0;return((a<0)*180+E.atan(-b/-a)*180/C+360)%360}return k.angle(a,b,f,d)-k.angle(c,e,f,d)};k.rad=function(a){return a%360*C/180};k.deg=function(a){return a*
180/C%360};k.snapTo=function(a,b,c){c=k.is(c,"finite")?c:10;if(k.is(a,O))for(var e=a.length;e--;){if(o(a[e]-b)<=c)return a[e]}else{a=+a;e=b%a;if(e<c)return b-e;if(e>a-c)return b-e+a}return b};k.setWindow=function(a){w=a;l=w.document};var Ea=function(a){if(k.vml){var b=/^\s+|\s+$/g,c;try{var e=new ActiveXObject("htmlfile");e.write("<body>");e.close();c=e.body}catch(f){c=createPopup().document.body}var d=c.createTextRange();Ea=R(function(p){try{c.style.color=z(p).replace(b,"");var q=d.queryCommandValue("ForeColor");
return"#"+("000000"+((q&255)<<16|q&65280|(q&16711680)>>>16)[Y](16)).slice(-6)}catch(r){return"none"}})}else{var j=l.createElement("i");j.title="Rapha\u00ebl Colour Picker";j.style.display="none";l.body.appendChild(j);Ea=R(function(p){j.style.color=p;return l.defaultView.getComputedStyle(j,"").getPropertyValue("color")})}return Ea(a)},Za=function(){return"hsb("+[this.h,this.s,this.b]+")"},zb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Ab=function(){return this.hex};k.hsb2rgb=function(a,b,c,
e){if(k.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){c=a.b;b=a.s;a=a.h;e=a.o}return k.hsl2rgb(a,b,c/2,e)};k.hsl2rgb=function(a,b,c,e){if(k.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){c=a.l;b=a.s;a=a.h}if(a>1||b>1||c>1){a/=360;b/=100;c/=100}var f={},d=["r","g","b"],j;if(b){c<0.5?j=c*(1+b):j=c+b-c*b;b=2*c-j;for(var p=0;p<3;p++){c=a+1/3*-(p-1);c<0&&c++;c>1&&c--;c*6<1?f[d[p]]=b+(j-b)*6*c:c*2<1?f[d[p]]=j:c*3<2?f[d[p]]=b+(j-b)*(2/3-c)*6:f[d[p]]=b}}else f={r:c,g:c,b:c};f.r*=255;f.g*=255;f.b*=255;f.hex="#"+
(16777216|f.b|f.g<<8|f.r<<16).toString(16).slice(1);k.is(e,"finite")&&(f.opacity=e);f.toString=Ab;return f};k.rgb2hsb=function(a,b,c){if(b==null&&k.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){c=a.b;b=a.g;a=a.r}if(b==null&&k.is(a,"string")){c=k.getRGB(a);a=c.r;b=c.g;c=c.b}if(a>1||b>1||c>1){a/=255;b/=255;c/=255}var e=G(a,b,c),f=h(a,b,c),d;if(f==e)return{h:0,s:0,b:e,toString:Za};f=e-f;a==e?d=(b-c)/f:b==e?d=2+(c-a)/f:d=4+(a-b)/f;d/=6;d<0&&d++;d>1&&d--;return{h:d,s:f/e,b:e,toString:Za}};k.rgb2hsl=function(a,
b,c){if(b==null&&k.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){c=a.b;b=a.g;a=a.r}if(b==null&&k.is(a,"string")){c=k.getRGB(a);a=c.r;b=c.g;c=c.b}if(a>1||b>1||c>1){a/=255;b/=255;c/=255}var e=G(a,b,c),f=h(a,b,c),d,j=(e+f)/2;if(f==e)a={h:0,s:0,l:j};else{var p=e-f;a==e?d=(b-c)/p:b==e?d=2+(c-a)/p:d=4+(a-b)/p;d/=6;d<0&&d++;d>1&&d--;a={h:d,s:j<0.5?p/(e+f):p/(2-e-f),l:j}}a.toString=zb;return a};k._path2string=function(){return this.join(",").replace(vb,"$1")};k.getRGB=R(function(a){if(!a||(a=z(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(ub[i](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Ea(a));var b,c,e,f,d;if(a=a.match(ka)){if(a[2]){e=ma(a[2].substring(5),16);c=ma(a[2].substring(3,5),16);b=ma(a[2].substring(1,3),16)}if(a[3]){e=ma((d=a[3].charAt(3))+d,16);c=ma((d=a[3].charAt(2))+d,16);b=ma((d=a[3].charAt(1))+d,16)}if(a[4]){d=a[4].split(Oa);b=V(d[0]);d[0].slice(-1)=="%"&&(b*=2.55);c=V(d[1]);d[1].slice(-1)=="%"&&(c*=2.55);e=V(d[2]);
d[2].slice(-1)=="%"&&(e*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(f=V(d[3]));d[3]&&d[3].slice(-1)=="%"&&(f/=100)}if(a[5]){d=a[5].split(Oa);b=V(d[0]);d[0].slice(-1)=="%"&&(b*=2.55);c=V(d[1]);d[1].slice(-1)=="%"&&(c*=2.55);e=V(d[2]);d[2].slice(-1)=="%"&&(e*=2.55);(d[0].slice(-3)=="deg"||d[0].slice(-1)=="\u00b0")&&(b/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(f=V(d[3]));d[3]&&d[3].slice(-1)=="%"&&(f/=100);return k.hsb2rgb(b,c,e,f)}if(a[6]){d=a[6].split(Oa);b=V(d[0]);d[0].slice(-1)=="%"&&(b*=
2.55);c=V(d[1]);d[1].slice(-1)=="%"&&(c*=2.55);e=V(d[2]);d[2].slice(-1)=="%"&&(e*=2.55);(d[0].slice(-3)=="deg"||d[0].slice(-1)=="\u00b0")&&(b/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(f=V(d[3]));d[3]&&d[3].slice(-1)=="%"&&(f/=100);return k.hsl2rgb(b,c,e,f)}a={r:b,g:c,b:e};a.hex="#"+(16777216|e|c<<8|b<<16).toString(16).slice(1);k.is(f,"finite")&&(a.opacity=f);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},k);k.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var b=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return b.hex};k.getColor.reset=function(){delete this.start};k.parsePathString=R(function(a){if(!a)return null;var b={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=[];k.is(a,O)&&k.is(a[0],O)&&(c=Fa(a));c[m]||z(a).replace(wb,function(e,f,d){var j=[];e=s.call(f);d.replace(xb,function(p,q){q&&j[Z](+q)});if(e=="m"&&j[m]>2){c[Z]([f].concat(j.splice(0,2)));e="l";f=f=="m"?"l":"L"}for(;j[m]>=b[e];){c[Z]([f].concat(j.splice(0,
b[e])));if(!b[e])break}});c[Y]=k._path2string;return c});k.findDotsAtSegment=function(a,b,c,e,f,d,j,p,q){var r=1-q,H=v(r,3)*a+v(r,2)*3*q*c+r*3*q*q*f+v(q,3)*j;r=v(r,3)*b+v(r,2)*3*q*e+r*3*q*q*d+v(q,3)*p;var K=a+2*q*(c-a)+q*q*(f-2*c+a),L=b+2*q*(e-b)+q*q*(d-2*e+b),Q=c+2*q*(f-c)+q*q*(j-2*f+c),ba=e+2*q*(d-e)+q*q*(p-2*d+e);a=(1-q)*a+q*c;b=(1-q)*b+q*e;f=(1-q)*f+q*j;d=(1-q)*d+q*p;p=90-E.atan((K-Q)/(L-ba))*180/C;(K>Q||L<ba)&&(p+=180);return{x:H,y:r,m:{x:K,y:L},n:{x:Q,y:ba},start:{x:a,y:b},end:{x:f,y:d},alpha:p}};
var Ha=R(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ga(a);for(var b=0,c=0,e=[],f=[],d,j=0,p=a[m];j<p;j++){d=a[j];if(d[0]=="M"){b=d[1];c=d[2];e[Z](b);f[Z](c)}else{b=Bb(b,c,d[1],d[2],d[3],d[4],d[5],d[6]);e=e.concat(b.min.x,b.max.x);f=f.concat(b.min.y,b.max.y);b=d[5];c=d[6]}}a=h[I](0,e);d=h[I](0,f);return{x:a,y:d,width:G[I](0,e)-a,height:G[I](0,f)-d}}),Fa=function(a){var b=[];if(!k.is(a,O)||!k.is(a&&a[0],O))a=k.parsePathString(a);for(var c=0,e=a[m];c<e;c++){b[c]=[];for(var f=0,d=a[c][m];f<
d;f++)b[c][f]=a[c][f]}b[Y]=k._path2string;return b},Pa=R(function(a){if(!k.is(a,O)||!k.is(a&&a[0],O))a=k.parsePathString(a);var b=[],c=0,e=0,f=0,d=0,j=0;if(a[0][0]=="M"){c=a[0][1];e=a[0][2];f=c;d=e;j++;b[Z](["M",c,e])}for(var p=a[m];j<p;j++){var q=b[j]=[],r=a[j];if(r[0]!=s.call(r[0])){q[0]=s.call(r[0]);switch(q[0]){case "a":q[1]=r[1];q[2]=r[2];q[3]=r[3];q[4]=r[4];q[5]=r[5];q[6]=+(r[6]-c).toFixed(3);q[7]=+(r[7]-e).toFixed(3);break;case "v":q[1]=+(r[1]-e).toFixed(3);break;case "m":f=r[1];d=r[2];default:for(var H=
1,K=r[m];H<K;H++)q[H]=+(r[H]-(H%2?c:e)).toFixed(3)}}else{b[j]=[];if(r[0]=="m"){f=r[1]+c;d=r[2]+e}q=0;for(H=r[m];q<H;q++)b[j][q]=r[q]}r=b[j][m];switch(b[j][0]){case "z":c=f;e=d;break;case "h":c+=+b[j][r-1];break;case "v":e+=+b[j][r-1];break;default:c+=+b[j][r-2];e+=+b[j][r-1]}}b[Y]=k._path2string;return b},0,Fa),za=R(function(a){if(!k.is(a,O)||!k.is(a&&a[0],O))a=k.parsePathString(a);var b=[],c=0,e=0,f=0,d=0,j=0;if(a[0][0]=="M"){c=+a[0][1];e=+a[0][2];f=c;d=e;j++;b[0]=["M",c,e]}for(var p=a[m];j<p;j++){var q=
b[j]=[],r=a[j];if(r[0]!=va.call(r[0])){q[0]=va.call(r[0]);switch(q[0]){case "A":q[1]=r[1];q[2]=r[2];q[3]=r[3];q[4]=r[4];q[5]=r[5];q[6]=+(r[6]+c);q[7]=+(r[7]+e);break;case "V":q[1]=+r[1]+e;break;case "H":q[1]=+r[1]+c;break;case "M":f=+r[1]+c;d=+r[2]+e;default:for(var H=1,K=r[m];H<K;H++)q[H]=+r[H]+(H%2?c:e)}}else{H=0;for(K=r[m];H<K;H++)b[j][H]=r[H]}switch(q[0]){case "Z":c=f;e=d;break;case "H":c=q[1];break;case "V":e=q[1];break;case "M":f=b[j][b[j][m]-2];d=b[j][b[j][m]-1];default:c=b[j][b[j][m]-2];e=
b[j][b[j][m]-1]}}b[Y]=k._path2string;return b},null,Fa),$a=function(a,b,c,e,f,d){var j=1/3,p=2/3;return[j*a+p*c,j*b+p*e,j*f+p*c,j*d+p*e,f,d]},ab=function(a,b,c,e,f,d,j,p,q,r){var H=C*120/180,K=C/180*(+f||0),L=[],Q,ba=R(function(na,oa,la){var xa=na*E.cos(la)-oa*E.sin(la);na=na*E.sin(la)+oa*E.cos(la);return{x:xa,y:na}});if(r){X=r[0];Q=r[1];d=r[2];N=r[3]}else{Q=ba(a,b,-K);a=Q.x;b=Q.y;Q=ba(p,q,-K);p=Q.x;q=Q.y;E.cos(C/180*f);E.sin(C/180*f);Q=(a-p)/2;X=(b-q)/2;N=Q*Q/(c*c)+X*X/(e*e);if(N>1){N=E.sqrt(N);
c*=N;e*=N}N=c*c;var S=e*e;N=(d==j?-1:1)*E.sqrt(o((N*S-N*X*X-S*Q*Q)/(N*X*X+S*Q*Q)));d=N*c*X/e+(a+p)/2;var N=N*-e*Q/c+(b+q)/2,X=E.asin(((b-N)/e).toFixed(9));Q=E.asin(((q-N)/e).toFixed(9));X=a<d?C-X:X;Q=p<d?C-Q:Q;X<0&&(X=C*2+X);Q<0&&(Q=C*2+Q);j&&X>Q&&(X-=C*2);!j&&Q>X&&(Q-=C*2)}if(o(Q-X)>H){L=Q;S=p;var ia=q;Q=X+H*(j&&Q>X?1:-1);p=d+c*E.cos(Q);q=N+e*E.sin(Q);L=ab(p,q,c,e,f,0,j,S,ia,[Q,L,d,N])}d=Q-X;f=E.cos(X);H=E.sin(X);j=E.cos(Q);Q=E.sin(Q);d=E.tan(d/4);c=4/3*c*d;d*=4/3*e;e=[a,b];a=[a+c*H,b-d*f];b=[p+
c*Q,q-d*j];p=[p,q];a[0]=2*e[0]-a[0];a[1]=2*e[1]-a[1];if(r)return[a,b,p].concat(L);L=[a,b,p].concat(L)[A]().split(",");r=[];p=0;for(q=L[m];p<q;p++)r[p]=p%2?ba(L[p-1],L[p],K).y:ba(L[p],L[p+1],K).x;return r},Ia=function(a,b,c,e,f,d,j,p,q){var r=1-q;return{x:v(r,3)*a+v(r,2)*3*q*c+r*3*q*q*f+v(q,3)*j,y:v(r,3)*b+v(r,2)*3*q*e+r*3*q*q*d+v(q,3)*p}},Bb=R(function(a,b,c,e,f,d,j,p){var q=f-2*c+a-(j-2*f+c),r=2*(c-a)-2*(f-c),H=a-c,K=(-r+E.sqrt(r*r-4*q*H))/2/q;q=(-r-E.sqrt(r*r-4*q*H))/2/q;var L=[b,p],Q=[a,j];o(K)>
"1e12"&&(K=0.5);o(q)>"1e12"&&(q=0.5);if(K>0&&K<1){K=Ia(a,b,c,e,f,d,j,p,K);Q[Z](K.x);L[Z](K.y)}if(q>0&&q<1){K=Ia(a,b,c,e,f,d,j,p,q);Q[Z](K.x);L[Z](K.y)}q=d-2*e+b-(p-2*d+e);r=2*(e-b)-2*(d-e);H=b-e;K=(-r+E.sqrt(r*r-4*q*H))/2/q;q=(-r-E.sqrt(r*r-4*q*H))/2/q;o(K)>"1e12"&&(K=0.5);o(q)>"1e12"&&(q=0.5);if(K>0&&K<1){K=Ia(a,b,c,e,f,d,j,p,K);Q[Z](K.x);L[Z](K.y)}if(q>0&&q<1){K=Ia(a,b,c,e,f,d,j,p,q);Q[Z](K.x);L[Z](K.y)}return{min:{x:h[I](0,Q),y:h[I](0,L)},max:{x:G[I](0,Q),y:G[I](0,L)}}}),Ga=R(function(a,b){var c=
za(a),e=b&&za(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},d={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},j=function(S,N){var X,ia;if(!S)return["C",N.x,N.y,N.x,N.y,N.x,N.y];!(S[0]in{T:1,Q:1})&&(N.qx=N.qy=null);switch(S[0]){case "M":N.X=S[1];N.Y=S[2];break;case "A":S=["C"].concat(ab[I](0,[N.x,N.y].concat(S.slice(1))));break;case "S":X=N.x+(N.x-(N.bx||N.x));ia=N.y+(N.y-(N.by||N.y));S=["C",X,ia].concat(S.slice(1));break;case "T":N.qx=N.x+(N.x-(N.qx||N.x));N.qy=N.y+(N.y-(N.qy||N.y));S=["C"].concat($a(N.x,
N.y,N.qx,N.qy,S[1],S[2]));break;case "Q":N.qx=S[1];N.qy=S[2];S=["C"].concat($a(N.x,N.y,S[1],S[2],S[3],S[4]));break;case "L":S=["C"].concat([N.x,N.y,S[1],S[2],S[1],S[2]]);break;case "H":S=["C"].concat([N.x,N.y,S[1],N.y,S[1],N.y]);break;case "V":S=["C"].concat([N.x,N.y,N.x,S[1],N.x,S[1]]);break;case "Z":S=["C"].concat([N.x,N.y,N.X,N.Y,N.X,N.Y])}return S},p=function(S,N){if(S[N][m]>7){S[N].shift();for(var X=S[N];X[m];)S.splice(N++,0,["C"].concat(X.splice(0,6)));S.splice(N,1);H=G(c[m],e&&e[m]||0)}},q=
function(S,N,X,ia,na){if(S&&N&&S[na][0]=="M"&&N[na][0]!="M"){N.splice(na,0,["M",ia.x,ia.y]);X.bx=0;X.by=0;X.x=S[na][1];X.y=S[na][2];H=G(c[m],e&&e[m]||0)}},r=0,H=G(c[m],e&&e[m]||0);for(;r<H;r++){c[r]=j(c[r],f);p(c,r);e&&(e[r]=j(e[r],d));e&&p(e,r);q(c,e,f,d,r);q(e,c,d,f,r);var K=c[r],L=e&&e[r],Q=K[m],ba=e&&L[m];f.x=K[Q-2];f.y=K[Q-1];f.bx=V(K[Q-4])||f.x;f.by=V(K[Q-3])||f.y;d.bx=e&&(V(L[ba-4])||d.x);d.by=e&&(V(L[ba-3])||d.y);d.x=e&&L[ba-2];d.y=e&&L[ba-1]}return e?[c,e]:c},null,Fa),bb=R(function(a){for(var b=
[],c=0,e=a[m];c<e;c++){var f={},d=a[c].match(/^([^:]*):?([\d\.]*)/);f.color=k.getRGB(d[1]);if(f.color.error)return null;f.color=f.color.hex;d[2]&&(f.offset=d[2]+"%");b[Z](f)}c=1;for(e=b[m]-1;c<e;c++)if(!b[c].offset){a=V(b[c-1].offset||0);d=0;for(f=c+1;f<e;f++)if(b[f].offset){d=b[f].offset;break}if(!d){d=100;f=e}d=V(d);for(d=(d-a)/(f-c+1);c<f;c++){a+=d;b[c].offset=a+"%"}}return b}),cb=function(a,b,c,e){if(k.is(a,"string")||k.is(a,"object")){a=k.is(a,"string")?l.getElementById(a):a;if(a.tagName)return b==
null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:b,height:c}}else return{container:1,x:a,y:b,width:c,height:e}},Qa=function(a,b){var c=this,e;for(e in b)if(b[i](e)&&!(e in a))switch(typeof b[e]){case "function":(function(f){a[e]=a===c?f:function(){return f[I](c,arguments)}})(b[e]);break;case "object":a[e]=a[e]||{};Qa.call(this,a[e],b[e]);break;default:a[e]=b[e]}},ya=function(a,b){a==b.top&&(b.top=a.prev);a==b.bottom&&(b.bottom=
a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},db=function(a,b){if(b.top!==a){ya(a,b);a.next=null;a.prev=b.top;b.top.next=a;b.top=a}},eb=function(a,b){if(b.bottom!==a){ya(a,b);a.next=b.bottom;a.prev=null;b.bottom.prev=a;b.bottom=a}},fb=function(a,b,c){ya(a,c);b==c.top&&(c.top=a);b.next&&(b.next.prev=a);a.next=b.next;a.prev=b;b.next=a},gb=function(a,b,c){ya(a,c);b==c.bottom&&(c.bottom=a);b.prev&&(b.prev.next=a);a.prev=b.prev;b.prev=a;a.next=b},hb=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+
a+"\u201d of removed object");}};k.pathToRelative=Pa;if(k.svg){F.svgns="http://www.w3.org/2000/svg";F.xlink="http://www.w3.org/1999/xlink";$=function(a){return+a+(~~a===a)*0.5};var aa=function(a,b){if(b)for(var c in b)b[i](c)&&a.setAttribute(c,z(b[c]));else{a=l.createElementNS(F.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};k[Y]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var ib=function(a,b){var c=aa("path");b.canvas&&b.canvas.appendChild(c);
c=new ga(c,b);c.type="path";wa(c,{fill:"none",stroke:"#000",path:a});return c},Aa=function(a,b,c){var e="linear",f=0.5,d=0.5,j=a.style;b=z(b).replace(Ya,function(H,K,L){e="radial";if(K&&L){f=V(K);d=V(L);H=(d>0.5)*2-1;v(f-0.5,2)+v(d-0.5,2)>0.25&&(d=E.sqrt(0.25-v(f-0.5,2))*H+0.5)&&d!=0.5&&(d=d.toFixed(5)-1.0E-5*H)}return""});b=b.split(/\s*\-\s*/);if(e=="linear"){var p=b.shift();p=-V(p);if(isNaN(p))return null;p=[0,0,E.cos(p*C/180),E.sin(p*C/180)];var q=1/(G(o(p[2]),o(p[3]))||1);p[2]*=q;p[3]*=q;if(p[2]<
0){p[0]=-p[2];p[2]=0}if(p[3]<0){p[1]=-p[3];p[3]=0}}b=bb(b);if(!b)return null;q=a.getAttribute("fill");(q=q.match(/^url\(#(.*)\)$/))&&c.defs.removeChild(l.getElementById(q[1]));q=aa(e+"Gradient");q.id=P();aa(q,e=="radial"?{fx:f,fy:d}:{x1:p[0],y1:p[1],x2:p[2],y2:p[3]});c.defs.appendChild(q);c=0;for(p=b[m];c<p;c++){var r=aa("stop");aa(r,{offset:b[c].offset?b[c].offset:c?"100%":"0%","stop-color":b[c].color||"#fff"});q.appendChild(r)}aa(a,{fill:"url(#"+q.id+")",opacity:1,"fill-opacity":1});j.fill="";j.opacity=
1;return j.fillOpacity=1},Ra=function(a){var b=a.getBBox();aa(a.pattern,{patternTransform:k.format("translate({0},{1})",b.x,b.y)})},wa=function(a,b){var c={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},e=a.node,f=a.attrs,d=a.rotate(),j=function(ba,S){if(S=c[s.call(S)]){for(var N=ba.attrs["stroke-width"]||"1",X={round:N,square:N,butt:0}[ba.attrs["stroke-linecap"]||b["stroke-linecap"]]||0,
ia=[],na=S[m];na--;)ia[na]=S[na]*N+(na%2?1:-1)*X;aa(e,{"stroke-dasharray":ia[A](",")})}};b[i]("rotation")&&(d=b.rotation);var p=z(d).split(B);if(p.length-1){p[1]=+p[1];p[2]=+p[2]}else p=null;V(d)&&a.rotate(0,true);for(var q in b)if(b[i](q))if(Da[i](q)){var r=b[q];f[q]=r;switch(q){case "blur":a.blur(r);break;case "rotation":a.rotate(r,true);break;case "href":case "title":case "target":var H=e.parentNode;if(s.call(H.tagName)!="a"){var K=aa("a");H.insertBefore(K,e);K.appendChild(e);H=K}q=="target"&&
r=="blank"?H.setAttributeNS(a.paper.xlink,"show","new"):H.setAttributeNS(a.paper.xlink,q,r);break;case "cursor":e.style.cursor=r;break;case "clip-rect":H=z(r).split(B);if(H[m]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var L=aa("clipPath");K=aa("rect");L.id=P();aa(K,{x:H[0],y:H[1],width:H[2],height:H[3]});L.appendChild(K);a.paper.defs.appendChild(L);aa(e,{"clip-path":"url(#"+L.id+")"});a.clip=K}if(!r){(r=l.getElementById(e.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,
"")))&&r.parentNode.removeChild(r);aa(e,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&aa(e,{d:r?f.path=za(r):"M0,0"});break;case "width":e.setAttribute(q,r);if(f.fx){q="x";r=f.x}else break;case "x":f.fx&&(r=-f.x-(f.width||0));case "rx":if(q=="rx"&&a.type=="rect")break;case "cx":p&&(q=="x"||q=="cx")&&(p[1]+=r-f[q]);e.setAttribute(q,r);a.pattern&&Ra(a);break;case "height":e.setAttribute(q,r);if(f.fy){q="y";r=f.y}else break;case "y":f.fy&&(r=-f.y-(f.height||0));case "ry":if(q=="ry"&&
a.type=="rect")break;case "cy":p&&(q=="y"||q=="cy")&&(p[2]+=r-f[q]);e.setAttribute(q,r);a.pattern&&Ra(a);break;case "r":a.type=="rect"?aa(e,{rx:r,ry:r}):e.setAttribute(q,r);break;case "src":a.type=="image"&&e.setAttributeNS(a.paper.xlink,"href",r);break;case "stroke-width":e.style.strokeWidth=r;e.setAttribute(q,r);f["stroke-dasharray"]&&j(a,f["stroke-dasharray"]);break;case "stroke-dasharray":j(a,r);break;case "translation":r=z(r).split(B);r[0]=+r[0]||0;r[1]=+r[1]||0;if(p){p[1]+=r[0];p[2]+=r[1]}Ja.call(a,
r[0],r[1]);break;case "scale":r=z(r).split(B);a.scale(+r[0]||1,+r[1]||+r[0]||1,isNaN(V(r[2]))?null:+r[2],isNaN(V(r[3]))?null:+r[3]);break;case "fill":if(H=z(r).match(ca)){L=aa("pattern");var Q=aa("image");L.id=P();aa(L,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});aa(Q,{x:0,y:0});Q.setAttributeNS(a.paper.xlink,"href",H[1]);L.appendChild(Q);r=l.createElement("img");r.style.cssText="position:absolute;left:-9999em;top-9999em";r.onload=function(){aa(L,{width:this.offsetWidth,height:this.offsetHeight});
aa(Q,{width:this.offsetWidth,height:this.offsetHeight});l.body.removeChild(this);a.paper.safari()};l.body.appendChild(r);r.src=H[1];a.paper.defs.appendChild(L);e.style.fill="url(#"+L.id+")";aa(e,{fill:"url(#"+L.id+")"});a.pattern=L;a.pattern&&Ra(a);break}H=k.getRGB(r);if(H.error)if(({circle:1,ellipse:1}[i](a.type)||z(r).charAt()!="r")&&Aa(e,r,a.paper)){f.gradient=r;f.fill="none";break}else{delete b.gradient;delete f.gradient;!k.is(f.opacity,"undefined")&&k.is(b.opacity,"undefined")&&aa(e,{opacity:f.opacity});
!k.is(f["fill-opacity"],"undefined")&&k.is(b["fill-opacity"],"undefined")&&aa(e,{"fill-opacity":f["fill-opacity"]})}H[i]("opacity")&&aa(e,{"fill-opacity":H.opacity>1?H.opacity/100:H.opacity});case "stroke":H=k.getRGB(r);e.setAttribute(q,H.hex);q=="stroke"&&H[i]("opacity")&&aa(e,{"stroke-opacity":H.opacity>1?H.opacity/100:H.opacity});break;case "gradient":(({circle:1,ellipse:1})[i](a.type)||z(r).charAt()!="r")&&Aa(e,r,a.paper);break;case "opacity":f.gradient&&!f[i]("stroke-opacity")&&aa(e,{"stroke-opacity":r>
1?r/100:r});case "fill-opacity":if(f.gradient){if(H=l.getElementById(e.getAttribute("fill").replace(/^url\(#|\)$/g,""))){H=H.getElementsByTagName("stop");H[H[m]-1].setAttribute("stop-opacity",r)}break}default:q=="font-size"&&(r=ma(r,10)+"px");H=q.replace(/(\-.)/g,function(ba){return va.call(ba.substring(1))});e.style[H]=r;e.setAttribute(q,r)}}Cb(a,b);p?a.rotate(p.join(W)):V(d)&&a.rotate(d,true)},Cb=function(a,b){if(!(a.type!="text"||!(b[i]("text")||b[i]("font")||b[i]("font-size")||b[i]("x")||b[i]("y")))){var c=
a.attrs,e=a.node,f=e.firstChild?ma(l.defaultView.getComputedStyle(e.firstChild,"").getPropertyValue("font-size"),10):10;if(b[i]("text")){for(c.text=b.text;e.firstChild;)e.removeChild(e.firstChild);for(var d=z(b.text).split("\n"),j=0,p=d[m];j<p;j++)if(d[j]){var q=aa("tspan");j&&aa(q,{dy:f*1.2,x:c.x});q.appendChild(l.createTextNode(d[j]));e.appendChild(q)}}else{d=e.getElementsByTagName("tspan");j=0;for(p=d[m];j<p;j++)j&&aa(d[j],{dy:f*1.2,x:c.x})}aa(e,{y:c.y});f=a.getBBox();(f=c.y-(f.y+f.height/2))&&
k.is(f,"finite")&&aa(e,{y:c.y+f})}},ga=function(a,b){this[0]=a;this.id=k._oid++;this.node=a;a.raphael=this;this.paper=b;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!b.bottom&&(b.bottom=this);(this.prev=b.top)&&(b.top.next=this);b.top=this;this.next=null},fa=ga[y];ga[y].rotate=function(a,b,c){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][A](W);return this._.rt.deg}var e=this.getBBox();
a=z(a).split(B);if(a[m]-1){b=V(a[1]);c=V(a[2])}a=V(a[0]);b!=null&&b!==false?this._.rt.deg=a:this._.rt.deg+=a;c==null&&(b=null);this._.rt.cx=b;this._.rt.cy=c;b=b==null?e.x+e.width/2:b;c=c==null?e.y+e.height/2:c;if(this._.rt.deg){this.transformations[0]=k.format("rotate({0} {1} {2})",this._.rt.deg,b,c);this.clip&&aa(this.clip,{transform:k.format("rotate({0} {1} {2})",-this._.rt.deg,b,c)})}else{this.transformations[0]="";this.clip&&aa(this.clip,{transform:""})}aa(this.node,{transform:this.transformations[A](W)});
return this};ga[y].hide=function(){!this.removed&&(this.node.style.display="none");return this};ga[y].show=function(){!this.removed&&(this.node.style.display="");return this};ga[y].remove=function(){if(!this.removed){ya(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ga[y].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ha(this.attrs.path);if(this.node.style.display=="none"){this.show();var a=true}var b={};
try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}if(this.type=="text"){b={x:b.x,y:Infinity,width:0,height:0};for(var e=0,f=this.node.getNumberOfChars();e<f;e++){var d=this.node.getExtentOfChar(e);d.y<b.y&&(b.y=d.y);d.y+d.height-b.y>b.height&&(b.height=d.y+d.height-b.y);d.x+d.width-b.x>b.width&&(b.width=d.x+d.width-b.x)}}a&&this.hide();return b};ga[y].attr=function(a,b){if(this.removed)return this;if(a==null){var c={},e;for(e in this.attrs)this.attrs[i](e)&&(c[e]=this.attrs[e]);this._.rt.deg&&(c.rotation=
this.rotate());(this._.sx!=1||this._.sy!=1)&&(c.scale=this.scale());c.gradient&&c.fill=="none"&&(c.fill=c.gradient)&&delete c.gradient;return c}if(b==null&&k.is(a,"string")){if(a=="translation")return Ja.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(b==null&&k.is(a,O)){e={};c=0;for(var f=a.length;c<f;c++)e[a[c]]=this.attr(a[c]);return e}if(b!=null){c={};
c[a]=b}else a!=null&&k.is(a,"object")&&(c=a);for(f in this.paper.customAttributes)if(this.paper.customAttributes[i](f)&&c[i](f)&&k.is(this.paper.customAttributes[f],"function")){e=this.paper.customAttributes[f].apply(this,[].concat(c[f]));this.attrs[f]=c[f];for(var d in e)e[i](d)&&(c[d]=e[d])}wa(this,c);return this};ga[y].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&db(this,a);return this};ga[y].toBack=function(){if(this.removed)return this;
if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);eb(this,this.paper)}return this};ga[y].insertAfter=function(a){if(this.removed)return this;var b=a.node||a[a.length-1].node;b.nextSibling?b.parentNode.insertBefore(this.node,b.nextSibling):b.parentNode.appendChild(this.node);fb(this,a,this.paper);return this};ga[y].insertBefore=function(a){if(this.removed)return this;var b=a.node||a[0].node;b.parentNode.insertBefore(this.node,
b);gb(this,a,this.paper);return this};ga[y].blur=function(a){if(+a!==0){var b=aa("filter"),c=aa("feGaussianBlur");this.attrs.blur=a;b.id=P();aa(c,{stdDeviation:+a||1.5});b.appendChild(c);this.paper.defs.appendChild(b);this._blur=b;aa(this.node,{filter:"url(#"+b.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var jb=function(a,b,c,e){var f=aa("circle");a.canvas&&a.canvas.appendChild(f);a=new ga(f,
a);a.attrs={cx:b,cy:c,r:e,fill:"none",stroke:"#000"};a.type="circle";aa(f,a.attrs);return a},kb=function(a,b,c,e,f,d){var j=aa("rect");a.canvas&&a.canvas.appendChild(j);a=new ga(j,a);a.attrs={x:b,y:c,width:e,height:f,r:d||0,rx:d||0,ry:d||0,fill:"none",stroke:"#000"};a.type="rect";aa(j,a.attrs);return a},lb=function(a,b,c,e,f){var d=aa("ellipse");a.canvas&&a.canvas.appendChild(d);a=new ga(d,a);a.attrs={cx:b,cy:c,rx:e,ry:f,fill:"none",stroke:"#000"};a.type="ellipse";aa(d,a.attrs);return a},mb=function(a,
b,c,e,f,d){var j=aa("image");aa(j,{x:c,y:e,width:f,height:d,preserveAspectRatio:"none"});j.setAttributeNS(a.xlink,"href",b);a.canvas&&a.canvas.appendChild(j);a=new ga(j,a);a.attrs={x:c,y:e,width:f,height:d,src:b};a.type="image";return a},nb=function(a,b,c,e){var f=aa("text");aa(f,{x:b,y:c,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(f);a=new ga(f,a);a.attrs={x:b,y:c,"text-anchor":"middle",text:e,font:Da.font,stroke:"none",fill:"#000"};a.type="text";wa(a,a.attrs);return a},ob=function(a,
b){this.width=a||this.width;this.height=b||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Ma=function(){var a=cb[I](0,arguments),b=a&&a.container,c=a.x,e=a.y,f=a.width;a=a.height;if(!b)throw Error("SVG container not found.");var d=aa("svg");c=c||0;e=e||0;f=f||512;a=a||342;aa(d,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:f,height:a});if(b==1){d.style.cssText="position:absolute;left:"+c+"px;top:"+e+"px";l.body.appendChild(d)}else b.firstChild?
b.insertBefore(d,b.firstChild):b.appendChild(d);b=new n;b.width=f;b.height=a;b.canvas=d;Qa.call(b,b,k.fn);b.clear();return b};F.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=aa("desc")).appendChild(l.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=aa("defs"))};F.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=hb(a)}}if(k.vml){var pb=
{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Db=/([clmz]),?([^clmz]*)/gi,Eb=/ progid:\S+Blur\([^\)]+\)/g,Fb=/-?[^,\s-]+/g,Ba=1E3+W+1E3,Ca={path:1,rect:1},Gb=function(a){var b=/[ahqstv]/ig,c=za;z(a).match(b)&&(c=Ga);b=/[clmz]/g;if(c==za&&!z(a).match(b))return a=z(a).replace(Db,function(q,r,H){var K=[],L=s.call(r)=="m",Q=pb[r];H.replace(Fb,function(ba){if(L&&K[m]==2){Q+=K+pb[r=="m"?"l":"L"];K=[]}K[Z]($(ba*10))});return Q+K});b=c(a);var e;a=[];for(var f=0,d=b[m];f<d;f++){c=b[f];e=s.call(b[f][0]);
e=="z"&&(e="x");for(var j=1,p=c[m];j<p;j++)e+=$(c[j]*10)+(j!=p-1?",":"");a[Z](e)}return a[A](W)};k[Y]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};ib=function(a,b){var c=pa("group");c.style.cssText="position:absolute;left:0;top:0;width:"+b.width+"px;height:"+b.height+"px";c.coordsize=b.coordsize;c.coordorigin=b.coordorigin;var e=pa("shape"),f=e.style;f.width=b.width+"px";f.height=b.height+"px";e.coordsize=Ba;e.coordorigin=
b.coordorigin;c.appendChild(e);e=new ga(e,c,b);f={fill:"none",stroke:"#000"};a&&(f.path=a);e.type="path";e.path=[];e.Path="";wa(e,f);b.canvas.appendChild(c);return e};wa=function(a,b){a.attrs=a.attrs||{};var c=a.node,e=a.attrs,f=c.style,d;d=(b.x!=e.x||b.y!=e.y||b.width!=e.width||b.height!=e.height||b.r!=e.r)&&a.type=="rect";for(var j in b)b[i](j)&&(e[j]=b[j]);if(d){e.path=qb(e.x,e.y,e.width,e.height,e.r);a.X=e.x;a.Y=e.y;a.W=e.width;a.H=e.height}b.href&&(c.href=b.href);b.title&&(c.title=b.title);b.target&&
(c.target=b.target);b.cursor&&(f.cursor=b.cursor);"blur"in b&&a.blur(b.blur);if(b.path&&a.type=="path"||d)c.path=Gb(e.path);b.rotation!=null&&a.rotate(b.rotation,true);if(b.translation){d=z(b.translation).split(B);Ja.call(a,d[0],d[1]);if(a._.rt.cx!=null){a._.rt.cx+=+d[0];a._.rt.cy+=+d[1];a.setBox(a.attrs,d[0],d[1])}}if(b.scale){d=z(b.scale).split(B);a.scale(+d[0]||1,+d[1]||+d[0]||1,+d[2]||null,+d[3]||null)}if("clip-rect"in b){d=z(b["clip-rect"]).split(B);if(d[m]==4){d[2]=+d[2]+ +d[0];d[3]=+d[3]+ +d[1];
j=c.clipRect||l.createElement("div");var p=j.style,q=c.parentNode;p.clip=k.format("rect({1}px {2}px {3}px {0}px)",d);if(!c.clipRect){p.position="absolute";p.top=0;p.left=0;p.width=a.paper.width+"px";p.height=a.paper.height+"px";q.parentNode.insertBefore(j,q);j.appendChild(q);c.clipRect=j}}b["clip-rect"]||c.clipRect&&(c.clipRect.style.clip="")}a.type=="image"&&b.src&&(c.src=b.src);if(a.type=="image"&&b.opacity){c.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+b.opacity*100+")";f.filter=
(c.filterMatrix||"")+(c.filterOpacity||"")}b.font&&(f.font=b.font);b["font-family"]&&(f.fontFamily='"'+b["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');b["font-size"]&&(f.fontSize=b["font-size"]);b["font-weight"]&&(f.fontWeight=b["font-weight"]);b["font-style"]&&(f.fontStyle=b["font-style"]);if(b.opacity!=null||b["stroke-width"]!=null||b.fill!=null||b.stroke!=null||b["stroke-width"]!=null||b["stroke-opacity"]!=null||b["fill-opacity"]!=null||b["stroke-dasharray"]!=null||b["stroke-miterlimit"]!=
null||b["stroke-linejoin"]!=null||b["stroke-linecap"]!=null){c=a.shape||c;d=c.getElementsByTagName("fill")&&c.getElementsByTagName("fill")[0];j=false;!d&&(j=d=pa("fill"));if("fill-opacity"in b||"opacity"in b){f=((+e["fill-opacity"]+1||2)-1)*((+e.opacity+1||2)-1)*((+k.getRGB(b.fill).o+1||2)-1);f=h(G(f,0),1);d.opacity=f}b.fill&&(d.on=true);if(d.on==null||b.fill=="none")d.on=false;if(d.on&&b.fill)if(f=b.fill.match(ca)){d.src=f[1];d.type="tile"}else{d.color=k.getRGB(b.fill).hex;d.src="";d.type="solid";
if(k.getRGB(b.fill).error&&(a.type in{circle:1,ellipse:1}||z(b.fill).charAt()!="r")&&Aa(a,b.fill)){e.fill="none";e.gradient=b.fill}}j&&c.appendChild(d);d=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0];j=false;!d&&(j=d=pa("stroke"));if(b.stroke&&b.stroke!="none"||b["stroke-width"]||b["stroke-opacity"]!=null||b["stroke-dasharray"]||b["stroke-miterlimit"]||b["stroke-linejoin"]||b["stroke-linecap"])d.on=true;(b.stroke=="none"||d.on==null||b.stroke==0||b["stroke-width"]==0)&&(d.on=
false);f=k.getRGB(b.stroke);d.on&&b.stroke&&(d.color=f.hex);f=((+e["stroke-opacity"]+1||2)-1)*((+e.opacity+1||2)-1)*((+f.o+1||2)-1);p=(V(b["stroke-width"])||1)*0.75;f=h(G(f,0),1);b["stroke-width"]==null&&(p=e["stroke-width"]);b["stroke-width"]&&(d.weight=p);p&&p<1&&(f*=p)&&(d.weight=1);d.opacity=f;b["stroke-linejoin"]&&(d.joinstyle=b["stroke-linejoin"]||"miter");d.miterlimit=b["stroke-miterlimit"]||8;b["stroke-linecap"]&&(d.endcap=b["stroke-linecap"]=="butt"?"flat":b["stroke-linecap"]=="square"?"square":
"round");if(b["stroke-dasharray"]){f={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};d.dashstyle=f[i](b["stroke-dasharray"])?f[b["stroke-dasharray"]]:""}j&&c.appendChild(d)}if(a.type=="text"){f=a.paper.span.style;e.font&&(f.font=e.font);e["font-family"]&&(f.fontFamily=e["font-family"]);e["font-size"]&&(f.fontSize=e["font-size"]);e["font-weight"]&&(f.fontWeight=e["font-weight"]);
e["font-style"]&&(f.fontStyle=e["font-style"]);a.node.string&&(a.paper.span.innerHTML=z(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=e.w=a.paper.span.offsetWidth;a.H=e.h=a.paper.span.offsetHeight;a.X=e.x;a.Y=e.y+$(a.H/2);switch(e["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=$(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-$(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Aa=function(a,b){a.attrs=
a.attrs||{};var c,e="linear",f=".5 .5";a.attrs.gradient=b;b=z(b).replace(Ya,function(H,K,L){e="radial";if(K&&L){K=V(K);L=V(L);v(K-0.5,2)+v(L-0.5,2)>0.25&&(L=E.sqrt(0.25-v(K-0.5,2))*((L>0.5)*2-1)+0.5);f=K+W+L}return""});b=b.split(/\s*\-\s*/);if(e=="linear"){var d=b.shift();d=-V(d);if(isNaN(d))return null}var j=bb(b);if(!j)return null;a=a.shape||a.node;c=a.getElementsByTagName("fill")[0]||pa("fill");!c.parentNode&&a.appendChild(c);if(j[m]){c.on=true;c.method="none";c.color=j[0].color;c.color2=j[j[m]-
1].color;for(var p=[],q=0,r=j[m];q<r;q++)j[q].offset&&p[Z](j[q].offset+W+j[q].color);c.colors&&(c.colors.value=p[m]?p[A]():"0% "+c.color);if(e=="radial"){c.type="gradientradial";c.focus="100%";c.focussize=f;c.focusposition=f}else{c.type="gradient";c.angle=(270-d)%360}}return 1};ga=function(a,b,c){this[0]=a;this.id=k._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=b;this.paper=c;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=
this);c.top=this;this.next=null};fa=ga[y];fa.rotate=function(a,b,c){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][A](W);return this._.rt.deg}a=z(a).split(B);if(a[m]-1){b=V(a[1]);c=V(a[2])}a=V(a[0]);b!=null?this._.rt.deg=a:this._.rt.deg+=a;c==null&&(b=null);this._.rt.cx=b;this._.rt.cy=c;this.setBox(this.attrs,b,c);this.Group.style.rotation=this._.rt.deg;return this};fa.setBox=function(a,b,c){if(this.removed)return this;var e=this.Group.style,
f=this.shape&&this.shape.style||this.node.style;a=a||{};for(var d in a)a[i](d)&&(this.attrs[d]=a[d]);b=b||this._.rt.cx;c=c||this._.rt.cy;var j=this.attrs,p;switch(this.type){case "circle":a=j.cx-j.r;d=j.cy-j.r;p=j=j.r*2;break;case "ellipse":a=j.cx-j.rx;d=j.cy-j.ry;p=j.rx*2;j=j.ry*2;break;case "image":a=+j.x;d=+j.y;p=j.width||0;j=j.height||0;break;case "text":this.textpath.v=["m",$(j.x),", ",$(j.y-2),"l",$(j.x)+1,", ",$(j.y-2)][A]("");a=j.x-$(this.W/2);d=j.y-this.H/2;p=this.W;j=this.H;break;case "rect":case "path":if(this.attrs.path){j=
Ha(this.attrs.path);a=j.x;d=j.y;p=j.width;j=j.height}else{d=a=0;p=this.paper.width;j=this.paper.height}break;default:d=a=0;p=this.paper.width;j=this.paper.height}b=(b==null?a+p/2:b)-this.paper.width/2;c=(c==null?d+j/2:c)-this.paper.height/2;var q;e.left!=(q=b+"px")&&(e.left=q);e.top!=(q=c+"px")&&(e.top=q);this.X=Ca[i](this.type)?-b:a;this.Y=Ca[i](this.type)?-c:d;this.W=p;this.H=j;if(Ca[i](this.type)){f.left!=(q=-b*10+"px")&&(f.left=q);f.top!=(q=-c*10+"px")&&(f.top=q)}else if(this.type=="text"){f.left!=
(q=-b+"px")&&(f.left=q);f.top!=(q=-c+"px")&&(f.top=q)}else{e.width!=(q=this.paper.width+"px")&&(e.width=q);e.height!=(q=this.paper.height+"px")&&(e.height=q);f.left!=(q=a-b+"px")&&(f.left=q);f.top!=(q=d-c+"px")&&(f.top=q);f.width!=(q=p+"px")&&(f.width=q);f.height!=(q=j+"px")&&(f.height=q)}};fa.hide=function(){!this.removed&&(this.Group.style.display="none");return this};fa.show=function(){!this.removed&&(this.Group.style.display="block");return this};fa.getBBox=function(){if(this.removed)return this;
if(Ca[i](this.type))return Ha(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};fa.remove=function(){if(!this.removed){ya(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};fa.attr=function(a,b){if(this.removed)return this;if(a==null){var c={},e;for(e in this.attrs)this.attrs[i](e)&&(c[e]=this.attrs[e]);
this._.rt.deg&&(c.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(c.scale=this.scale());c.gradient&&c.fill=="none"&&(c.fill=c.gradient)&&delete c.gradient;return c}if(b==null&&k.is(a,"string")){if(a=="translation")return Ja.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&b==null&&k.is(a,O)){var f={};e=0;for(c=a[m];e<c;e++)f[a[e]]=this.attr(a[e]);
return f}if(b!=null){c={};c[a]=b}b==null&&k.is(a,"object")&&(c=a);if(c){for(f in this.paper.customAttributes)if(this.paper.customAttributes[i](f)&&c[i](f)&&k.is(this.paper.customAttributes[f],"function")){e=this.paper.customAttributes[f].apply(this,[].concat(c[f]));this.attrs[f]=c[f];for(var d in e)e[i](d)&&(c[d]=e[d])}c.text&&this.type=="text"&&(this.node.string=c.text);wa(this,c);c.gradient&&({circle:1,ellipse:1}[i](this.type)||z(c.gradient).charAt()!="r")&&Aa(this,c.gradient);(!Ca[i](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};fa.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&db(this,this.paper);return this};fa.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);eb(this,this.paper)}return this};fa.insertAfter=function(a){if(this.removed)return this;a.constructor==ra&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);fb(this,a,this.paper);return this};fa.insertBefore=function(a){if(this.removed)return this;a.constructor==ra&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);gb(this,a,this.paper);return this};fa.blur=function(a){var b=this.node.runtimeStyle,c=b.filter;c=c.replace(Eb,"");if(+a!==0){this.attrs.blur=a;b.filter=c+W+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
b.margin=k.format("-{0}px 0 0 -{0}px",$(+a||1.5))}else{b.filter=c;b.margin=0;delete this.attrs.blur}};jb=function(a,b,c,e){var f=pa("group"),d=pa("oval");f.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";f.coordsize=Ba;f.coordorigin=a.coordorigin;f.appendChild(d);d=new ga(d,f,a);d.type="circle";wa(d,{stroke:"#000",fill:"none"});d.attrs.cx=b;d.attrs.cy=c;d.attrs.r=e;d.setBox({x:b-e,y:c-e,width:e*2,height:e*2});a.canvas.appendChild(f);return d};var qb=function(a,
b,c,e,f){return f?k.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+f,b,c-f*2,f,-f,e-f*2,f*2-c,f*2-e):k.format("M{0},{1}l{2},0,0,{3},{4},0z",a,b,c,e,-c)};kb=function(a,b,c,e,f,d){var j=qb(b,c,e,f,d);a=a.path(j);var p=a.attrs;a.X=p.x=b;a.Y=p.y=c;a.W=p.width=e;a.H=p.height=f;p.r=d;p.path=j;a.type="rect";return a};lb=function(a,b,c,e,f){var d=pa("group"),j=pa("oval");d.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";d.coordsize=Ba;d.coordorigin=a.coordorigin;d.appendChild(j);j=new ga(j,d,a);j.type="ellipse";wa(j,{stroke:"#000"});j.attrs.cx=b;j.attrs.cy=c;j.attrs.rx=e;j.attrs.ry=f;j.setBox({x:b-e,y:c-f,width:e*2,height:f*2});a.canvas.appendChild(d);return j};mb=function(a,b,c,e,f,d){var j=pa("group"),p=pa("image");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Ba;j.coordorigin=a.coordorigin;p.src=b;j.appendChild(p);p=new ga(p,
j,a);p.type="image";p.attrs.src=b;p.attrs.x=c;p.attrs.y=e;p.attrs.w=f;p.attrs.h=d;p.setBox({x:c,y:e,width:f,height:d});a.canvas.appendChild(j);return p};nb=function(a,b,c,e){var f=pa("group"),d=pa("shape"),j=d.style,p=pa("path"),q=pa("textpath");f.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";f.coordsize=Ba;f.coordorigin=a.coordorigin;p.v=k.format("m{0},{1}l{2},{1}",$(b*10),$(c*10),$(b*10)+1);p.textpathok=true;j.width=a.width;j.height=a.height;q.string=z(e);
q.on=true;d.appendChild(q);d.appendChild(p);f.appendChild(d);j=new ga(q,f,a);j.shape=d;j.textpath=p;j.type="text";j.attrs.text=e;j.attrs.x=b;j.attrs.y=c;j.attrs.w=1;j.attrs.h=1;wa(j,{font:Da.font,stroke:"none",fill:"#000"});j.setBox();a.canvas.appendChild(f);return j};ob=function(a,b){var c=this.canvas.style;a==+a&&(a+="px");b==+b&&(b+="px");c.width=a;c.height=b;c.clip="rect(0 "+a+" "+b+" 0)";return this};var pa;l.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!l.namespaces.rvml&&
l.namespaces.add("rvml","urn:schemas-microsoft-com:vml");pa=function(a){return l.createElement("<rvml:"+a+' class="rvml">')}}catch(Nb){pa=function(a){return l.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Ma=function(){var a=cb[I](0,arguments),b=a.container,c=a.height,e=a.width,f=a.x;a=a.y;if(!b)throw Error("VML container not found.");var d=new n,j=d.canvas=l.createElement("div"),p=j.style;f=f||0;a=a||0;e=e||512;c=c||342;e==+e&&(e+="px");c==+c&&(c+="px");d.width=1E3;
d.height=1E3;d.coordsize=1E4+W+1E4;d.coordorigin="0 0";d.span=l.createElement("span");d.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";j.appendChild(d.span);p.cssText=k.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",e,c);if(b==1){l.body.appendChild(j);p.left=f+"px";p.top=a+"px";p.position="absolute"}else b.firstChild?b.insertBefore(j,b.firstChild):b.appendChild(j);
Qa.call(d,d,k.fn);return d};F.clear=function(){this.canvas.innerHTML="";this.span=l.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};F.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=hb(a);return true}}sa=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(sa&&sa[1]<
4||navigator.platform.slice(0,2)=="iP")?F.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});w.setTimeout(function(){a.remove()})}:F.safari=function(){};var Hb=function(){this.returnValue=false},Ib=function(){return this.originalEvent.preventDefault()},Jb=function(){this.cancelBubble=true},Kb=function(){return this.originalEvent.stopPropagation()},Lb=function(){if(l.addEventListener)return function(a,b,c,e){var f=T&&ha[b]?ha[b]:b,d=function(j){if(T&&ha[i](b))for(var p=
0,q=j.targetTouches&&j.targetTouches.length;p<q;p++)if(j.targetTouches[p].target==a){q=j;j=j.targetTouches[p];j.originalEvent=q;j.preventDefault=Ib;j.stopPropagation=Kb;break}return c.call(e,j)};a.addEventListener(f,d,false);return function(){a.removeEventListener(f,d,false);return true}};if(l.attachEvent)return function(a,b,c,e){var f=function(d){d=d||w.event;d.preventDefault=d.preventDefault||Hb;d.stopPropagation=d.stopPropagation||Jb;return c.call(e,d)};a.attachEvent("on"+b,f);return function(){a.detachEvent("on"+
b,f);return true}}}(),ta=[],Sa=function(a){for(var b=a.clientX,c=a.clientY,e=l.documentElement.scrollTop||l.body.scrollTop,f=l.documentElement.scrollLeft||l.body.scrollLeft,d,j=ta.length;j--;){d=ta[j];if(T)for(var p=a.touches.length,q;p--;){q=a.touches[p];if(q.identifier==d.el._drag.id){b=q.clientX;c=q.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();b+=f;c+=e;d.move&&d.move.call(d.move_scope||d.el,b-d.el._drag.x,c-d.el._drag.y,b,c,a)}},Ta=function(a){k.unmousemove(Sa).unmouseup(Ta);
for(var b=ta.length,c;b--;){c=ta[b];c.el._drag={};c.end&&c.end.call(c.end_scope||c.start_scope||c.move_scope||c.el,a)}ta=[]};for(sa=da[m];sa--;)(function(a){k[a]=ga[y][a]=function(b,c){if(k.is(b,"function")){this.events=this.events||[];this.events.push({name:a,f:b,unbind:Lb(this.shape||this.node||l,a,b,c||this)})}return this};k["un"+a]=ga[y]["un"+a]=function(b){for(var c=this.events,e=c[m];e--;)if(c[e].name==a&&c[e].f==b){c[e].unbind();c.splice(e,1);!c.length&&delete this.events;break}return this}})(da[sa]);
fa.hover=function(a,b,c,e){return this.mouseover(a,c).mouseout(b,e||c)};fa.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};fa.drag=function(a,b,c,e,f,d){this._drag={};this.mousedown(function(j){(j.originalEvent||j).preventDefault();var p=l.documentElement.scrollTop||l.body.scrollTop,q=l.documentElement.scrollLeft||l.body.scrollLeft;this._drag.x=j.clientX+q;this._drag.y=j.clientY+p;this._drag.id=j.identifier;b&&b.call(f||e||this,j.clientX+q,j.clientY+p,j);!ta.length&&k.mousemove(Sa).mouseup(Ta);
ta.push({el:this,move:a,end:c,move_scope:e,start_scope:f,end_scope:d})});return this};fa.undrag=function(a,b,c){for(b=ta.length;b--;)ta[b].el==this&&ta[b].move==a&&ta[b].end==c&&ta.splice(b++,1);!ta.length&&k.unmousemove(Sa).unmouseup(Ta)};F.circle=function(a,b,c){return jb(this,a||0,b||0,c||0)};F.rect=function(a,b,c,e,f){return kb(this,a||0,b||0,c||0,e||0,f||0)};F.ellipse=function(a,b,c,e){return lb(this,a||0,b||0,c||0,e||0)};F.path=function(a){a&&!k.is(a,"string")&&!k.is(a[0],O)&&(a+="");return ib(k.format[I](k,
arguments),this)};F.image=function(a,b,c,e,f){return mb(this,a||"about:blank",b||0,c||0,e||0,f||0)};F.text=function(a,b,c){return nb(this,a||0,b||0,z(c))};F.set=function(a){arguments[m]>1&&(a=Array[y].splice.call(arguments,0,arguments[m]));return new ra(a)};F.setSize=ob;F.top=F.bottom=null;F.raphael=k;fa.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};fa.scale=function(a,b,c,e){if(this.removed)return this;if(a==null&&b==null)return{x:this._.sx,y:this._.sy,
toString:J};b=b||a;!+b&&(b=a);var f,d,j=this.attrs;if(a!=0){var p=this.getBBox(),q=p.x+p.width/2,r=p.y+p.height/2;f=o(a/this._.sx);d=o(b/this._.sy);c=+c||c==0?c:q;e=+e||e==0?e:r;var H=this._.sx>0,K=this._.sy>0;p=~~(a/o(a));var L=~~(b/o(b)),Q=f*p,ba=d*L,S=this.node.style;q=c+o(q-c)*Q*(q>c==H?1:-1);r=e+o(r-e)*ba*(r>e==K?1:-1);var N=a*p>b*L?d:f;switch(this.type){case "rect":case "image":var X=j.width*f,ia=j.height*d;this.attr({height:ia,r:j.r*N,width:X,x:q-X/2,y:r-ia/2});break;case "circle":case "ellipse":this.attr({rx:j.rx*
f,ry:j.ry*d,r:j.r*N,cx:q,cy:r});break;case "text":this.attr({x:q,y:r});break;case "path":N=Pa(j.path);var na=true;H=H?Q:f;K=K?ba:d;ba=0;for(Q=N[m];ba<Q;ba++){var oa=N[ba],la=va.call(oa[0]);if(!(la=="M"&&na)){na=false;if(la=="A"){oa[N[ba][m]-2]*=H;oa[N[ba][m]-1]*=K;oa[1]*=f;oa[2]*=d;oa[5]=+(p+L?!!+oa[5]:!+oa[5])}else if(la=="H"){la=1;for(var xa=oa[m];la<xa;la++)oa[la]*=H}else if(la=="V"){la=1;for(xa=oa[m];la<xa;la++)oa[la]*=K}else{la=1;for(xa=oa[m];la<xa;la++)oa[la]*=la%2?H:K}}}d=Ha(N);f=q-d.x-d.width/
2;d=r-d.y-d.height/2;N[0][1]+=f;N[0][2]+=d;this.attr({path:N})}if(this.type in{text:1,image:1}&&(p!=1||L!=1))if(this.transformations){this.transformations[2]="scale(".concat(p,",",L,")");this.node.setAttribute("transform",this.transformations[A](W));f=p==-1?-j.x-(X||0):j.x;d=L==-1?-j.y-(ia||0):j.y;this.attr({x:f,y:d});j.fx=p-1;j.fy=L-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(p,", M12=0, M21=0, M22=",L,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
S.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[A](W));j.fx=0;j.fy=0}else{this.node.filterMatrix="";S.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}j.scale=[a,b,c,e][A](W);this._.sx=a;this._.sy=b}return this};fa.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Ua={},Ka=function(a,b,c,e,f,d,j,p,q){var r=0,H=100,K=[a,b,c,e,f,d,j,p].join(),L=Ua[K],Q,ba;!L&&(Ua[K]=L={data:[]});L.timer&&clearTimeout(L.timer);L.timer=setTimeout(function(){delete Ua[K]},2E3);if(q!=null)H=~~Ka(a,b,c,e,f,d,j,p)*10;for(var S=0;S<H+1;S++){if(L.data[q]>S)ba=L.data[S*H];else{ba=k.findDotsAtSegment(a,b,c,e,f,d,j,p,S/H);L.data[S]=ba}S&&(r+=v(v(Q.x-ba.x,2)+v(Q.y-ba.y,2),0.5));if(q!=null&&r>=q)return ba;Q=ba}if(q==null)return r};da=function(a,b){return function(c,e,f){c=Ga(c);for(var d,
j,p,q,r="",H={},K=0,L=0,Q=c.length;L<Q;L++){p=c[L];if(p[0]=="M"){d=+p[1];j=+p[2]}else{q=Ka(d,j,p[1],p[2],p[3],p[4],p[5],p[6]);if(K+q>e){if(b&&!H.start){d=Ka(d,j,p[1],p[2],p[3],p[4],p[5],p[6],e-K);r+=["C",d.start.x,d.start.y,d.m.x,d.m.y,d.x,d.y];if(f)return r;H.start=r;r=["M",d.x,d.y+"C",d.n.x,d.n.y,d.end.x,d.end.y,p[5],p[6]][A]();K+=q;d=+p[5];j=+p[6];continue}if(!a&&!b){d=Ka(d,j,p[1],p[2],p[3],p[4],p[5],p[6],e-K);return{x:d.x,y:d.y,alpha:d.alpha}}}K+=q;d=+p[5];j=+p[6]}r+=p}H.end=r;d=a?K:b?H:k.findDotsAtSegment(d,
j,p[1],p[2],p[3],p[4],p[5],p[6],1);d.alpha&&(d={x:d.x,y:d.y,alpha:d.alpha});return d}};var rb=da(1),La=da(),Va=da(0,1);fa.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return rb(this.attrs.path)}};fa.getPointAtLength=function(a){if(this.type=="path")return La(this.attrs.path,a)};fa.getSubpath=function(a,b){if(this.type=="path"){if(o(this.getTotalLength()-b)<"1e-6")return Va(this.attrs.path,a).end;var c=Va(this.attrs.path,b,1);return a?
Va(c,a).end:c}};k.easing_formulas={linear:function(a){return a},"<":function(a){return v(a,3)},">":function(a){return v(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return v(a,3)/2;a-=2;return(v(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return v(2,-10*a)*E.sin((a-0.075)*2*C/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/
2.75){a-=2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var ua=[],sb=function(){for(var a=+new Date,b=0;b<ua[m];b++){var c=ua[b];if(!(c.stop||c.el.removed)){var e=a-c.start,f=c.ms,d=c.easing,j=c.from,p=c.diff,q=c.to,r=c.t,H=c.el;c={};var K;if(e<f){e=d(e/f);for(var L in j)if(j[i](L)){switch(Na[L]){case "along":K=e*f*p[L];q.back&&(K=q.len-K);d=La(q[L],K);H.translate(p.sx-p.x||0,p.sy-p.y||0);p.x=d.x;p.y=d.y;H.translate(d.x-p.sx,d.y-p.sy);q.rot&&H.rotate(p.r+d.alpha,
d.x,d.y);break;case M:K=+j[L]+e*f*p[L];break;case "colour":K="rgb("+[Wa($(j[L].r+e*f*p[L].r)),Wa($(j[L].g+e*f*p[L].g)),Wa($(j[L].b+e*f*p[L].b))][A](",")+")";break;case "path":K=[];d=0;for(var Q=j[L][m];d<Q;d++){K[d]=[j[L][d][0]];for(var ba=1,S=j[L][d][m];ba<S;ba++)K[d][ba]=+j[L][d][ba]+e*f*p[L][d][ba];K[d]=K[d][A](W)}K=K[A](W);break;case "csv":switch(L){case "translation":K=e*f*p[L][0]-r.x;d=e*f*p[L][1]-r.y;r.x+=K;r.y+=d;K=K+W+d;break;case "rotation":K=+j[L][0]+e*f*p[L][0];j[L][1]&&(K+=","+j[L][1]+
","+j[L][2]);break;case "scale":K=[+j[L][0]+e*f*p[L][0],+j[L][1]+e*f*p[L][1],2 in q[L]?q[L][2]:"",3 in q[L]?q[L][3]:""][A](W);break;case "clip-rect":K=[];for(d=4;d--;)K[d]=+j[L][d]+e*f*p[L][d]}break;default:Q=[].concat(j[L]);K=[];for(d=H.paper.customAttributes[L].length;d--;)K[d]=+Q[d]+e*f*p[L][d]}c[L]=K}H.attr(c);H._run&&H._run.call(H)}else{if(q.along){d=La(q.along,q.len*!q.back);H.translate(p.sx-(p.x||0)+d.x-p.sx,p.sy-(p.y||0)+d.y-p.sy);q.rot&&H.rotate(p.r+d.alpha,d.x,d.y)}(r.x||r.y)&&H.translate(-r.x,
-r.y);q.scale&&(q.scale+="");H.attr(q);ua.splice(b--,1)}}}k.svg&&H&&H.paper&&H.paper.safari();ua[m]&&setTimeout(sb)},Mb=function(a,b,c,e,f){var d=c-e;b.timeouts.push(setTimeout(function(){k.is(f,"function")&&f.call(b);b.animate(a,d,a.easing)},e))},Wa=function(a){return G(h(a,255),0)},Ja=function(a,b){if(a==null)return{x:this._.tx,y:this._.ty,toString:J};this._.tx+=+a;this._.ty+=+b;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+b+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+b+this.attrs.y});break;case "path":var c=Pa(this.attrs.path);c[0][1]+=+a;c[0][2]+=+b;this.attr({path:c})}return this};fa.animateWith=function(a,b,c,e,f){for(var d=0,j=ua.length;d<j;d++)ua[d].el.id==a.id&&(b.start=ua[d].start);return this.animate(b,c,e,f)};fa.animateAlong=U();fa.animateAlongBack=U(1);fa.onAnimation=function(a){this._run=a||0;return this};fa.animate=function(a,b,c,e){var f=this;f.timeouts=f.timeouts||[];if(k.is(c,"function")||!c)e=c||null;if(f.removed){e&&e.call(f);
return f}var d={},j={},p=false,q={},r;for(r in a)if(a[i](r))if(Na[i](r)||f.paper.customAttributes[i](r)){p=true;d[r]=f.attr(r);d[r]==null&&(d[r]=Da[r]);j[r]=a[r];switch(Na[r]){case "along":var H=rb(a[r]),K=La(a[r],H*!!a.back),L=f.getBBox();q[r]=H/b;q.tx=L.x;q.ty=L.y;q.sx=K.x;q.sy=K.y;j.rot=a.rot;j.back=a.back;j.len=H;a.rot&&(q.r=V(f.rotate())||0);break;case M:q[r]=(j[r]-d[r])/b;break;case "colour":d[r]=k.getRGB(d[r]);H=k.getRGB(j[r]);q[r]={r:(H.r-d[r].r)/b,g:(H.g-d[r].g)/b,b:(H.b-d[r].b)/b};break;
case "path":H=Ga(d[r],j[r]);d[r]=H[0];L=H[1];q[r]=[];H=0;for(K=d[r][m];H<K;H++){q[r][H]=[0];for(var Q=1,ba=d[r][H][m];Q<ba;Q++)q[r][H][Q]=(L[H][Q]-d[r][H][Q])/b}break;case "csv":K=z(a[r]).split(B);L=z(d[r]).split(B);switch(r){case "translation":d[r]=[0,0];q[r]=[K[0]/b,K[1]/b];break;case "rotation":d[r]=L[1]==K[1]&&L[2]==K[2]?L:[0,K[1],K[2]];q[r]=[(K[0]-d[r][0])/b,0,0];break;case "scale":a[r]=K;d[r]=z(d[r]).split(B);q[r]=[(K[0]-d[r][0])/b,(K[1]-d[r][1])/b,0,0];break;case "clip-rect":d[r]=z(d[r]).split(B);
q[r]=[];for(H=4;H--;)q[r][H]=(K[H]-d[r][H])/b}j[r]=K;break;default:K=[].concat(a[r]);L=[].concat(d[r]);q[r]=[];for(H=f.paper.customAttributes[r][m];H--;)q[r][H]=((K[H]||0)-(L[H]||0))/b}}if(p){r=k.easing_formulas[c];if(!r)if((r=z(c).match(qa))&&r[m]==5){var S=r;r=function(ia){return u(ia,+S[1],+S[2],+S[3],+S[4],b)}}else r=function(ia){return ia};ua.push({start:a.start||+new Date,ms:b,easing:r,from:d,diff:q,to:j,el:f,t:{x:0,y:0}});k.is(e,"function")&&(f._ac=setTimeout(function(){e.call(f)},b));ua[m]==
1&&setTimeout(sb)}else{c=[];var N,X;for(X in a)if(a[i](X)&&tb.test(X)){r={value:a[X]};X=="from"&&(X=0);X=="to"&&(X=100);r.key=ma(X,10);c.push(r)}c.sort(yb);c[0].key&&c.unshift({key:0,value:f.attrs});H=0;for(K=c[m];H<K;H++)Mb(c[H].value,f,b/100*c[H].key,b/100*(c[H-1]&&c[H-1].key||0),c[H-1]&&c[H-1].value.callback);(N=c[c[m]-1].value.callback)&&f.timeouts.push(setTimeout(function(){N.call(f)},b))}return this};fa.stop=function(){for(var a=0;a<ua.length;a++)ua[a].el.id==this.id&&ua.splice(a--,1);a=0;for(ii=
this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};fa.translate=function(a,b){return this.attr({translation:a+" "+b})};fa[Y]=function(){return"Rapha\u00ebl\u2019s object"};k.ae=ua;var ra=function(a){this.items=[];this[m]=0;this.type="set";if(a)for(var b=0,c=a[m];b<c;b++)if(a[b]&&(a[b].constructor==ga||a[b].constructor==ra)){this[this.items[m]]=this.items[this.items[m]]=a[b];this[m]++}};ra[y][Z]=function(){for(var a,
b,c=0,e=arguments[m];c<e;c++)if((a=arguments[c])&&(a.constructor==ga||a.constructor==ra)){b=this.items[m];this[b]=this.items[b]=a;this[m]++}return this};ra[y].pop=function(){delete this[this[m]--];return this.items.pop()};for(var Xa in fa)fa[i](Xa)&&(ra[y][Xa]=function(a){return function(){for(var b=0,c=this.items[m];b<c;b++)this.items[b][a][I](this.items[b],arguments);return this}}(Xa));ra[y].attr=function(a,b){if(a&&k.is(a,O)&&k.is(a[0],"object"))for(var c=0,e=a[m];c<e;c++)this.items[c].attr(a[c]);
else{c=0;for(e=this.items[m];c<e;c++)this.items[c].attr(a,b)}return this};ra[y].animate=function(a,b,c,e){(k.is(c,"function")||!c)&&(e=c||null);var f=this.items[m],d=f,j,p=this,q;e&&(q=function(){!--f&&e.call(p)});c=k.is(c,"string")?c:q;for(j=this.items[--d].animate(a,b,c,q);d--;)this.items[d]&&!this.items[d].removed&&this.items[d].animateWith(j,a,b,c,q);return this};ra[y].insertAfter=function(a){for(var b=this.items[m];b--;)this.items[b].insertAfter(a);return this};ra[y].getBBox=function(){for(var a=
[],b=[],c=[],e=[],f=this.items[m];f--;){var d=this.items[f].getBBox();a[Z](d.x);b[Z](d.y);c[Z](d.x+d.width);e[Z](d.y+d.height)}a=h[I](0,a);b=h[I](0,b);return{x:a,y:b,width:G[I](0,c)-a,height:G[I](0,e)-b}};ra[y].clone=function(a){a=new ra;for(var b=0,c=this.items[m];b<c;b++)a[Z](this.items[b].clone());return a};k.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"],e;for(e in a.face)a.face[i](e)&&(b.face[e]=a.face[e]);this.fonts[c]?
this.fonts[c][Z](b):this.fonts[c]=[b];if(!a.svg){b.face["units-per-em"]=ma(a.face["units-per-em"],10);for(var f in a.glyphs)if(a.glyphs[i](f)){c=a.glyphs[f];b.glyphs[f]={w:c.w,k:{},d:c.d&&"M"+c.d.replace(/[mlcxtrv]/g,function(j){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[j]||"M"})+"z"};if(c.k)for(var d in c.k)c[i](d)&&(b.glyphs[f].k[d]=c.k[d])}}return a};F.getFont=function(a,b,c,e){e=e||"normal";c=c||"normal";b=+b||{normal:400,bold:700,lighter:300,bolder:800}[b]||400;if(k.fonts){var f=k.fonts[a];
if(!f){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var d in k.fonts)if(k.fonts[i](d))if(a.test(d)){f=k.fonts[d];break}}var j;if(f){d=0;for(a=f[m];d<a;d++){j=f[d];if(j.face["font-weight"]==b&&(j.face["font-style"]==c||!j.face["font-style"])&&j.face["font-stretch"]==e)break}}return j}};F.print=function(a,b,c,e,f,d,j){d=d||"middle";j=G(h(j||0,1),-1);var p=this.set(),q=z(c).split(""),r=0;k.is(e,c)&&(e=this.getFont(e));if(e){c=(f||16)/e.face["units-per-em"];var H=e.face.bbox.split(B);
f=+H[0];d=+H[1]+(d=="baseline"?H[3]-H[1]+ +e.face.descent:(H[3]-H[1])/2);H=0;for(var K=q[m];H<K;H++){var L=H&&e.glyphs[q[H-1]]||{},Q=e.glyphs[q[H]];r+=H?(L.w||e.w)+(L.k&&L.k[q[H]]||0)+e.w*j:0;Q&&Q.d&&p[Z](this.path(Q.d).attr({fill:"#000",stroke:"none",translation:[r,0]}))}p.scale(c,c,f,d).translate(a-f,b-d)}return p};k.format=function(a,b){var c=k.is(b,O)?[0].concat(b):arguments;a&&k.is(a,"string")&&c[m]-1&&(a=a.replace(D,function(e,f){return c[++f]==null?"":c[f]}));return a||""};k.ninja=function(){g.was?
w.Raphael=g.is:delete Raphael;return k};k.el=fa;k.st=ra[y];g.was?w.Raphael=k:Raphael=k})();(function(){function k(A){return(A+"").replace(T,"")}function P(A,m,s){for(var E=A.length;E<m;E++)A=s?"0"+A:A+"0";return A}function R(A){return ha.call(A)==="[object Array]"}function J(A,m){if(A.indexOf)return A.indexOf(m);for(var s=0,E=A.length;s<E;s++)if(A[s]===m)return s;return-1}function U(A,m,s){var E=m["-"];m=m["+"];var G;switch(s){case "n -":E=" "+E;m=" "+m;case "n-":if(A.substr(A.length-E.length)===E)G=["-",A.substr(0,A.length-E.length)];else if(A.substr(A.length-m.length)===m)G=["+",A.substr(0,
A.length-m.length)];break;case "- n":E+=" ";m+=" ";case "-n":if(A.indexOf(E)===0)G=["-",A.substr(E.length)];else if(A.indexOf(m)===0)G=["+",A.substr(m.length)];break;case "(n)":if(A.indexOf("(")===0&&A.substr(A.length-1)===")")G=["-",A.substr(1,A.length-2)]}return G||["",A]}function u(A,m){if(!m)return 0;for(var s,E=A.getTime(),G=0,h=m.length;G<h;G++){s=m[G].start;if(s===null||E>=s)return G}return 0}function B(A){return A.split("\u00a0").join(" ").toUpperCase()}function x(A){for(var m=[],s=0,E=A.length;s<
E;s++)m[s]=B(A[s]);return m}function D(A,m,s,E){A=A.getFullYear();if(!E&&m.eras)A-=m.eras[s].offset;return A}function y(A,m){for(var s=0,E=false,G=0,h=A.length;G<h;G++){var o=A.charAt(G);switch(o){case "'":if(E)m.push("'");else s++;E=false;break;case "\\":E&&m.push("\\");E=!E;break;default:m.push(o);E=false}}return s}function i(A,m){m=m||"F";var s;s=A.patterns;var E=m.length;if(E===1){s=s[m];if(!s)throw"Invalid date format string '"+m+"'.";m=s}else if(E===2&&m.charAt(0)==="%")m=m.charAt(1);return m}
function l(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function w(A,m,s){A=k(A);s=s.calendar;a:{var E=s._parseRegExp;if(E){var G=E[m];if(G){m=G;break a}}else s._parseRegExp=E={};G=i(s,m).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var h=["^"],o=[],v=0,C=0,M=l(),O;(O=M.exec(G))!==null;){var Y=G.slice(v,O.index);v=M.lastIndex;C+=y(Y,h);if(C%2)h.push(O[0]);else{Y=O[0];var ja=Y.length;switch(Y){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":Y=
"(\\D+)";break;case "tt":case "t":Y="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":Y="(\\d{"+ja+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":Y="(\\d\\d?)";break;case "zzz":Y="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":Y="([+-]?\\d\\d?)";break;case "/":Y="(\\"+s["/"]+")";break;default:throw"Invalid date format pattern '"+Y+"'.";}Y&&h.push(Y);o.push(O[0])}}y(G.slice(v),h);h.push("$");G=
{regExp:h.join("").replace(/\s+/g,"\\s+"),groups:o};m=E[m]=G}C=RegExp(m.regExp).exec(A);if(C===null)return null;M=m.groups;var Z=A=null,ca=null,ka=m=null;o=h=G=E=0;O=null;v=false;Y=0;for(ja=M.length;Y<ja;Y++){var ea=C[Y+1];if(ea){var qa=M[Y],$=qa.length,V=parseInt(ea,10);switch(qa){case "dd":case "d":m=V;if(m<1||m>31)return null;break;case "MMM":case "MMMM":ca=s;$=$===3;qa=ca.months;var ma=ca.monthsGenitive||ca.months,va=ca._upperMonths;V=ca._upperMonthsGen;if(!va){ca._upperMonths=va=[x(qa.names),
x(qa.namesAbbr)];ca._upperMonthsGen=V=[x(ma.names),x(ma.namesAbbr)]}ea=B(ea);ca=J($?va[1]:va[0],ea);if(ca<0)ca=J($?V[1]:V[0],ea);if(ca<0||ca>11)return null;break;case "M":case "MM":ca=V-1;if(ca<0||ca>11)return null;break;case "y":case "yy":case "yyyy":if($<4){Z=s;ea=V;V=new Date;qa=u(V);if(ea<100){$=Z.twoDigitYearMax;$=typeof $==="string"?(new Date).getFullYear()%100+parseInt($,10):$;Z=D(V,Z,qa);ea+=Z-Z%100;if(ea>$)ea-=100}Z=ea}else Z=V;if(Z<0||Z>9999)return null;break;case "h":case "hh":E=V;if(E===
12)E=0;if(E<0||E>11)return null;break;case "H":case "HH":E=V;if(E<0||E>23)return null;break;case "m":case "mm":G=V;if(G<0||G>59)return null;break;case "s":case "ss":h=V;if(h<0||h>59)return null;break;case "tt":case "t":v=s.PM&&(ea===s.PM[0]||ea===s.PM[1]||ea===s.PM[2]);if(!v&&(!s.AM||ea!==s.AM[0]&&ea!==s.AM[1]&&ea!==s.AM[2]))return null;break;case "f":case "ff":case "fff":o=V*Math.pow(10,3-$);if(o<0||o>999)return null;break;case "ddd":case "dddd":ka=ea;ea=$===3;V=void 0;V=s.days;$=s._upperDays;if(!$)s._upperDays=
$=[x(V.names),x(V.namesAbbr),x(V.namesShort)];ka=B(ka);if(ea){V=J($[1],ka);if(V===-1)V=J($[2],ka)}else V=J($[0],ka);ka=V;if(ka<0||ka>6)return null;break;case "zzz":$=ea.split(/:/);if($.length!==2)return null;O=parseInt($[0],10);if(O<-12||O>13)return null;$=parseInt($[1],10);if($<0||$>59)return null;O=O*60+(ea.indexOf("-")===0?-$:$);break;case "z":case "zz":O=V;if(O<-12||O>13)return null;O*=60;break;case "g":case "gg":if(!ea||!s.eras)return null;ea=k(ea.toLowerCase());$=0;for(V=s.eras.length;$<V;$++)if(ea===
s.eras[$].name.toLowerCase()){A=$;break}if(A===null)return null}}}C=new Date;M=(Y=s.convert)?Y.fromGregorian(C)[0]:C.getFullYear();if(Z===null)Z=M;else if(s.eras)Z+=s.eras[A||0].offset;if(ca===null)ca=0;if(m===null)m=1;if(Y){C=Y.toGregorian(Z,ca,m);if(C===null)return null}else{C.setFullYear(Z,ca,m);if(C.getDate()!==m)return null;if(ka!==null&&C.getDay()!==ka)return null}if(v&&E<12)E+=12;C.setHours(E,G,h,o);if(O!==null){s=C.getMinutes()-(O+C.getTimezoneOffset());C.setHours(C.getHours()+parseInt(s/
60,10),s%60)}return C}function g(A,m,s){function E($,V){var ma;ma=$+"";if(V>1&&ma.length<V){ma=Y[V-2]+ma;return ma.substr(ma.length-V,V)}return ma}function G(){if(ja||Z)return ja;ja=ca.test(m);Z=true;return ja}function h($,V){if(qa)return qa[V];switch(V){case 0:return $.getFullYear();case 1:return $.getMonth();case 2:return $.getDate()}}var o=s.calendar,v=o.convert;if(!m||!m.length||m==="i"){if(s&&s.name.length)if(v)s=g(A,o.patterns.F,s);else{s=new Date(A.getTime());var C=u(A,o.eras);s.setFullYear(D(A,
o,C));s=s.toLocaleString()}else s=A.toString();return s}C=o.eras;var M=m==="s";m=i(o,m);s=[];var O,Y=["0","00","000"],ja,Z,ca=/([^d]|^)(d|dd)([^d]|$)/g,ka=0,ea=l(),qa;if(!M&&v)qa=v.fromGregorian(A);for(;;){O=ea.lastIndex;v=ea.exec(m);O=m.slice(O,v?v.index:m.length);ka+=y(O,s);if(!v)break;if(ka%2)s.push(v[0]);else{O=v[0];v=O.length;switch(O){case "ddd":case "dddd":s.push((v===3?o.days.namesAbbr:o.days.names)[A.getDay()]);break;case "d":case "dd":ja=true;s.push(E(h(A,2),v));break;case "MMM":case "MMMM":O=
h(A,1);s.push(o.monthsGenitive&&G()?o.monthsGenitive[v===3?"namesAbbr":"names"][O]:o.months[v===3?"namesAbbr":"names"][O]);break;case "M":case "MM":s.push(E(h(A,1)+1,v));break;case "y":case "yy":case "yyyy":O=qa?qa[0]:D(A,o,u(A,C),M);if(v<4)O%=100;s.push(E(O,v));break;case "h":case "hh":O=A.getHours()%12;if(O===0)O=12;s.push(E(O,v));break;case "H":case "HH":s.push(E(A.getHours(),v));break;case "m":case "mm":s.push(E(A.getMinutes(),v));break;case "s":case "ss":s.push(E(A.getSeconds(),v));break;case "t":case "tt":O=
A.getHours()<12?o.AM?o.AM[0]:" ":o.PM?o.PM[0]:" ";s.push(v===1?O.charAt(0):O);break;case "f":case "ff":case "fff":s.push(E(A.getMilliseconds(),3).substr(0,v));break;case "z":case "zz":O=A.getTimezoneOffset()/60;s.push((O<=0?"+":"-")+E(Math.floor(Math.abs(O)),v));break;case "zzz":O=A.getTimezoneOffset()/60;s.push((O<=0?"+":"-")+E(Math.floor(Math.abs(O)),2)+":"+E(Math.abs(A.getTimezoneOffset()%60),2));break;case "g":case "gg":o.eras&&s.push(o.eras[u(A,C)].name);break;case "/":s.push(o["/"]);break;default:throw"Invalid date format pattern '"+
O+"'.";}}}return s.join("")}var n={},F={en:{}};F["default"]=F.en;n.extend=function(A){for(var m=arguments[1]||{},s=2,E=arguments.length;s<E;s++){var G=arguments[s];if(G)for(var h in G){var o=G[h];if(typeof o!=="undefined")if(A&&(ha.call(o)==="[object Object]"||R(o))){var v=m[h];v=v&&(ha.call(v)==="[object Object]"||R(v))?v:R(o)?[]:{};m[h]=this.extend(true,v,o)}else m[h]=o}}return m};n.findClosestCulture=function(A){var m;if(!A)return this.culture||this.cultures["default"];if(ha.call(A)==="[object String]")A=
A.split(",");if(R(A)){var s,E=this.cultures,G=A,h,o=G.length,v=[];for(h=0;h<o;h++){A=k(G[h]);A=A.split(";");s=k(A[0]);if(A.length===1)A=1;else{A=k(A[1]);if(A.indexOf("q=")===0){A=A.substr(2);A=parseFloat(A,10);A=isNaN(A)?0:A}else A=1}v.push({lang:s,pri:A})}v.sort(function(M,O){return M.pri<O.pri?1:-1});for(h=0;h<o;h++){s=v[h].lang;if(m=E[s])return m}for(h=0;h<o;h++){s=v[h].lang;do{G=s.lastIndexOf("-");if(G===-1)break;s=s.substr(0,G);if(m=E[s])return m}while(1)}for(h=0;h<o;h++){s=v[h].lang;for(var C in E){G=
E[C];if(G.language==s)return G}}}else if(typeof A==="object")return A;return m||null};n.preferCulture=function(A){this.culture=this.findClosestCulture(A)||this.cultures["default"]};n.localize=function(A,m,s){if(typeof m!=="string")m=this.culture.name||this.culture||"default";m=this.cultures[m]||{name:m};var E=F[m.name];if(arguments.length===3){E||(E=F[m.name]={});E[A]=s}else{if(E)s=E[A];if(typeof s==="undefined"){if(E=F[m.language])s=E[A];if(typeof s==="undefined")s=F["default"][A]}}return typeof s===
"undefined"?null:s};n.format=function(A,m,s){s=this.findClosestCulture(s);if(typeof A==="number"){var E=A;if(!m||m==="i")A=s.name.length?E.toLocaleString():E.toString();else{m=m||"D";s=s.numberFormat;A=Math.abs(E);var G=-1;if(m.length>1)G=parseInt(m.slice(1),10);var h=m.charAt(0).toUpperCase(),o;switch(h){case "D":m="n";if(G!==-1)A=P(""+A,G,true);if(E<0)A=-A;break;case "N":o=s;case "C":o=o||s.currency;case "P":o=o||s.percent;m=E<0?o.pattern[0]:o.pattern[1]||"n";if(G===-1)G=o.decimals;b:{var v=A*(h===
"P"?100:1);h=o;o=h.groupSizes;A=o[0];E=1;var C=Math.pow(10,G),M=Math.round(v*C)/C;isFinite(M)||(M=v);C="";C=(M+"").split(/e/i);M=C.length>1?parseInt(C[1],10):0;v=C[0];C=v.split(".");v=C[0];C=C.length>1?C[1]:"";if(M>0){C=P(C,M,false);v+=C.slice(0,M);C=C.substr(M)}else if(M<0){M=-M;v=P(v,M+1);C=v.slice(-M,v.length)+C;v=v.slice(0,-M)}C=G>0?h["."]+(C.length>G?C.slice(0,G):P(C,G)):"";G=v.length-1;h=h[","];for(M="";G>=0;){if(A===0||A>G){A=v.slice(0,G+1)+(M.length?h+M+C:C);break b}M=v.slice(G-A+1,G+1)+(M.length?
h+M:"");G-=A;if(E<o.length){A=o[E];E++}}A=v.slice(0,G+1)+h+M+C}break;default:throw"Bad number format specifier: "+h;}o=/n|\$|-|%/g;for(E="";;){G=o.lastIndex;h=o.exec(m);E+=m.slice(G,h?h.index:m.length);if(!h)break;switch(h[0]){case "n":E+=A;break;case "$":E+=s.currency.symbol;break;case "-":if(/[1-9]/.test(A))E+=s["-"];break;case "%":E+=s.percent.symbol}}A=E}}else if(A instanceof Date)A=g(A,m,s);return A};n.parseInt=function(A,m,s){return Math.floor(this.parseFloat(A,m,s))};n.parseFloat=function(A,
m,s){if(typeof m==="string"){s=m;m=10}s=this.findClosestCulture(s);var E=NaN,G=s.numberFormat;if(A.indexOf(s.numberFormat.currency.symbol)>-1){A=A.replace(s.numberFormat.currency.symbol,"");A=A.replace(s.numberFormat.currency["."],s.numberFormat["."])}A=k(A);if(W.test(A))E=parseFloat(A,m);else if(!m&&z.test(A))E=parseInt(A,16);else{s=U(A,G,G.pattern[0]);m=s[0];s=s[1];if(m===""&&G.pattern[0]!=="-n"){s=U(A,G,"-n");m=s[0];s=s[1]}m=m||"+";var h;A=s.indexOf("e");if(A<0)A=s.indexOf("E");if(A<0){h=s;A=null}else{h=
s.substr(0,A);A=s.substr(A+1)}var o=G["."],v=h.indexOf(o);if(v<0){s=h;h=null}else{s=h.substr(0,v);h=h.substr(v+o.length)}o=G[","];s=s.split(o).join("");v=o.replace(/\u00A0/g," ");if(o!==v)s=s.split(v).join("");m+=s;if(h!==null)m+="."+h;if(A!==null){G=U(A,G,"-n");m+="e"+(G[0]||"+")+G[1]}if(da.test(m))E=parseFloat(m)}return E};n.parseDate=function(A,m,s){s=this.findClosestCulture(s);var E,G;if(m){if(typeof m==="string")m=[m];if(m.length){G=0;for(var h=m.length;G<h;G++){var o=m[G];if(o)if(E=w(A,o,s))break}}}else{m=
s.calendar.patterns;for(G in m)if(E=w(A,m[G],s))break}return E||null};var I=n.cultures=n.cultures||{};I=I["default"]=I.en=n.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish",
"/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,
offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},I.en);I.calendar=I.calendar||I.calendars.standard;var T=/^\s+|\s+$/g,W=/^[+-]?infinity$/i,z=/^0x[a-f0-9]+$/i,da=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,ha=Object.prototype.toString;jQuery.global=n})();(function(k){var P=k({});k.subscribe=function(){P.bind.apply(P,arguments)};k.unsubscribe=function(){P.unbind.apply(P,arguments)};k.publish=function(){P.trigger.apply(P,arguments)}})(jQuery);var timeglider=window.timeglider={version:"0.1.0"};
(function(k){k=timeglider;var P={},R={},J={},U={},u={};k.TG_Date=function(x){function D(w){var g=Math.abs(w.rd)*86400,n=w.ho*3600,F=(w.mi-1)*60,I=1;if(w.rd<0)I=-1;return I*(g+n+F)}var y,i,l;if(typeof x=="number"){y=i=B.getDateFromSec(x);l=x}else y=i=x;if(function(w){w=jQuery.trim(w);reg=RegExp(/[0-9-: ]/);return reg.test(w)?w:"shit"}(y)==="shit")return{error:"Invalid date"};else{y=y.replace(",","");if(y.substr(0,1)=="-"){this.bce=1;y=y.substr(1)}else this.bce=0;y=y.replace(/[^0-9]/g,"-");x=y.split("-");
this.ye=parseInt(x[0],10);this.mo=parseInt(x[1],10);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));this.da=parseInt(x[2],10);this.ho=parseInt(x[3],10);this.mi=parseInt(x[4],10);this.se=parseInt(x[5],10);this.rd=B.getRataDie(this);this.sec=l||D(this);this.dateStr=i}};var B=k.TG_Date;B.getTimeUnitSerial=function(x,D){switch(D){case "ye":return x.ye;case "mo":return x.mo_num;case "da":return x.rd;case "de":return Math.ceil(x.ye/10);case "ce":return Math.ceil(x.ye/
100);case "thou":return Math.ceil(x.ye/1E3);case "tenthou":return Math.ceil(x.ye/1E4);case "hundredthou":return Math.ceil(x.ye/1E5);case "mill":return Math.ceil(x.ye/1E6);case "tenmill":return Math.ceil(x.ye/1E7);case "hundredmill":return Math.ceil(x.ye/1E8);case "bill":return Math.ceil(x.ye/1E9)}};B.getMonthDays=function(x,D){return B.isLeapYear(D)==true&&x==2?29:B.monthsDayNums[x]};B.twentyFourToTwelve=function(x){var D={};D.ye=x.ye;D.mo=x.mo;D.da=x.da;D.ho=x.ho;D.mi=x.mi;D.ampm="am";if(x.ho)if(x.ho>=
12){D.ampm="pm";D.ho=x.ho>12?x.ho-12:12}else if(x.ho==0){D.ho=12;D.ampm="am"}else D.ho=x.ho;else{D.ho=12;D.mi=0;D.ampm="am"}return D};B.getMonthAdj=function(x,D){var y=B.getDateFromMonthNum(x);switch(y.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:y=Math.floor(D+D/28*3);return{width:y,days:31};case 2:if(B.isLeapYear(y.ye)==true){y=Math.floor(D+D/28);return{width:y,days:29}}else return{width:D,days:28};default:y=Math.floor(D+D/28*2);return{width:y,days:30}}};B.getDateFromMonthNum=function(x){var D=
0;if(x>0){D=x%12;if(D==0)D=12;x=Math.ceil(x/12)}else{D=Math.abs(x)%12;D=12-D+1;if(D==13)D=1;x=-1*Math.ceil(Math.abs(x)/12)}return{ye:x,mo:D}};B.getMonthWidth=function(x,D,y){D=t/28;var i;switch(x){case 1:case 3:case 5:case 7:case 8:case 10:case 12:i=3;break;case 4:case 6:case 9:case 11:i=2;break;case 2:i=B.isLeapYear(yr)==true?1:0}return{width:Math.floor(y+D*i),numDays:28+i}};B.getToday=function(){var x=new Date;return x.getFullYear()+"-"+x.getMonth()+"-"+x.getDate()+" "+x.getHours()+":"+x.getMinutes()+
":00"};B.getMonthFromRemDays=function(x,D){var y=0;var i=y=0;y=B.isLeapYear(D)?1:0;if(x<=31){i=1;y=x}else if(x>31&&x<=59+y){i=2;y=x-(31+y)}else if(x>59+y&&x<=90+y){i=3;y=x-(59+y)}else if(x>90+y&&x<=120+y){i=4;y=x-(90+y)}else if(x>120+y&&x<=151+y){i=5;y=x-(120+y)}else if(x>151+y&&x<=181+y){i=6;y=x-(151+y)}else if(x>181+y&&x<=212+y){i=7;y=x-(181+y)}else if(x>212+y&&x<=243+y){i=8;y=x-(212+y)}else if(x>243+y&&x<=273+y){i=9;y=x-(243+y)}else if(x>273+y&&x<=304+y){i=10;y=x-(273+y)}else if(x>304+y&&x<=334+
y){i=11;y=x-(304+y)}else{i=12;y=x-(334+y)}return{mo:i,da:y}};B.getDateFromRD=function(x){if(U[x])return U[x];for(var D=Math.floor(x),y=Math.floor(D/146097)*400,i=D-Math.floor(D/146097)*146097,l=1,w=y+1,g=w+400;w<=g;w++)if(i>365){i-=365;if(B.isLeapYear(w))i-=1;l++}else w=g;y+=l;if(i==0)i=1;i=B.getMonthFromRemDays(i,y);l=(x-D)*1440;D=Math.floor(l%60);l=Math.floor(l/60);if(B.isLeapYear(y)&&i.mo==2)i.da+=1;D=y+"-"+i.mo+"-"+i.da+" "+l+":"+D+":00";return U[x]=D};B.getDateFromSec=function(x){if(u[x])return u[x];
var D=B.getDateFromRD(x/86400);return u[x]=D};B.isLeapYear=function(x){return x%400==0?true:x%100==0?false:x%4==0?true:false};B.getRataDie=function(x){function D(F,I){if(R[F+"-"+I])return R[F+"-"+I];for(var T=0,W=F;W<I;W++)T+=B.isLeapYear(W)?366:365;return R[F+"-"+I]=T}function y(F,I){var T;switch(F){case 1:T=0;break;case 2:T=31;break;case 3:T=59;break;case 4:T=90;break;case 5:T=120;break;case 6:T=151;break;case 7:T=181;break;case 8:T=212;break;case 9:T=243;break;case 10:T=273;break;case 11:T=304;
break;case 12:T=334}if(F>2)if(B.isLeapYear(I))T+=1;return T}var i=x.ye,l=x.mo;x=x.da;var w=0;if(P[i+"-"+l+"-"+x])return P[i+"-"+l+"-"+x];if(i>=0){if(i==0)i=1;w=Math.floor(i/400)*146097;var g=parseInt(D(i-i%400,i)),n=parseInt(y(l,i));w=w+g+n+x-366}else if(i<0)w=B.getBCRataDie({ye:i,mo:l,da:x});return P[i+"-"+l+"-"+x]=w};B.getBCRataDie=function(x){var D=x.ye,y=x.mo;x=x.da;if(J[D+"-"+y+"-"+x])return J[D+"-"+y+"-"+x];if(y==0)y=1;if(x==0)x=1;var i=-1*((Math.abs(D)-1)*366+[0,335,306,275,245,214,184,153,
122,92,61,31,0][y]+(B.monthsDayNums[y]-x+1));return J[D+"-"+y+"-"+x]=i};B.setCulture=function(x){jQuery.global.culture=jQuery.global.cultures[x];B.monthNames=jQuery.global.culture.calendar.months.names;B.monthNames.unshift("");B.monthNamesAbbr=jQuery.global.culture.calendar.months.namesAbbr;B.monthNamesAbbr.unshift("");B.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];debug.log("TG_Date.monthNamesAbbr:"+B.monthNamesAbbr[1]);B.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,
29];B.dayNames=jQuery.global.culture.calendar.days.names;B.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;B.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;B.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];B.patterns=jQuery.global.culture.calendar.patterns};B.prototype={formatFocusDate:function(){return this.ye+"-"+this.mo+"-"+this.da+" "+this.ho+":"+this.mi+":00"},format:function(x){var D="";switch(x){case "YYYY-MM-DD":D=
this.ye+"-"+this.mo+"-"+this.da;break;case "YYYY":D=this.ye;break;case "D":D=this.da+" "+B.monthNamesAbbr[this.mo]+" "+this.ye;break;default:D=this.ye+"-"+this.mo+"-"+this.da+" "+this.ho+":"+this.mi+":00"}return D}}})(timeglider);(function(k){var P=k.levelHeight=8,R=jQuery;k.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var J=this;this.addBlock=function(B,x){B.right=B.left+B.width;B.bottom=B.top+B.height;B.tickScope=x;J.blocks.push(B)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(B){if(B=="sweep"){J.tree=[];for(var x=0;x<300;x++)J.tree[x]=[];this.vis=[]}this.blocks.sort(U);var D,y,i="";D=x="";for(var l={},w=this.blocks.length,g=0,n=0;n<w;n++){l=
this.blocks[n];if(l.tickScope==B)if(R.inArray(l.id,this.vis)==-1){this.vis.push(l.id);g=0;if(l.html&&l.html.substr(0,4)=="<div"){D="<div style='left:"+l.left+"px' id='ev_"+l.id+"'"+l.html.substr(4);x+=D}else{if(l.image){if(l.image.display_class=="layout")g=l.image.height+4;i="<div class='timeglider-event-image-"+l.image.display_class+"'><img src='"+l.image.src+"'></div>"}else i="";u(l,0);if(l.y_position>0)l.top=-1*l.y_position;l.fontsize<10?l.opacity=l.fontsize/10:l.opacity=1;if(l.span==true){D="timeglider-event-spanning";
y="<div class='timeglider-event-spanner' style='height:"+l.fontsize+"px;width:"+l.spanwidth+"px'></div>"}else y=D="";x+="<div class='timeglider-timeline-event "+D+"' id='ev_"+l.id+"' style='width:"+l.width+"px;height:"+l.height+"px;left:"+l.left+"px;opacity:"+l.opacity+";top:"+l.top+"px;font-size:"+l.fontsize+"px;'><img class='timeglider-event-icon' src='"+l.icon+"' style='height:"+l.fontsize+"px;left:-"+(l.fontsize+2)+"px; top:"+g+"px'>"+i+y+"<div class='timeglider-event-title' style='top:"+g+"px'>"+
l.title+"</div></div>"}}}return x};var U=function(B,x){var D=x.importance,y=B.importance;return D<y?-1:D>y?1:0},u=function(B,x){var D=false,y=J.tree,i=y[x],l=x+1,w=false,g=2;bump_ht=P;if(i!=undefined){for(g=0;g<i.length;g++){a:{D=i[g];if(!(B.left>D.right||B.right<D.left))if(B.left>=D.left&&B.left<=D.right||B.right>=D.left&&B.right<=D.right||B.right>=D.right&&B.left<=D.left||B.right<=D.right&&B.left>=D.left)if(B.bottom<=D.bottom&&B.bottom>=D.top||B.top<=D.bottom&&B.top>=D.top||B.top==D.bottom&&B.top==
D.top){D=true;break a}D=false}if(D==true){B.top-=bump_ht;B.bottom-=bump_ht;u(B,l);w=true;break}}if(w==false){B.top-=B.fontsize;i.push(B);g=Math.ceil(B.height/P);i=0;for(i=1;i<=g;i++){l=x+i;y[l].push(B)}}}}}})(timeglider);(function(k){function P(B){function x(l,w){return function(){return w.apply(l,arguments)}}var D=new Image,y=B.id,i=D.src=B.src;D.onerror=x(D,function(){u.reportImageSize({id:B.id,src:i,error:true})});D.onload=x(D,function(){u.reportImageSize({id:y,src:i,width:this.width,height:this.height})})}var R=k.TG_Date,J=jQuery,U={},u;k.TG_Timeline=Backbone.Model.extend({defaults:{title:"Untitled",events:[],legend:[]},_chewTimeline:function(B){u=B.mediator;U=u.options;var x={da:[],mo:[],ye:[],de:[],ce:[],thou:[],
tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},D=R.units;B.startSeconds=[];B.endSeconds=[];B.spans=[];if(!B.color)B.color="#333333";if(B.events){for(var y,i,l,w,g=B.events.length,n=0;n<g;n++){y=B.events[n];if(y.id)i=y.id;else y.id=i="anon"+this.anonEventId++;y.startdateObj=new R(y.startdate);y.enddateObj=new R(y.enddate);y.icon=!y.icon||y.icon==="none"?"":U.icon_folder+y.icon;y.titleWidth=k.getStringWidth(y.title);if(y.image){y.image={id:y.id,src:y.image,display_class:y.image_class||
"layout"};P(y.image);u.imagesToSize++}B.startSeconds.push(y.startdateObj.sec);B.endSeconds.push(y.enddateObj.sec);if(y.enddateObj.sec>y.startdateObj.sec){y.span=true;B.spans.push({id:y.id,start:y.startdateObj.sec,end:y.enddateObj.sec})}else y.span=false;for(var F=D.length,I=0;I<F;I++){l=D[I];w=R.getTimeUnitSerial(y.startdateObj,l);if(x[l][w]!==undefined)x[l][w].push(i);else x[l][w]=[i]}u.eventPool["ev_"+i]=y}D=J.merge(B.startSeconds,B.endSeconds);D=timeglider.getLowHigh(D);B.bounds={first:D.low,last:D.high}}if(B.legend.length>
0){D=B.legend;for(y=0;y<D.length;y++)debug.log("leg. title:"+D[y].title)}B.display="expanded";B.dateHash=x;delete B.events;return B},initialize:function(B){this.set(this._chewTimeline(B))},validate:function(){}})})(timeglider);(function(k){var P=k.TG_Date,R="",J="",U={},u=jQuery,B={},x="",D,y;debug.trace=function(i,l){u("#"+l).text(i)};k.TG_TimelineView=function(i,l){var w=this;J=l;U=J.options;R="#"+i._id;x=i._id;this._views={PLACE:R,CONTAINER:R+" .timeglider-container",TIMELINE_MENU:R+" .timeglider-timeline-menu",TIMELINE_MENU_UL:R+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:R+" .timeglider-list-bt",SLIDER_CONTAINER:R+" .timeglider-slider-container",SLIDER:R+" .timeglider-slider",ZOOM_DISPLAY:R+" .timeglider-zoomlevel-display",
TRUCK:R+" .timeglider-truck",CENTERLINE:R+" .timeglider-centerline",TICKS:R+" .timeglider-ticks",HANDLE:R+" .timeglider-handle",FOOTER:R+" .timeglider-footer",FILTER_BT:R+" .timeglider-filter-bt",FILTER_BOX:R+" .timeglider-filter-box",TOOLS_BT:R+" .timeglider-tools-bt"};D=this._views.CONTAINER;y=this._views.TICKS;this._templates={event_modal:u.template(null,"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='ev_${id}_modal'><div class='close-button-remove'></div><div class='startdate'>${startdate}</div><h4 id='title'>${title}</h4><p>{{html description}}</p><ul class='timeglider-ev-modal-links'><li><a target='_blank' href='${link}'>link</a></li></ul></div>"),
event_modal_video:u.template(null,"<div class='tg-modal timeglider-ev-video-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><iframe width = '100%' height='300' src='${video}'></iframe></div>"),timeline_modal:u.template(null,"<div class='tg-modal timeglider-timeline-modal ui-widget-content' id='tl_${id}_modal'><div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p></div>"),filter_modal:u.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box timeglider-menu-hidden'><div class='close-button'><img src='img/close.png'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:u.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu timeglider-menu-hidden'><div class='close-button'><img src='img/close.png'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),legend_modal:u.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-menu-hidden'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div></div></div>")};
u(D).css("height",u(R).height());this.basicFontSize=U.basic_fontsize;U.show_footer==false&&u(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();u.subscribe("mediator.timelineDataLoaded",function(){J.setInitialTimelines();u(".timeglider-loading").fadeOut(500)});
u.subscribe("mediator.ticksOffsetChange",function(){w.tickHangies();w.registerTitles();w.registerDragging()});u.subscribe("mediator.zoomLevelChange",function(){w.tickNum=0;w.leftside=0;var n=J.getZoomLevel();u(w._views.SLIDER).slider("value",w.invSliderVal(n));w.displayZoomLevel(n);w.castTicks("zoomLevelChange")});u.subscribe("mediator.ticksReadySignal",function(){J.ticksReady===true&&w.freshTimelines()});u.subscribe("mediator.refreshSignal",function(){w.castTicks("refreshSignal")});u.subscribe("mediator.ticksArrayChange",
function(){});u.subscribe("mediator.focusDateChange",function(){});u.subscribe("mediator.timelineListChangeSignal",function(){w.buildTimelineMenu()});u.subscribe("mediator.activeTimelinesChange",function(){u(w._views.TIMELINE_MENU_UL+" li").each(function(){var n=u(this).attr("id");u.inArray(n,J.activeTimelines)!=-1?u(this).addClass("activeTimeline"):u(this).removeClass("activeTimeline")})});u.subscribe("mediator.filterChange",function(){});u(".timeglider-pan-buttons div").mousedown(function(){var n=
u(this).attr("class")=="timeglider-pan-right"?-30:30;w.intervalMachine("pan",{type:"set",fn:w.pan,args:[n],intvl:30})}).mouseup(function(){w.intervalMachine("pan",{type:"clear",fn:w.pan,callback:"resetTicksHandle"})}).mouseout(function(){w.intervalMachine("pan",{type:"clear",fn:w.pan,callback:"resetTicksHandle"})});u(this._views.TRUCK).dblclick(function(n){var F=n.pageX-w.dimensions.container.offset.left-w.dimensions.container.width/2,I=J.getZoomInfo().spp;n=J.getFocusDate().sec;F=new P(Math.floor(n+
F*I));n=new P(n);debug.trace("DBLCLICK:"+n.mo+"-"+n.ye+" DBLCLICK:"+F.mo+"-"+F.ye,"note")}).bind("mousewheel",function(n,F){var I=Math.ceil(-1*F*3),T=J.getZoomLevel();J.setZoomLevel(T+I);return false});u(y).draggable({axis:"x",drag:function(){J.setTicksOffset(u(this).position().left)},stop:function(){w.resetTicksHandle();w.easeOutTicks();w.registerDragging()}}).delegate(".timeglider-timeline-event","click",function(){var n=u(this).attr("id"),F=J.eventPool[n];if(F.click_callback){n=F.click_callback.split(".");
var I=n[0];if(n.length==2)window[I][n[1]](F);else window[I](F)}else w.eventModal(n)}).delegate(".timeglider-timeline-event","mouseover",function(){var n=u(this).attr("id");n=J.eventPool[n];debug.trace("hover, title:"+n.title,"note");w.eventHover(u(this),n)}).delegate(".timeglider-timeline-event","mouseout",function(){var n=u(this).attr("id");n=J.eventPool[n];debug.trace("hover, title:"+n.title,"note");w.eventUnHover(u(this),n)}).delegate(".timeglider-event-collapsed","hover",function(){var n=u(this).attr("id");
debug.trace("collapsed, title:"+J.eventPool[n].title,"note")});u(".close-button-remove").live("click",function(){var n=u(this).parent();n.fadeOut(300,function(){n.remove()})});u(".timeglider-legend-close").live("click",function(){var n=u(D+" .timeglider-legend");n.fadeOut(300,function(){n.remove()})});u.tmpl(w._templates.timeline_list_modal,{}).appendTo(D);u(w._views.TIMELINE_LIST_BT).click(function(){u(w._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden").position({my:"right bottom",at:"right top",
of:u(w._views.TIMELINE_LIST_BT),offset:"-8, -12"})});u(this._views.TIMELINE_MENU+" .close-button").live("click",function(){u(w._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden")});u(this._views.TOOLS_BT).click(function(){alert("I'm just a stand-in for the tools... ")});J.options.show_centerline===true?u(this._views.CENTERLINE).css({height:w.dimensions.container.height,left:w.dimensions.container.centerx}):u(this._views.CENTERLINE).css({display:"none"});if(u.support.touch){u("#"+x).addTouch();
var g=document.getElementById(x);g.addEventListener("gesturestart",function(n){n.preventDefault();debug.trace("gesture zoom:"+J.getZoomLevel(),"note")},false);g.addEventListener("gesturechange",function(n){n.preventDefault();debug.trace("gesture change!!!!","note")},false)}};k.TG_TimelineView.prototype={getWidgetDimensions:function(){var i=u(D),l=i.width(),w=Math.floor(l/2)+1,g=i.height(),n=Math.floor(g/2),F=i.position().left;i=i.offset();var I=U.show_footer==true?u(this._views.FOOTER).height():0;
return{container:{width:l,height:g,centerx:w,centery:n,left:F,offset:i},tick:{top:g-I-30},footer:{height:I}}},scaleToImportance:function(i,l){return i/l},displayZoomLevel:function(i){i>0&&U.display_zoom_level==true&&u(this._views.ZOOM_DISPLAY).text(i)},doSomething:function(){alert("FOO DO, viewer")},intervalMachine:function(i,l){var w=this;if(l.type==="clear"){clearInterval(B[i]);if(l.callback)w[l.callback]()}else B[i]=setInterval(function(){l.fn.apply(w,l.args)},l.intvl)},invSliderVal:function(i){return Math.abs(i-
101)},pan:function(i){i=i||20;$t=u(y);newPos=$t.position().left+i;$t.css({left:newPos});J.setTicksOffset(newPos)},registerTitles:function(){var i,l,w,g,n,F,I,T,W,z,da,ha=u(D).offset().left;u(".timeglider-event-spanning").each(function(){i=u(this).offset().left-ha;l=u(this).outerWidth();I=u(".timeglider-event-title",this);w=I.outerWidth()+5;g=I.siblings(".timeglider-event-spanner").outerWidth();g>w&&i<0&&Math.abs(i)<l-w&&I.css({marginLeft:-1*i+5})});u(".tg-timeline-envelope").each(function(){T=u(this).offset().left-
ha;W=u(".titleBar",this);z=u(".titleBar .timeline-title",this);n=W.position().left;da=n+T;W.outerWidth();w=W.outerWidth();F=-1*da;da<0&&z.css({marginLeft:F+5})})},registerDragging:function(){var i=J.startSec,l=u(y).position().left,w=J.getZoomInfo().spp;i=new P(i-l*w);J.setFocusDate(i)},buildTimelineMenu:function(){var i,l=J.timelinePool,w=0;u(this._views.TIMELINE_MENU_UL+" li").remove();for(i in l){if(l.hasOwnProperty(i)){var g=l[i];u(this._views.TIMELINE_MENU_UL).append("<li class = 'timelineList' id='"+
i+"'>"+g.title+"</li>");u("li#"+i).click(function(){J.toggleTimeline(u(this).attr("id"))})}w++}},buildSlider:function(){var i=J.getZoomLevel();if(U.min_zoom==U.max_zoom)u(this._views.SLIDER_CONTAINER).css("display","none");else{U.display_zoom_level==true&&u("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var l=this;i=l.invSliderVal(i);var w=J.max_zoom,g=J.min_zoom;u(this._views.SLIDER).css("height",(1+w-g)*3).slider({steps:100,handle:u(".knob"),
animate:300,orientation:"vertical",min:l.invSliderVal(w),max:l.invSliderVal(g),value:i,start:function(){l.sliderActive=true},stop:function(){l.sliderActive=false},change:function(){},slide:function(n,F){J.setZoomLevel(l.invSliderVal(F.value))}})}},eventHover:function(i,l){u(".timeglider-event-hover-info").position({my:"left bottom",at:"left top",of:i,offset:"1, -10",collision:"flip flip"}).text(l.startdateObj.format("D"));i.addClass("tg-event-hovered")},eventUnHover:function(i){u(".timeglider-event-hover-info").css("left",
"-1000px");i.removeClass("tg-event-hovered")},tg_format:function(i){return i.ye+"-"+i.mo+"-"+i.da},setupFilter:function(){var i=this;u.tmpl(i._templates.filter_modal,{}).appendTo(i._views.CONTAINER);u(i._views.FILTER_BT).click(function(){var l=u(this),w=i._views.FILTER_BOX;if(i.filterBoxActivated==false){i.filterBoxActivated=true;var g=u(w+" .timeglider-filter-apply"),n=u(".timeglider-filter-box .close-button"),F=u(w+" .timeglider-filter-clear"),I="",T="";g.click(function(){I=u(w+" .timeglider-filter-include").val();
T=u(w+" .timeglider-filter-exclude").val();J.setFilters({include:I,exclude:T});u(w).toggleClass("timeglider-menu-shown")});n.click(function(){u(w).toggleClass("timeglider-menu-hidden")});F.click(function(){J.setFilters({include:"",exclude:""});u(w+" .timeglider-filter-include").val("");u(w+" .timeglider-filter-exclude").val("");u(w).toggleClass("timeglider-menu-shown")})}u(w).toggleClass("timeglider-menu-hidden").css("z-index",i.ztop++).position({my:"right bottom",at:"right top",of:l,offset:"-8, -12"})})},
clearTicks:function(){this.tickNum=0;u(y).css("left",0).html("<div class='timeglider-handle'></div>")},castTicks:function(){J.getZoomLevel();var i=J.getFocusDate(),l=J.getZoomInfo().width;l=Math.ceil(this.dimensions.container.width/l)+4;var w="l";this.clearTicks();J.setTicksReady(false);this.addTick({type:"init",focus_date:i});for(i=1;i<=l;i+=1){this.addTick({type:w});w=w=="l"?"r":"l"}J.setTicksReady(true)},addTick:function(i){var l=0,w=0,g=w=0,n=0,F=0,I="";F={};g={};var T={},W={};F={};T=J.getZoomInfo().unit;
W=J.getZoomInfo().width;n=J.getFocusDate();g=parseInt(this.dimensions.tick.top);n=J.addToTicksArray({type:i.type,unit:T},n);if(T=="mo"){F=P.getMonthAdj(n,W);W=F.width;l=F.days}this.tickNum++;if(i.type=="init"){F=this.tickOffsetFromDate(J.getZoomInfo(),J.getFocusDate(),W);this.leftside=w=Math.ceil(this.dimensions.container.centerx+F);this.rightside=w+W}else if(i.type=="l")this.leftside=w=Math.floor(this.leftside-W);else if(i.type=="r"){w=Math.floor(this.rightside);this.rightside+=W}J.getTickBySerial(n).width=
W;J.getTickBySerial(n).left=w;I=this._views.PLACE+"_"+T+"_"+n+"-"+this.tickNum;F=u("<div class='timeglider-tick' id='"+I+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(y);F.css({width:W,left:w,top:g});g=this.getTickMarksInfo({unit:T,width:W});g=l||g.tperu;w=W/g;if(w>5){i=Raphael(I,W,30);var z="";for(l=0;l<g;++l){I=l*w;z+="M"+I+" 20 L"+I+" 30"}i.path(z).attr({stroke:"#333","stroke-width":1})}T={unit:T,width:W,serial:n};W=this.getDateLabelForTick(T);F.children("#label").text(W);
return T},getTickMarksInfo:function(i){switch(i.unit){case "da":i=24;break;case "mo":i=30;break;case "ye":i=12;break;default:i=10}return{tperu:i}},getDateLabelForTick:function(i){var l=i.serial,w=i.width;switch(i.unit){case "bill":if(l==1)return"1";return l-1+" bya";case "hundredmill":if(l==1)return"1";return(l-1)*100+" mya";case "tenmill":if(l==1)return"1";return(l-1)*10+" mya";case "mill":if(l==1)return"1";return l-1+" mya";case "hundredthou":if(l==1)return"1";return l-1+"00,000";case "tenthou":if(l==
1)return"1";return l-1+"0000";case "thou":if(l==1)return"1";return l-1+"000";case "ce":if(l==1)return"1";return l-1+"00";case "de":return(l-1)*10+"s";case "ye":return l;case "mo":i=P.getDateFromMonthNum(l);return w<120?P.monthNamesAbbr[i.mo]+" "+i.ye:P.monthNames[i.mo]+", "+i.ye;case "da":i=new P(P.getDateFromRD(l));return w<120?P.monthNamesAbbr[i.mo]+" "+i.da+", "+i.ye:P.monthNames[i.mo]+" "+i.da+", "+i.ye;default:return i.unit+":"+l+":"+w}},tickHangies:function(){var i=u(y).position().left,l=this.rightside+
i-this.dimensions.container.width;if(this.leftside+i>-100){i=this.addTick({type:"l"});this.appendTimelines(i)}else if(l<100){i=this.addTick({type:"r"});this.appendTimelines(i)}},tickOffsetFromDate:function(i,l,w){switch(i.unit){case "da":l=l.ho/24+l.mi/1440;w*=l;break;case "mo":i=P.getMonthDays(l.mo,l.ye);l=(l.da-1)/i+l.ho/(24*i)+l.mi/(1440*i);w*=l;break;case "ye":l=((l.mo-1)*30+l.da)/365;w*=l;break;case "de":l=l.ye%10/10+l.mo/120;w*=l;break;case "ce":l=l.ye%100/100+l.mo/1200;w*=l;break;case "thou":l=
l.ye%1E3/1E3;w*=l;break;case "tenthou":l=l.ye%1E4/1E4;w*=l;break;case "hundredthou":l=l.ye%1E5/1E5;w*=l;break;default:w=0}return-1*w},resetTicksHandle:function(){u(this._views.HANDLE).offset({left:u(D).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(i){var l=i.tick.unit,w=i.tick.serial;i=i.timeline.dateHash;return i[l][w]&&i[l][w].length>0?i[l][w]:0},setTimelineProp:function(i,l,w){J.timelinePool[i][l]=w},
passesFilters:function(i,l){var w=true,g="",n=[],F;g="";n=[];if(l<i.low_threshold||l>i.high_threshold)return false;if(g=J.filters.include){n=g.split(",");w=false;for(F=0;F<n.length;F++){g=RegExp(u.trim(n[F]),"i");if(i.title.match(g))w=true}}if(g=J.filters.exclude){n=g.split(",");for(F=0;F<n.length;F++){g=RegExp(u.trim(n[F]),"i");if(i.title.match(g))w=false}}return w},freshTimelines:function(){var i,l,w,g,n=J.activeTimelines,F=J.ticksArray,I="",T,W=this;l="";var z=W.dimensions.container.centerx,da=
W.dimensions.container.width,ha=J.getFocusDate().sec,A=J.getZoomInfo().spp;J.getZoomInfo();l=[];var m=[];da=ha-Math.floor(A*(da/2));l="";var s;w=0;for(var E=W.dimensions.container.height,G=0;G<n.length;G++){i=J.timelinePool[n[G]];s=i.display;w=i.top||E-120;l=i.legend.length>0?"<span class='tg-timeline-legend-bt'>legend</span>":"";$tl=u("<div class='tg-timeline-envelope' id='"+i.id+"'><div class='titleBar'><div class='timeline-title'>"+i.title+"<div class='tg-timeline-env-buttons'><span class='timeline-info'>info</span>"+
l+"</div></div></div></div>").appendTo(y);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){W.setTimelineProp(i.id,"top",u(this).css("top"))}}).css("top",w);l=$tl.height();u(D+" .tg-timeline-envelope#"+i.id+" .titleBar .expand-collapse").click(function(){W.expandCollapseTimeline(i.id)});u(D+" .tg-timeline-envelope#"+i.id+" .titleBar .timeline-info").click(function(){W.timelineModal(i.id)});u(D+" .tg-timeline-envelope#"+i.id+" .titleBar .tg-timeline-legend-bt").click(function(){W.legendModal(i.id)});
T=$tl.children(".titleBar");w=z+(i.bounds.first-ha)/A;g=z+(i.bounds.last-ha)/A;T.css({top:l,left:w,width:g-w});if(s=="expanded")I=i.borg=new timeglider.TG_Org;for(w=0;w<F.length;w++){l=this.getTimelineEventsByTick({tick:F[w],timeline:i});u.merge(m,l)}for(w=0;w<i.spans.length;w++){l=i.spans[w];l.start<da&&l.end>da&&u.inArray(l.id,m)==-1&&m.unshift(l.id)}l=this.compileTickEventsAsHtml(i,m,0,"sweep");if(s=="expanded"){l=I.getHTML("sweep");i.borg=I.getBorg()}l!="undefined"&&$tl.append(l);this.registerEventImages($tl)}W.registerTitles()},
appendTimelines:function(i){for(var l=J.activeTimelines,w,g="",n=0;n<l.length;n++){w=J.timelinePool[l[n]];idArr=this.getTimelineEventsByTick({tick:i,timeline:w});g=this.compileTickEventsAsHtml(w,idArr,i.serial,"append");if(w.display=="expanded")g=w.borg.getHTML(i.serial);w=u(".tg-timeline-envelope#"+w.id).append(g);this.registerEventImages(w)}},compileTickEventsAsHtml:function(i,l,w,g){var n;n=0;var F=this.dimensions.container.centerx,I=i.display,T=$tl.height();stuff="";foSec=J.startSec;spp=J.getZoomInfo().spp;
zl=J.getZoomInfo().level;buffer=20;borg=i.borg;block_arg="sweep";if(g=="append")block_arg=w;for(w=0;w<l.length;w++){ev=J.eventPool["ev_"+l[w]];if(this.passesFilters(ev,zl)===true){n=F+(ev.startdateObj.sec-foSec)/spp;if(I=="expanded"){impq=i.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=n;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=
ev.spanwidth}n=0;if(ev.image&&ev.image.display_class==="layout"){n=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+n;ev.top=T-ev.height;borg.addBlock(ev,block_arg)}else if(I=="collapsed")stuff+="<div id='ev_"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(T-2)+"px;left:"+n+"px'></div>"}}return I=="collapsed"?stuff:""},registerEventImages:function(i){u(".timeglider-event-image-bar").each(function(){u(this).position({my:"top",at:"bottom",
of:i,offset:"0, 0"}).css("left",0)})},expandCollapseTimeline:function(i){i=J.timelinePool[i];i.display=i.display=="expanded"?"collapsed":"expanded";J.refresh()},timelineModal:function(i){u("#tl_"+i+"_modal").remove();var l=J.timelinePool[i];u.tmpl(this._templates.timeline_modal,{title:l.title,description:l.description,id:i}).appendTo(D).css("z-index",this.ztop++).position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).draggable({stack:".timeglider-modal"})},
eventModal:function(i){u("#ev_"+i+"_modal").remove();var l=u("#"+i),w=this._templates.event_modal;ev=J.eventPool[i];ev_img=ev.image&&ev.image.src?"<img src='"+ev.image.src+"'>":"";templ_obj={title:ev.title,description:ev_img+ev.description,id:i,startdate:ev.startdateObj.format(),link:ev.link,video:ev.video};if(ev.video){w=this._templates.event_modal_video;templ_obj.video=ev.video}u.tmpl(w,templ_obj).appendTo(y).css("z-index",this.ztop++).position({my:"right center",at:"left center",of:l,offset:"-12, -1",
collision:"flip fit"}).draggable({stack:".timeglider-modal"})},legendModal:function(i){var l=J.timelinePool[i].legend,w,g,n,F="";for(w=0;w<l.length;w++){g=U.icon_folder+l[w].icon;n=l[w].title;F+="<li><img src='"+g+"'>"+n+"</li>"}i={id:i,legend_list:F};u(D+" .timeglider-legend").remove();u.tmpl(this._templates.legend_modal,i).appendTo(D).css("z-index",this.ztop++).toggleClass("timeglider-menu-hidden").position({my:"left top",at:"left top",of:D,offset:"16, -4",collision:"none none"});u(D+" .timeglider-legend li").click(function(){u(this).parent().attr("id");
var I=u(this).children("img").attr("src");u(this).toggleClass("tg-legend-icon-selected");J.setFiltersLegend(I)})},parseHTMLTable:function(i){var l={},w=+new Date,g=[];u("#"+i).find("tr").each(function(n){var F=u(this).children(),I;if(n===0)g=F.map(function(){return u(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{I={};F.each(function(T){I[g[T]]=u(this).text()});l["prefix"+w++]=I}});return l}};k.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,
level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",
width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},
{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,
label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",
width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},
{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},
{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",
width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},
{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",
width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,
label:"100 billion years"}];k.calculateSecPerPx=function(i){for(var l=1;l<i.length;l++){var w=i[l],g=0;switch(w.unit){case "da":g=86400;break;case "mo":g=2419200;break;case "ye":g=31536E3;break;case "de":g=31536E4;break;case "ce":g=31536E5;break;case "thou":g=31536E6;break;case "tenthou":g=31536E7;break;case "hundredthou":g=31536E8;break;case "mill":g=31536E9;break;case "tenmill":g=31536E10;break;case "hundredmill":g=31536E11;break;case "bill":g=31536E12}w.spp=g/parseInt(w.width)}}(k.zoomTree);k.getStringWidth=
function(i){return u("#timeglider-measure-span").html(i).width()+20}})(timeglider);(function(k){var P={},R=k.TG_Date,J={},U=jQuery;k.TimelineCollection=Backbone.Collection.extend({model:timeglider.TG_Timeline});k.TG_Mediator=function(u){this.options=J=u;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=J.max_zoom;this.min_zoom=J.min_zoom;this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartZoom=0;this.filters={include:"",exclude:"",legend:[]};
this.eventPool=[];this.timelinePool={};this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.foo="bark";this.initial_timeline_id=J.initial_timeline_id;if(J.max_zoom===J.min_zoom)this.fixed_zoom=J.min_zoom;P=this};k.TG_Mediator.prototype={gotoDate:function(u){this.setFocusDate(new R(u));this.refresh();return true},gotoDateZoom:function(u,B){this.setFocusDate(new R(u));this.setZoomLevel(B);return true},loadTimelineData:function(u){var B=this;if(u)typeof u==="object"?B.parseData(u):
U.getJSON(u,function(x){B.parseData(x)});else{this.timelineDataLoaded=true;this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},parseData:function(u){var B=0,x=u.length,D={};D={};for(var y=0;y<x;y++){D=u[y];D.mediator=this;D=(new timeglider.TG_Timeline(D)).toJSON();if(D.id.length>0){B++;this.swallowTimeline(D)}}if(B===0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var u=this.timelineDataLoaded==
true;this.imagesSized==this.imagesToSize&&u&&U.publish("mediator.timelineDataLoaded")},swallowTimeline:function(u){this.timelinePool[u.id]=u;U.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var u=this,B=this.initial_timeline_id;B&&setTimeout(function(){u.toggleTimeline(B)},1E3)},refresh:function(){U.publish("mediator.refreshSignal")},setTicksReady:function(u){this.ticksReady=u;u===true&&U.publish("mediator.ticksReadySignal")},getFocusDate:function(){return this._focusDate},
setFocusDate:function(u){if(u!=this._focusDate)this._focusDate=u},getZoomLevel:function(){return Number(this._zoomLevel)},setZoomLevel:function(u){if(u<=this.max_zoom&&u>=this.min_zoom){this.startSec=this._focusDate.sec;if(u!=this._zoomLevel){this._zoomLevel=u;this._zoomInfo=timeglider.zoomTree[u];U.publish("mediator.zoomLevelChange")}}else return false},getZoomInfo:function(){return this._zoomInfo},setFilters:function(u){this.filters.include=u.include;this.filters.exclude=u.exclude;U.publish("mediator.filtersChange");
this.refresh()},setFiltersLegend:function(u){if(U.inArray(u,this.filters.legend)==-1)this.filters.legend.push(u);else{var B=[];B=U.grep(this.filters.legend,function(x){return x!=u});this.filters.legend=B}debug.log("icons:"+this.filters.legend.toString())},setGestureStart:function(){this.gestureStartZoom=this.getZoomLevel()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(u){this._ticksOffset=u;U.publish("mediator.ticksOffsetChange")},getTickBySerial:function(u){for(var B=
this.ticksArray,x=B.length,D=0;D<x;D++){var y=B[D];if(y.serial==u)return y}return false},addToTicksArray:function(u,B){if(u.type=="init"){u.serial=R.getTimeUnitSerial(B,u.unit);this.ticksArray=[u]}else if(u.type=="l"){u.serial=this.ticksArray[0].serial-1;this.ticksArray.unshift(u)}else{u.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(u)}U.publish("mediator.ticksArrayChange");return u.serial},toggleTimeline:function(u){var B=this.timelinePool[u],x=U.inArray(u,this.activeTimelines);
if(x==-1){this.activeTimelines.push(u);this.setFocusDate(new R(B.focus_date));this.setZoomLevel(B.initial_zoom)}else this.activeTimelines.splice(x,1);this.refresh();U.publish("mediator.activeTimelinesChange")},reportImageSize:function(u){var B=P.eventPool["ev_"+u.id];if(u.error){B.image={};debug.log("WHOOPS: MISSING IMAGE: "+u.src)}else{B.image.width=u.width;B.image.height=u.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}};k.getLowHigh=function(u){var B,x,D=parseFloat(u[0]),
y=D;for(B=0;B<u.length;B++){x=parseFloat(u[B]);if(x<y)y=x;if(x>D)D=x}return{high:D,low:y}};k.validateOptions=function(u){this.optionsMaster={initial_focus:{type:"date"},editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,
max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"}};var B=this,x="";U.each(u,function(D,y){if(B.optionsMaster[D])switch(B.optionsMaster[D].type){case "string":if(typeof y!="string")x+=D+" needs to be a string.\n";if(B.optionsMaster[D].possible)if(U.inArray(y,B.optionsMaster[D].possible)==-1)x+=D+" must be: "+B.optionsMaster[D].possible.join(" or ");break;case "number":if(typeof y!=
"number")x+=y+" needs to be a number.\n";if(B.optionsMaster[D].min)if(y<B.optionsMaster[D].min)x+=D+" must be greater than or equal to "+B.optionsMaster[D].min+"\n";if(B.optionsMaster[D].max)if(y>B.optionsMaster[D].max)x+=D+" must be less than or equal to "+B.optionsMaster[D].max+"\n";break;case "boolean":if(typeof y!="boolean")x+=y+" needs to be a number.\n"}});return x}})(timeglider);(function(k){var P,R=timeglider,J=timeglider.TG_Date;k.widget("timeglider.timeline",{_tg:this,_element:this.element,options:{initial_focus:R.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true},_create:function(){this._id=k(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><img class='timeglider-filter-bt' title='filter' src='js/timeglider/buttons/filter.png'><img class='timeglider-tools-bt' title='settings' src='js/timeglider/buttons/tools.png'><img class='timeglider-list-bt' title='timelines' src='js/timeglider/buttons/list.png'></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var U=timeglider.validateOptions(this.options);if(U==""){R.TG_Date.setCulture(this.options.culture);P=new R.TG_Mediator(this.options);new R.TG_TimelineView(this,P);P.setFocusDate(new J(this.options.initial_focus));P.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+U)},gotoDate:function(U){debug.log("d:"+U);P.gotoDate(U)},gotoDateZoom:function(U,u){debug.log("d:"+u);P.gotoDateZoom(U,u)},destroy:function(){k.Widget.prototype.destroy.apply(this,
arguments);k(this.element).html("")}})})(jQuery);
